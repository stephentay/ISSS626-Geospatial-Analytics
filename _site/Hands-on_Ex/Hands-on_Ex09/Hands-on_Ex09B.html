<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stephen Tay">
<meta name="dcterms.date" content="2024-11-02">

<title>Hands-on Ex 9B</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../media/home-icon.svg" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01A/Hands-on_Ex01A.html" rel="" target="">
 <span class="dropdown-text">1A. Geospatial Data Science with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01B/Hands-on_Ex01B.html" rel="" target="">
 <span class="dropdown-text">1B. Thematic Mapping and GeoVisualisation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02A.html" rel="" target="">
 <span class="dropdown-text">2A. 1st Order Spatial Point Pattern Analysis Methods</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02B.html" rel="" target="">
 <span class="dropdown-text">2B. 2nd Order Spatial Point Pattern Analysis Methods</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html" rel="" target="">
 <span class="dropdown-text">3. Network Constrained Spatial Point Pattern Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" rel="" target="">
 <span class="dropdown-text">4. Spatial Weights and Applications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05A.html" rel="" target="">
 <span class="dropdown-text">5A. Global Measures of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05B.html" rel="" target="">
 <span class="dropdown-text">5B. Local Measures of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" rel="" target="">
 <span class="dropdown-text">6. Geographical Segmentation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html" rel="" target="">
 <span class="dropdown-text">7. Geographically Weighted Explanatory Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html" rel="" target="">
 <span class="dropdown-text">8. Geographically Weighted Predictive Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09A.html" rel="" target="">
 <span class="dropdown-text">9A. Processing &amp; Visualising Flow Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09B.html" rel="" target="">
 <span class="dropdown-text">9B. Calibrating Spatial Interaction Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html" rel="" target="">
 <span class="dropdown-text">10. Modelling Geographical Accessibility</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" rel="" target="">
 <span class="dropdown-text">In-class Ex 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html" rel="" target="">
 <span class="dropdown-text">In-class Ex 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html" rel="" target="">
 <span class="dropdown-text">In-class Ex 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html" rel="" target="">
 <span class="dropdown-text">In-class Ex 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html" rel="" target="">
 <span class="dropdown-text">In-class Ex 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html" rel="" target="">
 <span class="dropdown-text">In-class Ex 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html" rel="" target="">
 <span class="dropdown-text">In-class Ex 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex08/In-class_Ex08.html" rel="" target="">
 <span class="dropdown-text">In-class Ex 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex09.html" rel="" target="">
 <span class="dropdown-text">In-class Ex 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex10/In-class_Ex10.html" rel="" target="">
 <span class="dropdown-text">In-class Ex 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html" rel="" target="">
 <span class="dropdown-text">Take-home Ex 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html" rel="" target="">
 <span class="dropdown-text">Take-home Ex 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html" rel="" target="">
 <span class="dropdown-text">Take-home Ex 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/stephentay/ISSS626-Geospatial-Analytics" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/stephen-tay/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1. Overview</a></li>
  <li><a href="#importing-preparing-data" id="toc-importing-preparing-data" class="nav-link" data-scroll-target="#importing-preparing-data">2. Importing &amp; Preparing Data</a>
  <ul class="collapse">
  <li><a href="#prepare-distance-matrix-between-planning-subzones" id="toc-prepare-distance-matrix-between-planning-subzones" class="nav-link" data-scroll-target="#prepare-distance-matrix-between-planning-subzones">2.1 Prepare distance matrix between planning subzones</a></li>
  <li><a href="#prepare-flow-data" id="toc-prepare-flow-data" class="nav-link" data-scroll-target="#prepare-flow-data">2.2 Prepare flow data</a></li>
  <li><a href="#prepare-origin-destination-attributes" id="toc-prepare-origin-destination-attributes" class="nav-link" data-scroll-target="#prepare-origin-destination-attributes">2.3 Prepare origin &amp; destination attributes</a></li>
  </ul></li>
  <li><a href="#calibrating-spatial-interaction-models" id="toc-calibrating-spatial-interaction-models" class="nav-link" data-scroll-target="#calibrating-spatial-interaction-models">3. Calibrating Spatial Interaction Models</a>
  <ul class="collapse">
  <li><a href="#visualise-dependent-variable" id="toc-visualise-dependent-variable" class="nav-link" data-scroll-target="#visualise-dependent-variable">3.1 Visualise dependent variable</a></li>
  <li><a href="#check-for-zero-values" id="toc-check-for-zero-values" class="nav-link" data-scroll-target="#check-for-zero-values">3.2 Check for zero values</a></li>
  <li><a href="#replace-zero-values-with-0.99" id="toc-replace-zero-values-with-0.99" class="nav-link" data-scroll-target="#replace-zero-values-with-0.99">3.3 Replace zero values with 0.99</a></li>
  <li><a href="#unconstrained-sim" id="toc-unconstrained-sim" class="nav-link" data-scroll-target="#unconstrained-sim">3.4 Unconstrained SIM</a></li>
  <li><a href="#origin-constrained-sim" id="toc-origin-constrained-sim" class="nav-link" data-scroll-target="#origin-constrained-sim">3.5 Origin-constrained SIM</a></li>
  <li><a href="#destination-constrained-sim" id="toc-destination-constrained-sim" class="nav-link" data-scroll-target="#destination-constrained-sim">3.6 Destination-constrained SIM</a></li>
  <li><a href="#doubly-constrained-sim" id="toc-doubly-constrained-sim" class="nav-link" data-scroll-target="#doubly-constrained-sim">3.7 Doubly-constrained SIM</a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison">3.8 Model comparison</a></li>
  <li><a href="#visualising-fitted-values" id="toc-visualising-fitted-values" class="nav-link" data-scroll-target="#visualising-fitted-values">3.9 Visualising fitted values</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Hands-on Ex 9B</h1>
<p class="subtitle lead">Calibrating Spatial Interaction Models</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Stephen Tay </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 2, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">November 3, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>The hands-on exercise on <strong>Modelling Geographical Accessibility</strong> is in <a href="https://geospatialanalytics-stephentay.netlify.app/Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html">Hands-on Ex 10</a></p>
<section id="overview" class="level1">
<h1>1. Overview</h1>
<p><strong>Spatial Interaction Models (SIMs)</strong> are mathematical models for estimating flows between locations. These models help to analyse movement patterns by assessing the factors influencing interactions between places. There are four main types of SIMs:</p>
<ul>
<li><strong>Unconstrained:</strong> Estimates flows without restrictions, assuming all spatial units interact freely.</li>
<li><strong>Origin-constrained (or production-constrained):</strong> Constrains the total flow from each origin, focusing on the production capacity of each origin location.</li>
<li><strong>Destination-constrained (or attraction-constrained):</strong> Constrains the total flow into each destination, considering the attraction capacity of each destination.</li>
<li><strong>Doubly-constrained:</strong> Balances flows from both origins and destinations, ensuring both production and attraction capacities are met.</li>
</ul>
<p>Ordinary Least Squares (OLS), log-normal, Poisson, and negative binomial (NB) regression methods are commonly used to calibrate OD flow models by treating flow data as different types of dependent variables. In this exercise, we will be using Poisson regression to calibrate a SIM to determine factors affecting the bus commuter flows on weekday morning peak hours in Singapore.</p>
<p>Calibration is the process of adjusting model parameters to ensure the model’s estimates closely match observed data. Goodness-of-fit statistics are typically used to confirm that the optimal solution has been achieved.</p>
<p>The following R packages are used in this exercise:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tmap, sf, sp, performance, reshape2, ggpubr, tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-preparing-data" class="level1">
<h1>2. Importing &amp; Preparing Data</h1>
<p>This exercise builds on <a href="https://geospatialanalytics-stephentay.netlify.app/hands-on_ex/hands-on_ex09/hands-on_ex09a">Hands-on Ex 9A</a> on <strong>Processing &amp; Visualising Flow Data</strong>, and utilises the following datasets:</p>
<ul>
<li><strong>OD Matrix of Bus Commuter Flow</strong>: Data on weekday morning peak-hour bus commuter flows, derived from LTA’s dataset.</li>
<li><strong>MPSZ-2019</strong>: Sub-zone boundary data from the URA Master Plan 2019.</li>
<li><strong>Sub-Zone Population Data</strong>: Population counts by age group (e.g., 7-12, 13-24, 25-64) at the sub-zone level.</li>
</ul>
<section id="prepare-distance-matrix-between-planning-subzones" class="level2">
<h2 class="anchored" data-anchor-id="prepare-distance-matrix-between-planning-subzones">2.1 Prepare distance matrix between planning subzones</h2>
<p>The following steps are taken to compute the distance matrix between planning subzones.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">1. Import MPSZ</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">2. Convert to sp dataframe</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">3. Compute distance matrix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">4. Label row and column headers of distance matrix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">5. Convert distance matrix to long table format</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">6. Update intra-zonal distance</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/mpsz.rds"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mpsz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 332 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33
Projected CRS: SVY21 / Singapore TM
First 10 features:
                 SUBZONE_N SUBZONE_C       PLN_AREA_N PLN_AREA_C       REGION_N
1              MARINA EAST    MESZ01      MARINA EAST         ME CENTRAL REGION
2         INSTITUTION HILL    RVSZ05     RIVER VALLEY         RV CENTRAL REGION
3           ROBERTSON QUAY    SRSZ01  SINGAPORE RIVER         SR CENTRAL REGION
4  JURONG ISLAND AND BUKOM    WISZ01  WESTERN ISLANDS         WI    WEST REGION
5             FORT CANNING    MUSZ02           MUSEUM         MU CENTRAL REGION
6         MARINA EAST (MP)    MPSZ05    MARINE PARADE         MP CENTRAL REGION
7                   SUDONG    WISZ03  WESTERN ISLANDS         WI    WEST REGION
8                  SEMAKAU    WISZ02  WESTERN ISLANDS         WI    WEST REGION
9           SOUTHERN GROUP    SISZ02 SOUTHERN ISLANDS         SI CENTRAL REGION
10                 SENTOSA    SISZ01 SOUTHERN ISLANDS         SI CENTRAL REGION
   REGION_C                       geometry
1        CR MULTIPOLYGON (((33222.98 29...
2        CR MULTIPOLYGON (((28481.45 30...
3        CR MULTIPOLYGON (((28087.34 30...
4        WR MULTIPOLYGON (((14557.7 304...
5        CR MULTIPOLYGON (((29542.53 31...
6        CR MULTIPOLYGON (((35279.55 30...
7        WR MULTIPOLYGON (((15772.59 21...
8        WR MULTIPOLYGON (((19843.41 21...
9        CR MULTIPOLYGON (((30870.53 22...
10       CR MULTIPOLYGON (((26879.04 26...</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Before computing the distance matrix (i.e., distances between pairs of locations), we convert the sf dataframe to an sp dataframe. Although the distance matrix can be computed directly from an sf dataframe, the sp method is generally more time-efficient.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mpsz_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(mpsz, <span class="st">"Spatial"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>mpsz_sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPolygonsDataFrame 
features    : 332 
extent      : 2667.538, 56396.44, 15748.72, 50256.33  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 6
names       : SUBZONE_N, SUBZONE_C, PLN_AREA_N, PLN_AREA_C,       REGION_N, REGION_C 
min values  : ADMIRALTY,    AMSZ01, ANG MO KIO,         AM, CENTRAL REGION,       CR 
max values  :    YUNNAN,    YSSZ09,     YISHUN,         YS,    WEST REGION,       WR </code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>We use the spDists() function from the sp package to compute the Euclidean distance between the centroids of the planning subzones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">spDists</span>(mpsz_sp, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dist, <span class="at">n=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]       [,2]      [,3]      [,4]       [,5]      [,6]      [,7]
 [1,]     0.000  3926.0025  3939.108 20252.964  2989.9839  1431.330 19211.836
 [2,]  3926.003     0.0000   305.737 16513.865   951.8314  5254.066 16242.523
 [3,]  3939.108   305.7370     0.000 16412.062  1045.9088  5299.849 16026.146
 [4,] 20252.964 16513.8648 16412.062     0.000 17450.3044 21665.795  7229.017
 [5,]  2989.984   951.8314  1045.909 17450.304     0.0000  4303.232 17020.916
 [6,]  1431.330  5254.0664  5299.849 21665.795  4303.2323     0.000 20617.082
 [7,] 19211.836 16242.5230 16026.146  7229.017 17020.9161 20617.082     0.000
 [8,] 14960.942 12749.4101 12477.871 11284.279 13336.0421 16281.453  5606.082
 [9,]  7515.256  7934.8082  7649.776 18427.503  7801.6163  8403.896 14810.930
[10,]  6391.342  4975.0021  4669.295 15469.566  5226.8731  7707.091 13111.391
           [,8]      [,9]     [,10]
 [1,] 14960.942  7515.256  6391.342
 [2,] 12749.410  7934.808  4975.002
 [3,] 12477.871  7649.776  4669.295
 [4,] 11284.279 18427.503 15469.566
 [5,] 13336.042  7801.616  5226.873
 [6,] 16281.453  8403.896  7707.091
 [7,]  5606.082 14810.930 13111.391
 [8,]     0.000  9472.024  8575.490
 [9,]  9472.024     0.000  3780.800
[10,]  8575.490  3780.800     0.000</code></pre>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>Since the row and column headers of the distance matrix are unlabeled, we perform the following steps to add labels for the planning subzone codes:</p>
<ul>
<li>Create a list of planning subzone codes sorted to match the order of the distance matrix.</li>
<li>Attach SUBZONE_C labels to the rows and columns of the distance matrix for alignment.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sz_names <span class="ot">&lt;-</span> mpsz<span class="sc">$</span>SUBZONE_C</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dist) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(sz_names)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(dist) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(sz_names)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dist, <span class="at">n=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          MESZ01     RVSZ05    SRSZ01   WISZ01     MUSZ02
MESZ01     0.000  3926.0025  3939.108 20252.96  2989.9839
RVSZ05  3926.003     0.0000   305.737 16513.86   951.8314
SRSZ01  3939.108   305.7370     0.000 16412.06  1045.9088
WISZ01 20252.964 16513.8648 16412.062     0.00 17450.3044
MUSZ02  2989.984   951.8314  1045.909 17450.30     0.0000</code></pre>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<p>We use the <code>melt()</code> function to convert the distance matrix into a long-table format. Note that intra-zonal distances are 0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="ot">&lt;-</span> <span class="fu">melt</span>(dist) <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dist =</span> value)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(distPair, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Var1   Var2      dist
1  MESZ01 MESZ01     0.000
2  RVSZ05 MESZ01  3926.003
3  SRSZ01 MESZ01  3939.108
4  WISZ01 MESZ01 20252.964
5  MUSZ02 MESZ01  2989.984
6  MPSZ05 MESZ01  1431.330
7  WISZ03 MESZ01 19211.836
8  WISZ02 MESZ01 14960.942
9  SISZ02 MESZ01  7515.256
10 SISZ01 MESZ01  6391.342</code></pre>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<p>We assign a small non-zero constant to replace intra-zonal distances of 0.</p>
<p>First, we find out the minimum inter-zonal distance using <code>summary()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dist <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Var1             Var2             dist        
 MESZ01 :   331   MESZ01 :   331   Min.   :  173.8  
 RVSZ05 :   331   RVSZ05 :   331   1st Qu.: 7149.5  
 SRSZ01 :   331   SRSZ01 :   331   Median :11890.0  
 WISZ01 :   331   WISZ01 :   331   Mean   :12229.4  
 MUSZ02 :   331   MUSZ02 :   331   3rd Qu.:16401.7  
 MPSZ05 :   331   MPSZ05 :   331   Max.   :49894.4  
 (Other):107906   (Other):107906                    </code></pre>
</div>
</div>
<p>We assign a constant of 50m to replace intra-zonal distances.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>distPair<span class="sc">$</span>dist <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(distPair<span class="sc">$</span>dist <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">50</span>, distPair<span class="sc">$</span>dist)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>distPair <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Var1             Var2             dist      
 MESZ01 :   332   MESZ01 :   332   Min.   :   50  
 RVSZ05 :   332   RVSZ05 :   332   1st Qu.: 7097  
 SRSZ01 :   332   SRSZ01 :   332   Median :11864  
 WISZ01 :   332   WISZ01 :   332   Mean   :12193  
 MUSZ02 :   332   MUSZ02 :   332   3rd Qu.:16388  
 MPSZ05 :   332   MPSZ05 :   332   Max.   :49894  
 (Other):108232   (Other):108232                  </code></pre>
</div>
</div>
<p>We rename the variables for clarity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="ot">&lt;-</span> distPair <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">orig =</span> Var1,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">dest =</span> Var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="prepare-flow-data" class="level2">
<h2 class="anchored" data-anchor-id="prepare-flow-data">2.2 Prepare flow data</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">1. Import OD matrix of bus commuter flow</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">2. Compute total bus commuter trips</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">3. Add new fields for intra-zonal flows</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">4. Combine flow data with distance</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>The OD matrix of bus commuter flow was computed in Ex 9A. We will import the OD matrix for this exercise.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>od_data_fii <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/od_data_fii.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>We compute the total commuter trips between and within planning subzones as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>flow_data <span class="ot">&lt;-</span> od_data_fii <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIGIN_SZ, DESTIN_SZ) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(MORNING_PEAK)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ORIGIN_SZ'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(flow_data, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
# Groups:   ORIGIN_SZ [1]
   ORIGIN_SZ DESTIN_SZ TRIPS
   &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;
 1 AMSZ01    AMSZ01     1998
 2 AMSZ01    AMSZ02     8289
 3 AMSZ01    AMSZ03     8971
 4 AMSZ01    AMSZ04     2252
 5 AMSZ01    AMSZ05     6136
 6 AMSZ01    AMSZ06     2148
 7 AMSZ01    AMSZ07     1620
 8 AMSZ01    AMSZ08     1925
 9 AMSZ01    AMSZ09     1773
10 AMSZ01    AMSZ10       63</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Two new fields specific to intra-zonal flows are added to the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>FlowNoIntra <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  flow_data<span class="sc">$</span>ORIGIN_SZ <span class="sc">==</span> flow_data<span class="sc">$</span>DESTIN_SZ, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, flow_data<span class="sc">$</span>TRIPS)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>offset <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  flow_data<span class="sc">$</span>ORIGIN_SZ <span class="sc">==</span> flow_data<span class="sc">$</span>DESTIN_SZ, </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.000001</span>, <span class="dv">1</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(flow_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 14,734
Columns: 5
Groups: ORIGIN_SZ [279]
$ ORIGIN_SZ   &lt;chr&gt; "AMSZ01", "AMSZ01", "AMSZ01", "AMSZ01", "AMSZ01", "AMSZ01"…
$ DESTIN_SZ   &lt;chr&gt; "AMSZ01", "AMSZ02", "AMSZ03", "AMSZ04", "AMSZ05", "AMSZ06"…
$ TRIPS       &lt;dbl&gt; 1998, 8289, 8971, 2252, 6136, 2148, 1620, 1925, 1773, 63, …
$ FlowNoIntra &lt;dbl&gt; 0, 8289, 8971, 2252, 6136, 2148, 1620, 1925, 1773, 63, 542…
$ offset      &lt;dbl&gt; 1e-06, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e…</code></pre>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>Before joining the flow data with the distance dataset, we need to convert the origin and destination subzones to factor data types.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>ORIGIN_SZ <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flow_data<span class="sc">$</span>ORIGIN_SZ)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>DESTIN_SZ <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flow_data<span class="sc">$</span>DESTIN_SZ)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(distPair,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ORIGIN_SZ"</span> <span class="ot">=</span> <span class="st">"orig"</span>, <span class="st">"DESTIN_SZ"</span> <span class="ot">=</span> <span class="st">"dest"</span>))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(flow_data1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 14,734
Columns: 6
Groups: ORIGIN_SZ [279]
$ ORIGIN_SZ   &lt;fct&gt; AMSZ01, AMSZ01, AMSZ01, AMSZ01, AMSZ01, AMSZ01, AMSZ01, AM…
$ DESTIN_SZ   &lt;fct&gt; AMSZ01, AMSZ02, AMSZ03, AMSZ04, AMSZ05, AMSZ06, AMSZ07, AM…
$ TRIPS       &lt;dbl&gt; 1998, 8289, 8971, 2252, 6136, 2148, 1620, 1925, 1773, 63, …
$ FlowNoIntra &lt;dbl&gt; 0, 8289, 8971, 2252, 6136, 2148, 1620, 1925, 1773, 63, 542…
$ offset      &lt;dbl&gt; 1e-06, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e…
$ dist        &lt;dbl&gt; 50.0000, 810.4491, 1360.9294, 840.4432, 1076.7916, 805.297…</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="prepare-origin-destination-attributes" class="level2">
<h2 class="anchored" data-anchor-id="prepare-origin-destination-attributes">2.3 Prepare origin &amp; destination attributes</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">1. Import sub-zone population data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">2. Append subzone code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">3. Prepare origin attribute</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">4. Prepare destination attribute</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/pop.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 332 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): PA, SZ
dbl (3): AGE7_12, AGE13_24, AGE25_64

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 332
Columns: 5
$ PA       &lt;chr&gt; "ANG MO KIO", "ANG MO KIO", "ANG MO KIO", "ANG MO KIO", "ANG …
$ SZ       &lt;chr&gt; "ANG MO KIO TOWN CENTRE", "CHENG SAN", "CHONG BOON", "KEBUN B…
$ AGE7_12  &lt;dbl&gt; 310, 1140, 1010, 1050, 420, 810, 390, 980, 0, 260, 0, 1190, 6…
$ AGE13_24 &lt;dbl&gt; 710, 2770, 2650, 2390, 1120, 1920, 1150, 2000, 0, 650, 0, 326…
$ AGE25_64 &lt;dbl&gt; 2780, 15700, 14240, 12460, 3620, 9650, 4350, 11320, 0, 2500, …</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>We left join pop dataset with mpsz dataset to retrieve the subzone codes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> pop <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mpsz,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"PA"</span> <span class="ot">=</span> <span class="st">"PLN_AREA_N"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"SZ"</span> <span class="ot">=</span> <span class="st">"SUBZONE_N"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">SZ_NAME =</span> SZ,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">SZ =</span> SUBZONE_C)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 332
Columns: 6
$ PA       &lt;chr&gt; "ANG MO KIO", "ANG MO KIO", "ANG MO KIO", "ANG MO KIO", "ANG …
$ SZ_NAME  &lt;chr&gt; "ANG MO KIO TOWN CENTRE", "CHENG SAN", "CHONG BOON", "KEBUN B…
$ AGE7_12  &lt;dbl&gt; 310, 1140, 1010, 1050, 420, 810, 390, 980, 0, 260, 0, 1190, 6…
$ AGE13_24 &lt;dbl&gt; 710, 2770, 2650, 2390, 1120, 1920, 1150, 2000, 0, 650, 0, 326…
$ AGE25_64 &lt;dbl&gt; 2780, 15700, 14240, 12460, 3620, 9650, 4350, 11320, 0, 2500, …
$ SZ       &lt;chr&gt; "AMSZ01", "AMSZ02", "AMSZ03", "AMSZ06", "AMSZ07", "AMSZ05", "…</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>We add origin attributes to the flow data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data1 <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pop,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="at">ORIGIN_SZ =</span> <span class="st">"SZ"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ORIGIN_AGE7_12 =</span> AGE7_12,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_AGE13_24 =</span> AGE13_24,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_AGE25_64 =</span> AGE25_64) <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(PA, SZ_NAME))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<p>We add destination attributes to the flow data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> flow_data1 <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pop,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="at">DESTIN_SZ =</span> <span class="st">"SZ"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DESTIN_AGE7_12 =</span> AGE7_12,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_AGE13_24 =</span> AGE13_24,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_AGE25_64 =</span> AGE25_64) <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(PA, SZ_NAME))</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(SIM_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 14,734
Columns: 12
Groups: ORIGIN_SZ [279]
$ ORIGIN_SZ       &lt;chr&gt; "AMSZ01", "AMSZ01", "AMSZ01", "AMSZ01", "AMSZ01", "AMS…
$ DESTIN_SZ       &lt;chr&gt; "AMSZ01", "AMSZ02", "AMSZ03", "AMSZ04", "AMSZ05", "AMS…
$ TRIPS           &lt;dbl&gt; 1998, 8289, 8971, 2252, 6136, 2148, 1620, 1925, 1773, …
$ FlowNoIntra     &lt;dbl&gt; 0, 8289, 8971, 2252, 6136, 2148, 1620, 1925, 1773, 63,…
$ offset          &lt;dbl&gt; 1e-06, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00…
$ dist            &lt;dbl&gt; 50.0000, 810.4491, 1360.9294, 840.4432, 1076.7916, 805…
$ ORIGIN_AGE7_12  &lt;dbl&gt; 310, 310, 310, 310, 310, 310, 310, 310, 310, 310, 310,…
$ ORIGIN_AGE13_24 &lt;dbl&gt; 710, 710, 710, 710, 710, 710, 710, 710, 710, 710, 710,…
$ ORIGIN_AGE25_64 &lt;dbl&gt; 2780, 2780, 2780, 2780, 2780, 2780, 2780, 2780, 2780, …
$ DESTIN_AGE7_12  &lt;dbl&gt; 310, 1140, 1010, 980, 810, 1050, 420, 390, 1190, 0, 0,…
$ DESTIN_AGE13_24 &lt;dbl&gt; 710, 2770, 2650, 2000, 1920, 2390, 1120, 1150, 3260, 0…
$ DESTIN_AGE25_64 &lt;dbl&gt; 2780, 15700, 14240, 11320, 9650, 12460, 3620, 4350, 13…</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="calibrating-spatial-interaction-models" class="level1">
<h1>3. Calibrating Spatial Interaction Models</h1>
<p>In this section, we will calibrate Spatial Interaction Models using Poisson Regression.</p>
<section id="visualise-dependent-variable" class="level2">
<h2 class="anchored" data-anchor-id="visualise-dependent-variable">3.1 Visualise dependent variable</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Histogram of DV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Scatterplot between DV and distance</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Log-transformed scatterplot</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>The distribution of the dependent variable (total number of trips between zones) is shown below. The distribution is highly skewed and has a non-normal distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Hands-on_Ex09B_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>The scatterplot below shows the relationship between the total number of trips and the key independent variable of the Spatial Interaction Model, distance. The relationship does not resemble any linear relationship.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> dist,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Hands-on_Ex09B_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>A log-transformation of both variables reveals a relationship that closely approximates linearity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(dist),</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">log</span>(TRIPS))) <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Hands-on_Ex09B_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="check-for-zero-values" class="level2">
<h2 class="anchored" data-anchor-id="check-for-zero-values">3.2 Check for zero values</h2>
<p>Since Poisson regression uses the natural logarithm, and log(0) is undefined, we must ensure there are no zero values in the explanatory variables. The summary indicates that some variables contain zero values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SIM_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ORIGIN_SZ          DESTIN_SZ             TRIPS         FlowNoIntra      
 Length:14734       Length:14734       Min.   :     1   Min.   :     0.0  
 Class :character   Class :character   1st Qu.:    14   1st Qu.:    13.0  
 Mode  :character   Mode  :character   Median :    76   Median :    70.0  
                                       Mean   :  1021   Mean   :   839.9  
                                       3rd Qu.:   426   3rd Qu.:   379.0  
                                       Max.   :232187   Max.   :148274.0  
     offset              dist       ORIGIN_AGE7_12 ORIGIN_AGE13_24
 Min.   :0.000001   Min.   :   50   Min.   :   0   Min.   :    0  
 1st Qu.:1.000000   1st Qu.: 3346   1st Qu.: 240   1st Qu.:  440  
 Median :1.000000   Median : 6067   Median : 700   Median : 1350  
 Mean   :0.982150   Mean   : 6880   Mean   :1032   Mean   : 2269  
 3rd Qu.:1.000000   3rd Qu.: 9729   3rd Qu.:1480   3rd Qu.: 3260  
 Max.   :1.000000   Max.   :26136   Max.   :6340   Max.   :16380  
 ORIGIN_AGE25_64 DESTIN_AGE7_12 DESTIN_AGE13_24 DESTIN_AGE25_64
 Min.   :    0   Min.   :   0   Min.   :    0   Min.   :    0  
 1st Qu.: 2200   1st Qu.: 240   1st Qu.:  460   1st Qu.: 2200  
 Median : 6810   Median : 720   Median : 1420   Median : 7030  
 Mean   :10487   Mean   :1033   Mean   : 2290   Mean   :10574  
 3rd Qu.:15770   3rd Qu.:1500   3rd Qu.: 3260   3rd Qu.:15830  
 Max.   :74610   Max.   :6340   Max.   :16380   Max.   :74610  </code></pre>
</div>
</div>
</section>
<section id="replace-zero-values-with-0.99" class="level2">
<h2 class="anchored" data-anchor-id="replace-zero-values-with-0.99">3.3 Replace zero values with 0.99</h2>
<p>We replace all zero values in the affected explanatory variables with 0.99.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>DESTIN_AGE7_12 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>DESTIN_AGE7_12 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>DESTIN_AGE7_12)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>DESTIN_AGE13_24 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>DESTIN_AGE13_24 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>DESTIN_AGE13_24)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>DESTIN_AGE25_64 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>DESTIN_AGE25_64 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>DESTIN_AGE25_64)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>ORIGIN_AGE7_12 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>ORIGIN_AGE7_12 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>ORIGIN_AGE7_12)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>ORIGIN_AGE13_24 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>ORIGIN_AGE13_24 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>ORIGIN_AGE13_24)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>ORIGIN_AGE25_64 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>ORIGIN_AGE25_64 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>ORIGIN_AGE25_64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SIM_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ORIGIN_SZ          DESTIN_SZ             TRIPS         FlowNoIntra      
 Length:14734       Length:14734       Min.   :     1   Min.   :     0.0  
 Class :character   Class :character   1st Qu.:    14   1st Qu.:    13.0  
 Mode  :character   Mode  :character   Median :    76   Median :    70.0  
                                       Mean   :  1021   Mean   :   839.9  
                                       3rd Qu.:   426   3rd Qu.:   379.0  
                                       Max.   :232187   Max.   :148274.0  
     offset              dist       ORIGIN_AGE7_12    ORIGIN_AGE13_24   
 Min.   :0.000001   Min.   :   50   Min.   :   0.99   Min.   :    0.99  
 1st Qu.:1.000000   1st Qu.: 3346   1st Qu.: 240.00   1st Qu.:  440.00  
 Median :1.000000   Median : 6067   Median : 700.00   Median : 1350.00  
 Mean   :0.982150   Mean   : 6880   Mean   :1031.86   Mean   : 2268.84  
 3rd Qu.:1.000000   3rd Qu.: 9729   3rd Qu.:1480.00   3rd Qu.: 3260.00  
 Max.   :1.000000   Max.   :26136   Max.   :6340.00   Max.   :16380.00  
 ORIGIN_AGE25_64    DESTIN_AGE7_12    DESTIN_AGE13_24    DESTIN_AGE25_64   
 Min.   :    0.99   Min.   :   0.99   Min.   :    0.99   Min.   :    0.99  
 1st Qu.: 2200.00   1st Qu.: 240.00   1st Qu.:  460.00   1st Qu.: 2200.00  
 Median : 6810.00   Median : 720.00   Median : 1420.00   Median : 7030.00  
 Mean   :10487.62   Mean   :1033.40   Mean   : 2290.35   Mean   :10574.46  
 3rd Qu.:15770.00   3rd Qu.:1500.00   3rd Qu.: 3260.00   3rd Qu.:15830.00  
 Max.   :74610.00   Max.   :6340.00   Max.   :16380.00   Max.   :74610.00  </code></pre>
</div>
</div>
</section>
<section id="unconstrained-sim" class="level2">
<h2 class="anchored" data-anchor-id="unconstrained-sim">3.4 Unconstrained SIM</h2>
<p>We will calibrate an unconstrained SIM with the following explanatory variables:</p>
<ul>
<li>Origin population by different age cohort</li>
<li>Destination population by different age cohort</li>
<li>Distance between origin and destination in kilometers</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Calibrate model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">R-squared value of model</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>uncSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIGIN_AGE7_12) <span class="sc">+</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DESTIN_AGE7_12) <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIGIN_AGE13_24) <span class="sc">+</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DESTIN_AGE13_24) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIGIN_AGE25_64) <span class="sc">+</span> </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DESTIN_AGE25_64) <span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>uncSIM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = TRIPS ~ log(ORIGIN_AGE7_12) + log(DESTIN_AGE7_12) + 
    log(ORIGIN_AGE13_24) + log(DESTIN_AGE13_24) + log(ORIGIN_AGE25_64) + 
    log(DESTIN_AGE25_64) + log(dist), family = poisson(link = "log"), 
    data = SIM_data, na.action = na.exclude)

Coefficients:
         (Intercept)   log(ORIGIN_AGE7_12)   log(DESTIN_AGE7_12)  
             10.8165                0.2906                0.1211  
log(ORIGIN_AGE13_24)  log(DESTIN_AGE13_24)  log(ORIGIN_AGE25_64)  
              0.8176                0.4314               -0.7111  
log(DESTIN_AGE25_64)             log(dist)  
             -0.4464               -0.6860  

Degrees of Freedom: 14733 Total (i.e. Null);  14726 Residual
Null Deviance:      60800000 
Residual Deviance: 34170000     AIC: 34260000</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>To assess how much of the variation in trip counts is explained by the model, we define a function to calculate the R-squared value as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>CalcRSquared <span class="ot">&lt;-</span> <span class="cf">function</span>(observed,estimated){</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed,estimated)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  R2 <span class="ot">&lt;-</span> r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  R2</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The R-squared value of the unconstrained SIM is 0.234.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(uncSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, uncSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2342639</code></pre>
</div>
</div>
<p>The McFadden’s R-squared value of the SIM (a metric commonly used to evaluate the goodness-of-fit in logistic and Poisson regression models) is 0.437.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_mcfadden</span>(uncSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Generalized Linear Regression
       R2: 0.437
  adj. R2: 0.437</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="origin-constrained-sim" class="level2">
<h2 class="anchored" data-anchor-id="origin-constrained-sim">3.5 Origin-constrained SIM</h2>
<p>We calibrate an origin-constrained SIM as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>orcSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                ORIGIN_SZ <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DESTIN_AGE7_12) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DESTIN_AGE13_24) <span class="sc">+</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DESTIN_AGE25_64) <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(orcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + log(DESTIN_AGE7_12) + log(DESTIN_AGE13_24) + 
    log(DESTIN_AGE25_64) + log(dist), family = poisson(link = "log"), 
    data = SIM_data, na.action = na.exclude)

Coefficients:
                       Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)          12.1209378  0.0037844  3202.854  &lt; 2e-16 ***
ORIGIN_SZAMSZ02       1.0187838  0.0044504   228.922  &lt; 2e-16 ***
ORIGIN_SZAMSZ03       0.5683555  0.0045632   124.552  &lt; 2e-16 ***
ORIGIN_SZAMSZ04      -0.0550997  0.0051871   -10.622  &lt; 2e-16 ***
ORIGIN_SZAMSZ05      -0.1860842  0.0057901   -32.138  &lt; 2e-16 ***
ORIGIN_SZAMSZ06       0.4294345  0.0051305    83.702  &lt; 2e-16 ***
ORIGIN_SZAMSZ07      -1.3869513  0.0096832  -143.233  &lt; 2e-16 ***
ORIGIN_SZAMSZ08      -1.0276730  0.0089558  -114.749  &lt; 2e-16 ***
ORIGIN_SZAMSZ09       0.2150720  0.0054086    39.765  &lt; 2e-16 ***
ORIGIN_SZAMSZ10       0.4977037  0.0047166   105.521  &lt; 2e-16 ***
ORIGIN_SZAMSZ11      -1.8750654  0.0128531  -145.884  &lt; 2e-16 ***
ORIGIN_SZAMSZ12      -1.5898468  0.0107575  -147.790  &lt; 2e-16 ***
ORIGIN_SZBDSZ01       1.0857331  0.0043451   249.877  &lt; 2e-16 ***
ORIGIN_SZBDSZ02       0.5150350  0.0050794   101.397  &lt; 2e-16 ***
ORIGIN_SZBDSZ03       0.9924296  0.0044897   221.047  &lt; 2e-16 ***
ORIGIN_SZBDSZ04       1.7594689  0.0038945   451.778  &lt; 2e-16 ***
ORIGIN_SZBDSZ05       0.6406152  0.0045458   140.924  &lt; 2e-16 ***
ORIGIN_SZBDSZ06       0.9224346  0.0045432   203.035  &lt; 2e-16 ***
ORIGIN_SZBDSZ07      -1.2313874  0.0095588  -128.822  &lt; 2e-16 ***
ORIGIN_SZBDSZ08      -1.1530523  0.0090321  -127.662  &lt; 2e-16 ***
ORIGIN_SZBKSZ01      -0.4695429  0.0065384   -71.813  &lt; 2e-16 ***
ORIGIN_SZBKSZ02       0.3594066  0.0051157    70.255  &lt; 2e-16 ***
ORIGIN_SZBKSZ03       0.6220903  0.0049347   126.064  &lt; 2e-16 ***
ORIGIN_SZBKSZ04      -0.1296646  0.0059142   -21.924  &lt; 2e-16 ***
ORIGIN_SZBKSZ05      -0.2303731  0.0058323   -39.499  &lt; 2e-16 ***
ORIGIN_SZBKSZ06       0.0125256  0.0058730     2.133   0.0329 *  
ORIGIN_SZBKSZ07       0.7273948  0.0044270   164.307  &lt; 2e-16 ***
ORIGIN_SZBKSZ08      -0.0027694  0.0053490    -0.518   0.6046    
ORIGIN_SZBKSZ09      -0.1100106  0.0057215   -19.228  &lt; 2e-16 ***
ORIGIN_SZBLSZ01      -1.7371433  0.0148179  -117.233  &lt; 2e-16 ***
ORIGIN_SZBLSZ02      -2.1984262  0.0192395  -114.266  &lt; 2e-16 ***
ORIGIN_SZBLSZ03      -3.2985270  0.0393023   -83.927  &lt; 2e-16 ***
ORIGIN_SZBLSZ04      -2.2535624  0.0230581   -97.734  &lt; 2e-16 ***
ORIGIN_SZBMSZ01      -0.0719379  0.0052227   -13.774  &lt; 2e-16 ***
ORIGIN_SZBMSZ02      -1.0077791  0.0067432  -149.452  &lt; 2e-16 ***
ORIGIN_SZBMSZ03      -0.3856771  0.0057944   -66.560  &lt; 2e-16 ***
ORIGIN_SZBMSZ04       0.0077432  0.0051593     1.501   0.1334    
ORIGIN_SZBMSZ05      -2.2081774  0.0124686  -177.098  &lt; 2e-16 ***
ORIGIN_SZBMSZ06      -2.2438352  0.0161793  -138.685  &lt; 2e-16 ***
ORIGIN_SZBMSZ07      -0.4307340  0.0056542   -76.179  &lt; 2e-16 ***
ORIGIN_SZBMSZ08      -0.5018691  0.0058124   -86.344  &lt; 2e-16 ***
ORIGIN_SZBMSZ09      -1.1512938  0.0086892  -132.498  &lt; 2e-16 ***
ORIGIN_SZBMSZ10      -1.3694760  0.0091320  -149.964  &lt; 2e-16 ***
ORIGIN_SZBMSZ11      -0.7137687  0.0065970  -108.196  &lt; 2e-16 ***
ORIGIN_SZBMSZ12      -0.9607730  0.0091520  -104.980  &lt; 2e-16 ***
ORIGIN_SZBMSZ13      -0.0263432  0.0056935    -4.627 3.71e-06 ***
ORIGIN_SZBMSZ14      -0.4330847  0.0066331   -65.292  &lt; 2e-16 ***
ORIGIN_SZBMSZ15      -0.2319806  0.0060570   -38.299  &lt; 2e-16 ***
ORIGIN_SZBMSZ16      -1.4825258  0.0091453  -162.107  &lt; 2e-16 ***
ORIGIN_SZBMSZ17      -2.1459696  0.0157582  -136.181  &lt; 2e-16 ***
ORIGIN_SZBPSZ01       0.1156815  0.0055531    20.832  &lt; 2e-16 ***
ORIGIN_SZBPSZ02      -0.0741048  0.0064631   -11.466  &lt; 2e-16 ***
ORIGIN_SZBPSZ03       0.1167847  0.0061504    18.988  &lt; 2e-16 ***
ORIGIN_SZBPSZ04       0.3474867  0.0050839    68.350  &lt; 2e-16 ***
ORIGIN_SZBPSZ05       0.5308027  0.0045543   116.550  &lt; 2e-16 ***
ORIGIN_SZBPSZ06      -1.4100989  0.0093113  -151.440  &lt; 2e-16 ***
ORIGIN_SZBPSZ07      -1.0089222  0.0085753  -117.654  &lt; 2e-16 ***
ORIGIN_SZBSSZ01      -0.0108455  0.0052757    -2.056   0.0398 *  
ORIGIN_SZBSSZ02       0.3139191  0.0047875    65.570  &lt; 2e-16 ***
ORIGIN_SZBSSZ03       0.2733735  0.0046890    58.302  &lt; 2e-16 ***
ORIGIN_SZBTSZ01      -0.0699347  0.0053853   -12.986  &lt; 2e-16 ***
ORIGIN_SZBTSZ02      -1.0635587  0.0077970  -136.405  &lt; 2e-16 ***
ORIGIN_SZBTSZ03      -0.2621867  0.0057277   -45.775  &lt; 2e-16 ***
ORIGIN_SZBTSZ04      -1.0648632  0.0101890  -104.511  &lt; 2e-16 ***
ORIGIN_SZBTSZ05      -1.6468606  0.0110013  -149.697  &lt; 2e-16 ***
ORIGIN_SZBTSZ06      -0.8059153  0.0071811  -112.228  &lt; 2e-16 ***
ORIGIN_SZBTSZ07      -2.2721680  0.0132102  -172.001  &lt; 2e-16 ***
ORIGIN_SZBTSZ08      -1.2775355  0.0093948  -135.983  &lt; 2e-16 ***
ORIGIN_SZCBSZ01      -1.9468532  0.0548336   -35.505  &lt; 2e-16 ***
ORIGIN_SZCCSZ01      -1.7856729  0.0133115  -134.145  &lt; 2e-16 ***
ORIGIN_SZCHSZ01      -1.0003449  0.0117996   -84.778  &lt; 2e-16 ***
ORIGIN_SZCHSZ02      -0.4972406  0.0079404   -62.622  &lt; 2e-16 ***
ORIGIN_SZCHSZ03       0.3958020  0.0058418    67.753  &lt; 2e-16 ***
ORIGIN_SZCKSZ01       0.1577865  0.0051180    30.830  &lt; 2e-16 ***
ORIGIN_SZCKSZ02       0.6382508  0.0050885   125.430  &lt; 2e-16 ***
ORIGIN_SZCKSZ03       0.7558740  0.0045236   167.094  &lt; 2e-16 ***
ORIGIN_SZCKSZ04       1.2463598  0.0045636   273.108  &lt; 2e-16 ***
ORIGIN_SZCKSZ05       0.9055034  0.0053128   170.437  &lt; 2e-16 ***
ORIGIN_SZCKSZ06       1.1556716  0.0050486   228.911  &lt; 2e-16 ***
ORIGIN_SZCLSZ01      -0.7060065  0.0076614   -92.151  &lt; 2e-16 ***
ORIGIN_SZCLSZ02      -1.8140877  0.0136423  -132.975  &lt; 2e-16 ***
ORIGIN_SZCLSZ03      -1.0109639  0.0079490  -127.181  &lt; 2e-16 ***
ORIGIN_SZCLSZ04       0.7095453  0.0044600   159.092  &lt; 2e-16 ***
ORIGIN_SZCLSZ05      -1.9619359  0.0147402  -133.101  &lt; 2e-16 ***
ORIGIN_SZCLSZ06       0.8620589  0.0042038   205.065  &lt; 2e-16 ***
ORIGIN_SZCLSZ07      -0.2998150  0.0055762   -53.767  &lt; 2e-16 ***
ORIGIN_SZCLSZ08       0.3414354  0.0058028    58.840  &lt; 2e-16 ***
ORIGIN_SZCLSZ09      -1.7219806  0.0155521  -110.723  &lt; 2e-16 ***
ORIGIN_SZDTSZ02      -3.9272928  0.0834098   -47.084  &lt; 2e-16 ***
ORIGIN_SZDTSZ03      -3.9389954  0.0738072   -53.369  &lt; 2e-16 ***
ORIGIN_SZDTSZ13      -2.9461670  0.0312869   -94.166  &lt; 2e-16 ***
ORIGIN_SZGLSZ01      -1.3996966  0.0091924  -152.267  &lt; 2e-16 ***
ORIGIN_SZGLSZ02       0.2815576  0.0048888    57.592  &lt; 2e-16 ***
ORIGIN_SZGLSZ03       0.2733219  0.0048555    56.291  &lt; 2e-16 ***
ORIGIN_SZGLSZ04       0.8707052  0.0042000   207.312  &lt; 2e-16 ***
ORIGIN_SZGLSZ05       0.6317012  0.0043754   144.376  &lt; 2e-16 ***
ORIGIN_SZHGSZ01       0.2906030  0.0047461    61.230  &lt; 2e-16 ***
ORIGIN_SZHGSZ02       0.4788240  0.0047122   101.615  &lt; 2e-16 ***
ORIGIN_SZHGSZ03       0.2555574  0.0051134    49.978  &lt; 2e-16 ***
ORIGIN_SZHGSZ04       0.9087384  0.0043033   211.171  &lt; 2e-16 ***
ORIGIN_SZHGSZ05       1.1511138  0.0042539   270.602  &lt; 2e-16 ***
ORIGIN_SZHGSZ06      -0.1086696  0.0054130   -20.076  &lt; 2e-16 ***
ORIGIN_SZHGSZ07       0.6938958  0.0044553   155.746  &lt; 2e-16 ***
ORIGIN_SZHGSZ08       0.1013003  0.0053537    18.922  &lt; 2e-16 ***
ORIGIN_SZHGSZ09      -0.5643866  0.0069627   -81.058  &lt; 2e-16 ***
ORIGIN_SZHGSZ10      -3.5568988  0.0421146   -84.458  &lt; 2e-16 ***
ORIGIN_SZJESZ01       0.3884172  0.0048694    79.766  &lt; 2e-16 ***
ORIGIN_SZJESZ02       0.2229854  0.0049245    45.281  &lt; 2e-16 ***
ORIGIN_SZJESZ03       0.1749558  0.0052879    33.086  &lt; 2e-16 ***
ORIGIN_SZJESZ04      -0.9992402  0.0091447  -109.270  &lt; 2e-16 ***
ORIGIN_SZJESZ05      -2.0565379  0.0138164  -148.848  &lt; 2e-16 ***
ORIGIN_SZJESZ06       0.2846112  0.0048635    58.520  &lt; 2e-16 ***
ORIGIN_SZJESZ07      -1.9055953  0.0118336  -161.032  &lt; 2e-16 ***
ORIGIN_SZJESZ08      -1.0712086  0.0114719   -93.376  &lt; 2e-16 ***
ORIGIN_SZJESZ09       0.5213418  0.0049596   105.117  &lt; 2e-16 ***
ORIGIN_SZJESZ10      -1.8678483  0.0179990  -103.775  &lt; 2e-16 ***
ORIGIN_SZJESZ11      -2.0531200  0.0193105  -106.321  &lt; 2e-16 ***
ORIGIN_SZJWSZ01       0.1757580  0.0064058    27.437  &lt; 2e-16 ***
ORIGIN_SZJWSZ02       0.8615814  0.0045219   190.537  &lt; 2e-16 ***
ORIGIN_SZJWSZ03       1.2436554  0.0041883   296.936  &lt; 2e-16 ***
ORIGIN_SZJWSZ04       1.2695751  0.0042803   296.611  &lt; 2e-16 ***
ORIGIN_SZJWSZ05      -1.4401318  0.0125157  -115.066  &lt; 2e-16 ***
ORIGIN_SZJWSZ06      -1.0717271  0.0106704  -100.439  &lt; 2e-16 ***
ORIGIN_SZJWSZ07      -2.7512270  0.0275134   -99.996  &lt; 2e-16 ***
ORIGIN_SZJWSZ08       1.8682135  0.0041149   454.017  &lt; 2e-16 ***
ORIGIN_SZJWSZ09       1.7847006  0.0039011   457.486  &lt; 2e-16 ***
ORIGIN_SZKLSZ01       0.1995591  0.0049023    40.707  &lt; 2e-16 ***
ORIGIN_SZKLSZ02      -0.4523335  0.0063224   -71.545  &lt; 2e-16 ***
ORIGIN_SZKLSZ03      -0.3595233  0.0059501   -60.423  &lt; 2e-16 ***
ORIGIN_SZKLSZ04      -2.1912270  0.0118737  -184.544  &lt; 2e-16 ***
ORIGIN_SZKLSZ05      -0.7904405  0.0082724   -95.552  &lt; 2e-16 ***
ORIGIN_SZKLSZ06      -4.5781225  0.1857303   -24.649  &lt; 2e-16 ***
ORIGIN_SZKLSZ07      -1.0553296  0.0084090  -125.500  &lt; 2e-16 ***
ORIGIN_SZKLSZ08      -1.4333180  0.0091526  -156.602  &lt; 2e-16 ***
ORIGIN_SZLKSZ01      -3.3183770  0.0387450   -85.647  &lt; 2e-16 ***
ORIGIN_SZMDSZ01      -2.6480242  0.0280231   -94.494  &lt; 2e-16 ***
ORIGIN_SZMDSZ02      -0.9531449  0.0103551   -92.046  &lt; 2e-16 ***
ORIGIN_SZMDSZ03      -2.0097262  0.0170309  -118.005  &lt; 2e-16 ***
ORIGIN_SZMPSZ01      -1.0632250  0.0083675  -127.066  &lt; 2e-16 ***
ORIGIN_SZMPSZ02      -0.5590933  0.0068986   -81.044  &lt; 2e-16 ***
ORIGIN_SZMPSZ03       0.0125385  0.0053192     2.357   0.0184 *  
ORIGIN_SZMUSZ02      -3.8374234  0.1037565   -36.985  &lt; 2e-16 ***
ORIGIN_SZNTSZ01      -2.8373583  0.0352949   -80.390  &lt; 2e-16 ***
ORIGIN_SZNTSZ02      -3.1538933  0.0232290  -135.774  &lt; 2e-16 ***
ORIGIN_SZNTSZ03      -0.8515395  0.0077806  -109.443  &lt; 2e-16 ***
ORIGIN_SZNTSZ05      -3.2637875  0.0496355   -65.755  &lt; 2e-16 ***
ORIGIN_SZNTSZ06      -3.7496896  0.0557554   -67.252  &lt; 2e-16 ***
ORIGIN_SZNVSZ01       0.4959413  0.0044827   110.635  &lt; 2e-16 ***
ORIGIN_SZNVSZ02      -0.5530790  0.0064719   -85.459  &lt; 2e-16 ***
ORIGIN_SZNVSZ03      -1.1862516  0.0077877  -152.323  &lt; 2e-16 ***
ORIGIN_SZNVSZ04      -1.4642910  0.0090910  -161.070  &lt; 2e-16 ***
ORIGIN_SZNVSZ05      -2.5864659  0.0157862  -163.844  &lt; 2e-16 ***
ORIGIN_SZPGSZ01      -0.7885243  0.0122311   -64.469  &lt; 2e-16 ***
ORIGIN_SZPGSZ02      -0.5217885  0.0072345   -72.125  &lt; 2e-16 ***
ORIGIN_SZPGSZ03       0.9421480  0.0044396   212.214  &lt; 2e-16 ***
ORIGIN_SZPGSZ04       1.0450387  0.0044216   236.346  &lt; 2e-16 ***
ORIGIN_SZPGSZ05       0.2263192  0.0057633    39.269  &lt; 2e-16 ***
ORIGIN_SZPLSZ01      -0.8480823  0.0104369   -81.258  &lt; 2e-16 ***
ORIGIN_SZPLSZ02      -1.7175782  0.0147790  -116.218  &lt; 2e-16 ***
ORIGIN_SZPLSZ03      -2.9936592  0.0367204   -81.526  &lt; 2e-16 ***
ORIGIN_SZPLSZ04      -3.3026314  0.0368383   -89.652  &lt; 2e-16 ***
ORIGIN_SZPLSZ05      -2.4897914  0.0224504  -110.902  &lt; 2e-16 ***
ORIGIN_SZPNSZ01       1.3589692  0.0045842   296.448  &lt; 2e-16 ***
ORIGIN_SZPNSZ02      -0.5485444  0.0110824   -49.497  &lt; 2e-16 ***
ORIGIN_SZPNSZ03      -1.9287895  0.0194002   -99.421  &lt; 2e-16 ***
ORIGIN_SZPNSZ04      -2.8062198  0.0311201   -90.174  &lt; 2e-16 ***
ORIGIN_SZPNSZ05      -2.3203138  0.0262763   -88.305  &lt; 2e-16 ***
ORIGIN_SZPRSZ01      -0.8321444  0.0114154   -72.897  &lt; 2e-16 ***
ORIGIN_SZPRSZ02       0.8980816  0.0046165   194.538  &lt; 2e-16 ***
ORIGIN_SZPRSZ03       0.7532873  0.0046266   162.816  &lt; 2e-16 ***
ORIGIN_SZPRSZ04      -0.3757327  0.0075164   -49.989  &lt; 2e-16 ***
ORIGIN_SZPRSZ05       1.2817237  0.0043273   296.193  &lt; 2e-16 ***
ORIGIN_SZPRSZ06      -0.4042531  0.0086514   -46.727  &lt; 2e-16 ***
ORIGIN_SZPRSZ07      -2.1300641  0.0161047  -132.264  &lt; 2e-16 ***
ORIGIN_SZPRSZ08      -0.0102792  0.0063830    -1.610   0.1073    
ORIGIN_SZQTSZ01      -0.3187953  0.0068482   -46.552  &lt; 2e-16 ***
ORIGIN_SZQTSZ02      -0.7542760  0.0063275  -119.207  &lt; 2e-16 ***
ORIGIN_SZQTSZ03      -0.1674438  0.0056836   -29.461  &lt; 2e-16 ***
ORIGIN_SZQTSZ04      -0.9784607  0.0071297  -137.237  &lt; 2e-16 ***
ORIGIN_SZQTSZ05      -0.3031218  0.0059964   -50.550  &lt; 2e-16 ***
ORIGIN_SZQTSZ06      -0.5162679  0.0064822   -79.644  &lt; 2e-16 ***
ORIGIN_SZQTSZ07      -1.3977412  0.0096370  -145.039  &lt; 2e-16 ***
ORIGIN_SZQTSZ08      -0.0641033  0.0057007   -11.245  &lt; 2e-16 ***
ORIGIN_SZQTSZ09      -0.6332869  0.0066340   -95.461  &lt; 2e-16 ***
ORIGIN_SZQTSZ10      -0.4798813  0.0065145   -73.663  &lt; 2e-16 ***
ORIGIN_SZQTSZ11      -1.7680890  0.0098789  -178.977  &lt; 2e-16 ***
ORIGIN_SZQTSZ12      -1.4664096  0.0104393  -140.471  &lt; 2e-16 ***
ORIGIN_SZQTSZ13      -0.3321663  0.0064150   -51.780  &lt; 2e-16 ***
ORIGIN_SZQTSZ14      -1.5411842  0.0098475  -156.505  &lt; 2e-16 ***
ORIGIN_SZQTSZ15      -0.9795208  0.0102743   -95.337  &lt; 2e-16 ***
ORIGIN_SZRCSZ01      -1.3230264  0.0126536  -104.557  &lt; 2e-16 ***
ORIGIN_SZRCSZ06      -0.5882674  0.0084750   -69.412  &lt; 2e-16 ***
ORIGIN_SZRVSZ01      -3.4226656  0.0323717  -105.730  &lt; 2e-16 ***
ORIGIN_SZRVSZ02      -2.7988845  0.0277647  -100.807  &lt; 2e-16 ***
ORIGIN_SZRVSZ03      -3.0305951  0.0237875  -127.403  &lt; 2e-16 ***
ORIGIN_SZRVSZ04      -3.2779444  0.0556701   -58.882  &lt; 2e-16 ***
ORIGIN_SZRVSZ05      -2.2791731  0.0164437  -138.605  &lt; 2e-16 ***
ORIGIN_SZSBSZ01       0.6341692  0.0055297   114.685  &lt; 2e-16 ***
ORIGIN_SZSBSZ02      -0.7238164  0.0082129   -88.132  &lt; 2e-16 ***
ORIGIN_SZSBSZ03       0.9114552  0.0046127   197.597  &lt; 2e-16 ***
ORIGIN_SZSBSZ04       0.6858447  0.0052926   129.587  &lt; 2e-16 ***
ORIGIN_SZSBSZ05      -0.1301508  0.0065439   -19.889  &lt; 2e-16 ***
ORIGIN_SZSBSZ06      -1.7360445  0.0171922  -100.979  &lt; 2e-16 ***
ORIGIN_SZSBSZ07      -1.1789839  0.0125568   -93.892  &lt; 2e-16 ***
ORIGIN_SZSBSZ08      -1.2426128  0.0122175  -101.707  &lt; 2e-16 ***
ORIGIN_SZSBSZ09      -0.6467589  0.0085797   -75.382  &lt; 2e-16 ***
ORIGIN_SZSESZ02       0.9437017  0.0044111   213.936  &lt; 2e-16 ***
ORIGIN_SZSESZ03       1.1729037  0.0041655   281.575  &lt; 2e-16 ***
ORIGIN_SZSESZ04       0.7654128  0.0048718   157.110  &lt; 2e-16 ***
ORIGIN_SZSESZ05      -0.2294461  0.0059158   -38.785  &lt; 2e-16 ***
ORIGIN_SZSESZ06       0.6975898  0.0046912   148.702  &lt; 2e-16 ***
ORIGIN_SZSESZ07      -2.5700065  0.0196084  -131.067  &lt; 2e-16 ***
ORIGIN_SZSGSZ01      -1.0544617  0.0085507  -123.319  &lt; 2e-16 ***
ORIGIN_SZSGSZ02      -1.1336073  0.0095894  -118.214  &lt; 2e-16 ***
ORIGIN_SZSGSZ03       0.2011727  0.0051675    38.930  &lt; 2e-16 ***
ORIGIN_SZSGSZ04       0.2624590  0.0047915    54.776  &lt; 2e-16 ***
ORIGIN_SZSGSZ05      -1.7768714  0.0105974  -167.671  &lt; 2e-16 ***
ORIGIN_SZSGSZ06       0.4199408  0.0045407    92.483  &lt; 2e-16 ***
ORIGIN_SZSGSZ07      -0.6068962  0.0062347   -97.342  &lt; 2e-16 ***
ORIGIN_SZSKSZ01      -0.2113948  0.0077648   -27.225  &lt; 2e-16 ***
ORIGIN_SZSKSZ02       0.5327488  0.0056933    93.574  &lt; 2e-16 ***
ORIGIN_SZSKSZ03      -0.7103912  0.0079832   -88.986  &lt; 2e-16 ***
ORIGIN_SZSKSZ04      -2.5754920  0.0270186   -95.323  &lt; 2e-16 ***
ORIGIN_SZSKSZ05      -1.4178945  0.0155167   -91.379  &lt; 2e-16 ***
ORIGIN_SZSLSZ01      -3.2481927  0.0305825  -106.211  &lt; 2e-16 ***
ORIGIN_SZSLSZ04      -0.6891163  0.0076938   -89.568  &lt; 2e-16 ***
ORIGIN_SZSRSZ01      -2.2351063  0.0158286  -141.207  &lt; 2e-16 ***
ORIGIN_SZTHSZ01      -2.2503101  0.0488674   -46.049  &lt; 2e-16 ***
ORIGIN_SZTHSZ03      -2.2773119  0.0224274  -101.542  &lt; 2e-16 ***
ORIGIN_SZTHSZ04      -2.0423201  0.0286889   -71.189  &lt; 2e-16 ***
ORIGIN_SZTHSZ06      -2.2955290  0.0178414  -128.663  &lt; 2e-16 ***
ORIGIN_SZTMSZ01       0.4824051  0.0058158    82.948  &lt; 2e-16 ***
ORIGIN_SZTMSZ02       2.1911756  0.0037956   577.295  &lt; 2e-16 ***
ORIGIN_SZTMSZ03       1.3958381  0.0041089   339.712  &lt; 2e-16 ***
ORIGIN_SZTMSZ04       0.9023632  0.0047421   190.286  &lt; 2e-16 ***
ORIGIN_SZTMSZ05      -0.2645831  0.0075358   -35.110  &lt; 2e-16 ***
ORIGIN_SZTNSZ01      -1.7828391  0.0103757  -171.829  &lt; 2e-16 ***
ORIGIN_SZTNSZ02      -1.6482997  0.0097794  -168.548  &lt; 2e-16 ***
ORIGIN_SZTNSZ03      -2.1974006  0.0133771  -164.266  &lt; 2e-16 ***
ORIGIN_SZTNSZ04      -0.7492096  0.0071974  -104.094  &lt; 2e-16 ***
ORIGIN_SZTPSZ01      -0.5842570  0.0062883   -92.912  &lt; 2e-16 ***
ORIGIN_SZTPSZ02       0.5020483  0.0043476   115.476  &lt; 2e-16 ***
ORIGIN_SZTPSZ03      -0.4998092  0.0060847   -82.141  &lt; 2e-16 ***
ORIGIN_SZTPSZ04      -0.2388066  0.0057798   -41.317  &lt; 2e-16 ***
ORIGIN_SZTPSZ05      -0.1520051  0.0060743   -25.024  &lt; 2e-16 ***
ORIGIN_SZTPSZ06       0.4095248  0.0059459    68.875  &lt; 2e-16 ***
ORIGIN_SZTPSZ07      -0.1762519  0.0063193   -27.891  &lt; 2e-16 ***
ORIGIN_SZTPSZ08      -1.0247450  0.0091101  -112.484  &lt; 2e-16 ***
ORIGIN_SZTPSZ09      -0.3187897  0.0061903   -51.498  &lt; 2e-16 ***
ORIGIN_SZTPSZ10      -0.6488288  0.0076354   -84.976  &lt; 2e-16 ***
ORIGIN_SZTPSZ11       0.1463240  0.0054609    26.795  &lt; 2e-16 ***
ORIGIN_SZTPSZ12      -0.5602149  0.0065225   -85.889  &lt; 2e-16 ***
ORIGIN_SZTSSZ01      -3.5581922  0.0473866   -75.089  &lt; 2e-16 ***
ORIGIN_SZTSSZ02       0.2507171  0.0073339    34.186  &lt; 2e-16 ***
ORIGIN_SZTSSZ03       0.3189859  0.0070725    45.102  &lt; 2e-16 ***
ORIGIN_SZTSSZ04       0.3148947  0.0074623    42.198  &lt; 2e-16 ***
ORIGIN_SZTSSZ05      -1.1475836  0.0140359   -81.760  &lt; 2e-16 ***
ORIGIN_SZTSSZ06      -1.3520272  0.0171764   -78.714  &lt; 2e-16 ***
ORIGIN_SZWCSZ01      -0.1244050  0.0078600   -15.828  &lt; 2e-16 ***
ORIGIN_SZWCSZ02      -2.9222918  0.0315944   -92.494  &lt; 2e-16 ***
ORIGIN_SZWCSZ03      -4.2194432  0.1240860   -34.004  &lt; 2e-16 ***
ORIGIN_SZWDSZ01       1.3310700  0.0041463   321.028  &lt; 2e-16 ***
ORIGIN_SZWDSZ02       0.9453630  0.0047521   198.934  &lt; 2e-16 ***
ORIGIN_SZWDSZ03       2.0578468  0.0040469   508.495  &lt; 2e-16 ***
ORIGIN_SZWDSZ04       1.0164885  0.0049713   204.471  &lt; 2e-16 ***
ORIGIN_SZWDSZ05       0.4654287  0.0049999    93.087  &lt; 2e-16 ***
ORIGIN_SZWDSZ06       1.1591226  0.0046126   251.292  &lt; 2e-16 ***
ORIGIN_SZWDSZ07      -0.4168250  0.0080345   -51.879  &lt; 2e-16 ***
ORIGIN_SZWDSZ08      -0.5361245  0.0078779   -68.054  &lt; 2e-16 ***
ORIGIN_SZWDSZ09       1.4544589  0.0044030   330.337  &lt; 2e-16 ***
ORIGIN_SZYSSZ01      -0.1372251  0.0056434   -24.316  &lt; 2e-16 ***
ORIGIN_SZYSSZ02       0.8831289  0.0049730   177.584  &lt; 2e-16 ***
ORIGIN_SZYSSZ03       1.7332402  0.0042770   405.250  &lt; 2e-16 ***
ORIGIN_SZYSSZ04       0.8404561  0.0045384   185.186  &lt; 2e-16 ***
ORIGIN_SZYSSZ05      -0.1120440  0.0059210   -18.923  &lt; 2e-16 ***
ORIGIN_SZYSSZ06      -1.1650420  0.0107940  -107.934  &lt; 2e-16 ***
ORIGIN_SZYSSZ07      -1.1647600  0.0112679  -103.370  &lt; 2e-16 ***
ORIGIN_SZYSSZ08       0.0521578  0.0061045     8.544  &lt; 2e-16 ***
ORIGIN_SZYSSZ09       1.3640045  0.0042393   321.750  &lt; 2e-16 ***
log(DESTIN_AGE7_12)   0.0310508  0.0005469    56.778  &lt; 2e-16 ***
log(DESTIN_AGE13_24)  0.3696152  0.0008476   436.066  &lt; 2e-16 ***
log(DESTIN_AGE25_64) -0.3156201  0.0007399  -426.552  &lt; 2e-16 ***
log(dist)            -0.6877846  0.0001306 -5266.858  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 60796037  on 14733  degrees of freedom
Residual deviance: 26504448  on 14451  degrees of freedom
AIC: 26596641

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>The R-squared value of the origin-constrained SIM is 0.425.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(orcSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, orcSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4245111</code></pre>
</div>
</div>
</section>
<section id="destination-constrained-sim" class="level2">
<h2 class="anchored" data-anchor-id="destination-constrained-sim">3.6 Destination-constrained SIM</h2>
<p>We calibrate a destination-constrained SIM as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>decSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>                DESTIN_SZ <span class="sc">+</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIGIN_AGE7_12) <span class="sc">+</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIGIN_AGE13_24) <span class="sc">+</span> </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIGIN_AGE25_64) <span class="sc">+</span> </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(decSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ DESTIN_SZ + log(ORIGIN_AGE7_12) + log(ORIGIN_AGE13_24) + 
    log(ORIGIN_AGE25_64) + log(dist), family = poisson(link = "log"), 
    data = SIM_data, na.action = na.exclude)

Coefficients:
                       Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)          11.0720649  0.0033387  3316.311  &lt; 2e-16 ***
DESTIN_SZAMSZ02       0.1852968  0.0041527    44.621  &lt; 2e-16 ***
DESTIN_SZAMSZ03       0.2128031  0.0040885    52.049  &lt; 2e-16 ***
DESTIN_SZAMSZ04      -0.8972995  0.0060638  -147.976  &lt; 2e-16 ***
DESTIN_SZAMSZ05      -1.1339418  0.0061804  -183.473  &lt; 2e-16 ***
DESTIN_SZAMSZ06      -0.8487725  0.0059244  -143.267  &lt; 2e-16 ***
DESTIN_SZAMSZ07      -1.8066517  0.0096073  -188.049  &lt; 2e-16 ***
DESTIN_SZAMSZ08      -1.0799461  0.0067767  -159.362  &lt; 2e-16 ***
DESTIN_SZAMSZ09      -0.9952558  0.0060438  -164.673  &lt; 2e-16 ***
DESTIN_SZAMSZ10       0.2201892  0.0043741    50.340  &lt; 2e-16 ***
DESTIN_SZAMSZ11      -0.4349092  0.0086213   -50.446  &lt; 2e-16 ***
DESTIN_SZAMSZ12       0.0158986  0.0049856     3.189  0.00143 ** 
DESTIN_SZBDSZ01       0.5117016  0.0037830   135.263  &lt; 2e-16 ***
DESTIN_SZBDSZ02      -0.3307180  0.0049527   -66.775  &lt; 2e-16 ***
DESTIN_SZBDSZ03      -0.0232998  0.0042692    -5.458 4.83e-08 ***
DESTIN_SZBDSZ04       0.9540570  0.0034477   276.724  &lt; 2e-16 ***
DESTIN_SZBDSZ05       0.3392867  0.0039002    86.992  &lt; 2e-16 ***
DESTIN_SZBDSZ06       0.1597645  0.0042193    37.865  &lt; 2e-16 ***
DESTIN_SZBDSZ07      -1.0478710  0.0092938  -112.750  &lt; 2e-16 ***
DESTIN_SZBDSZ08      -1.8110923  0.0105724  -171.305  &lt; 2e-16 ***
DESTIN_SZBKSZ01      -1.2422949  0.0065586  -189.415  &lt; 2e-16 ***
DESTIN_SZBKSZ02      -0.2862891  0.0052053   -55.000  &lt; 2e-16 ***
DESTIN_SZBKSZ03      -0.5531058  0.0055616   -99.451  &lt; 2e-16 ***
DESTIN_SZBKSZ04      -0.0780893  0.0048278   -16.175  &lt; 2e-16 ***
DESTIN_SZBKSZ05      -0.8894679  0.0057113  -155.739  &lt; 2e-16 ***
DESTIN_SZBKSZ06      -0.8735113  0.0060936  -143.349  &lt; 2e-16 ***
DESTIN_SZBKSZ07       0.2008727  0.0040341    49.794  &lt; 2e-16 ***
DESTIN_SZBKSZ08      -1.1080882  0.0068759  -161.155  &lt; 2e-16 ***
DESTIN_SZBKSZ09      -0.3079773  0.0049065   -62.769  &lt; 2e-16 ***
DESTIN_SZBLSZ01      -0.5623349  0.0070249   -80.049  &lt; 2e-16 ***
DESTIN_SZBLSZ02       0.4534757  0.0065229    69.520  &lt; 2e-16 ***
DESTIN_SZBLSZ03       1.0664524  0.0074195   143.736  &lt; 2e-16 ***
DESTIN_SZBLSZ04      -0.3209662  0.0131597   -24.390  &lt; 2e-16 ***
DESTIN_SZBMSZ01      -0.2698406  0.0046919   -57.512  &lt; 2e-16 ***
DESTIN_SZBMSZ02      -0.4965536  0.0048849  -101.651  &lt; 2e-16 ***
DESTIN_SZBMSZ03      -0.7906801  0.0056859  -139.061  &lt; 2e-16 ***
DESTIN_SZBMSZ04      -0.4284013  0.0048904   -87.601  &lt; 2e-16 ***
DESTIN_SZBMSZ05      -0.4199940  0.0065983   -63.652  &lt; 2e-16 ***
DESTIN_SZBMSZ06      -1.9147547  0.0123063  -155.591  &lt; 2e-16 ***
DESTIN_SZBMSZ07      -0.2265615  0.0045297   -50.017  &lt; 2e-16 ***
DESTIN_SZBMSZ08      -1.1619546  0.0062636  -185.509  &lt; 2e-16 ***
DESTIN_SZBMSZ09      -2.6442887  0.0143545  -184.213  &lt; 2e-16 ***
DESTIN_SZBMSZ10      -1.7643824  0.0089290  -197.602  &lt; 2e-16 ***
DESTIN_SZBMSZ11      -1.5842892  0.0079304  -199.774  &lt; 2e-16 ***
DESTIN_SZBMSZ12      -1.0167052  0.0077744  -130.776  &lt; 2e-16 ***
DESTIN_SZBMSZ13      -0.4371753  0.0050839   -85.991  &lt; 2e-16 ***
DESTIN_SZBMSZ14      -0.9577515  0.0076374  -125.403  &lt; 2e-16 ***
DESTIN_SZBMSZ15      -1.0854212  0.0068710  -157.972  &lt; 2e-16 ***
DESTIN_SZBMSZ16      -2.2953368  0.0107911  -212.707  &lt; 2e-16 ***
DESTIN_SZBMSZ17      -2.6322277  0.0164773  -159.749  &lt; 2e-16 ***
DESTIN_SZBPSZ01      -0.7101053  0.0054624  -129.998  &lt; 2e-16 ***
DESTIN_SZBPSZ02      -1.5474896  0.0083287  -185.803  &lt; 2e-16 ***
DESTIN_SZBPSZ03      -1.1611407  0.0075123  -154.565  &lt; 2e-16 ***
DESTIN_SZBPSZ04      -0.7028609  0.0058078  -121.020  &lt; 2e-16 ***
DESTIN_SZBPSZ05       0.2754829  0.0039525    69.699  &lt; 2e-16 ***
DESTIN_SZBPSZ06      -1.0077024  0.0077403  -130.189  &lt; 2e-16 ***
DESTIN_SZBPSZ07      -0.7413012  0.0077771   -95.319  &lt; 2e-16 ***
DESTIN_SZBSSZ01      -0.3194362  0.0045804   -69.739  &lt; 2e-16 ***
DESTIN_SZBSSZ02      -0.7820187  0.0051078  -153.102  &lt; 2e-16 ***
DESTIN_SZBSSZ03       0.2033281  0.0038255    53.151  &lt; 2e-16 ***
DESTIN_SZBTSZ01       0.0302978  0.0041594     7.284 3.23e-13 ***
DESTIN_SZBTSZ02      -0.8721155  0.0065666  -132.810  &lt; 2e-16 ***
DESTIN_SZBTSZ03      -0.2200433  0.0047958   -45.882  &lt; 2e-16 ***
DESTIN_SZBTSZ04      -1.8039520  0.0103713  -173.938  &lt; 2e-16 ***
DESTIN_SZBTSZ05      -0.8947709  0.0067421  -132.714  &lt; 2e-16 ***
DESTIN_SZBTSZ06      -0.8364293  0.0059757  -139.972  &lt; 2e-16 ***
DESTIN_SZBTSZ07      -2.0772780  0.0105603  -196.705  &lt; 2e-16 ***
DESTIN_SZBTSZ08      -1.3236499  0.0086834  -152.434  &lt; 2e-16 ***
DESTIN_SZCBSZ01      -4.8301319  0.3162418   -15.274  &lt; 2e-16 ***
DESTIN_SZCCSZ01      -1.0207882  0.0080154  -127.353  &lt; 2e-16 ***
DESTIN_SZCHSZ01      -1.0389616  0.0095291  -109.030  &lt; 2e-16 ***
DESTIN_SZCHSZ02       0.0656864  0.0052279    12.565  &lt; 2e-16 ***
DESTIN_SZCHSZ03       1.3924466  0.0039118   355.956  &lt; 2e-16 ***
DESTIN_SZCKSZ01      -0.2127434  0.0047578   -44.715  &lt; 2e-16 ***
DESTIN_SZCKSZ02      -0.5167632  0.0051559  -100.227  &lt; 2e-16 ***
DESTIN_SZCKSZ03       0.5383421  0.0038672   139.207  &lt; 2e-16 ***
DESTIN_SZCKSZ04      -0.7282445  0.0059886  -121.605  &lt; 2e-16 ***
DESTIN_SZCKSZ05      -0.6074140  0.0065447   -92.810  &lt; 2e-16 ***
DESTIN_SZCKSZ06       0.4961340  0.0045254   109.634  &lt; 2e-16 ***
DESTIN_SZCLSZ01       0.3122676  0.0047425    65.845  &lt; 2e-16 ***
DESTIN_SZCLSZ02      -2.3030933  0.0133374  -172.679  &lt; 2e-16 ***
DESTIN_SZCLSZ03      -1.0832335  0.0076555  -141.497  &lt; 2e-16 ***
DESTIN_SZCLSZ04      -0.1319656  0.0044889   -29.398  &lt; 2e-16 ***
DESTIN_SZCLSZ05      -1.3767449  0.0084080  -163.742  &lt; 2e-16 ***
DESTIN_SZCLSZ06       0.1588305  0.0040207    39.504  &lt; 2e-16 ***
DESTIN_SZCLSZ07      -0.6651443  0.0052627  -126.389  &lt; 2e-16 ***
DESTIN_SZCLSZ08      -0.4300984  0.0057224   -75.161  &lt; 2e-16 ***
DESTIN_SZCLSZ09       0.3632491  0.0063773    56.960  &lt; 2e-16 ***
DESTIN_SZDTSZ02      -2.8860959  0.0348379   -82.844  &lt; 2e-16 ***
DESTIN_SZDTSZ03      -1.4155739  0.0144113   -98.227  &lt; 2e-16 ***
DESTIN_SZDTSZ13      -2.2197108  0.0161427  -137.505  &lt; 2e-16 ***
DESTIN_SZGLSZ01       0.0360456  0.0051226     7.037 1.97e-12 ***
DESTIN_SZGLSZ02      -0.2944546  0.0046197   -63.739  &lt; 2e-16 ***
DESTIN_SZGLSZ03       0.3996641  0.0038387   104.115  &lt; 2e-16 ***
DESTIN_SZGLSZ04       0.3387134  0.0038028    89.071  &lt; 2e-16 ***
DESTIN_SZGLSZ05       0.1935512  0.0038854    49.816  &lt; 2e-16 ***
DESTIN_SZHGSZ01       0.2886226  0.0038829    74.332  &lt; 2e-16 ***
DESTIN_SZHGSZ02      -0.6115672  0.0051189  -119.473  &lt; 2e-16 ***
DESTIN_SZHGSZ03      -1.0528824  0.0061020  -172.547  &lt; 2e-16 ***
DESTIN_SZHGSZ04      -0.2363236  0.0043617   -54.182  &lt; 2e-16 ***
DESTIN_SZHGSZ05      -0.3003303  0.0044868   -66.936  &lt; 2e-16 ***
DESTIN_SZHGSZ06      -0.8190218  0.0054086  -151.430  &lt; 2e-16 ***
DESTIN_SZHGSZ07       0.1973306  0.0040340    48.916  &lt; 2e-16 ***
DESTIN_SZHGSZ08      -0.4434470  0.0048969   -90.556  &lt; 2e-16 ***
DESTIN_SZHGSZ09       0.0495733  0.0051346     9.655  &lt; 2e-16 ***
DESTIN_SZHGSZ10      -2.9142272  0.0262066  -111.202  &lt; 2e-16 ***
DESTIN_SZJESZ01      -0.1274822  0.0048238   -26.428  &lt; 2e-16 ***
DESTIN_SZJESZ02      -0.5332323  0.0051518  -103.505  &lt; 2e-16 ***
DESTIN_SZJESZ03      -0.6434751  0.0056630  -113.627  &lt; 2e-16 ***
DESTIN_SZJESZ04      -0.1952696  0.0065530   -29.798  &lt; 2e-16 ***
DESTIN_SZJESZ05      -1.0016142  0.0097677  -102.543  &lt; 2e-16 ***
DESTIN_SZJESZ06       0.4183634  0.0040647   102.925  &lt; 2e-16 ***
DESTIN_SZJESZ07      -1.1907296  0.0081559  -145.997  &lt; 2e-16 ***
DESTIN_SZJESZ08      -0.6819949  0.0078081   -87.345  &lt; 2e-16 ***
DESTIN_SZJESZ09      -0.3842693  0.0053974   -71.195  &lt; 2e-16 ***
DESTIN_SZJESZ10       0.6233846  0.0069391    89.836  &lt; 2e-16 ***
DESTIN_SZJESZ11       0.8588253  0.0065842   130.438  &lt; 2e-16 ***
DESTIN_SZJWSZ01      -0.5743273  0.0064564   -88.954  &lt; 2e-16 ***
DESTIN_SZJWSZ02      -0.3954232  0.0051665   -76.535  &lt; 2e-16 ***
DESTIN_SZJWSZ03       0.5694389  0.0039307   144.871  &lt; 2e-16 ***
DESTIN_SZJWSZ04       0.8606902  0.0037226   231.205  &lt; 2e-16 ***
DESTIN_SZJWSZ05      -0.2823924  0.0060826   -46.426  &lt; 2e-16 ***
DESTIN_SZJWSZ06       0.2352724  0.0054595    43.094  &lt; 2e-16 ***
DESTIN_SZJWSZ07      -1.5375403  0.0280040   -54.904  &lt; 2e-16 ***
DESTIN_SZJWSZ08       0.3147094  0.0044680    70.437  &lt; 2e-16 ***
DESTIN_SZJWSZ09       1.2720518  0.0034024   373.865  &lt; 2e-16 ***
DESTIN_SZKLSZ01      -0.6242607  0.0051546  -121.107  &lt; 2e-16 ***
DESTIN_SZKLSZ02      -0.7374046  0.0057144  -129.044  &lt; 2e-16 ***
DESTIN_SZKLSZ03      -1.3284719  0.0065173  -203.839  &lt; 2e-16 ***
DESTIN_SZKLSZ04      -1.7896899  0.0087381  -204.814  &lt; 2e-16 ***
DESTIN_SZKLSZ05      -0.9281552  0.0071071  -130.596  &lt; 2e-16 ***
DESTIN_SZKLSZ06      -2.4472009  0.0362066   -67.590  &lt; 2e-16 ***
DESTIN_SZKLSZ07      -1.1154762  0.0065760  -169.627  &lt; 2e-16 ***
DESTIN_SZKLSZ08      -0.5706917  0.0050918  -112.080  &lt; 2e-16 ***
DESTIN_SZLKSZ01      -1.6795064  0.0204169   -82.260  &lt; 2e-16 ***
DESTIN_SZMDSZ01      -1.5536339  0.0198358   -78.325  &lt; 2e-16 ***
DESTIN_SZMDSZ02      -1.2079509  0.0111348  -108.484  &lt; 2e-16 ***
DESTIN_SZMDSZ03      -2.9726073  0.0250846  -118.503  &lt; 2e-16 ***
DESTIN_SZMPSZ01      -1.1488342  0.0077130  -148.948  &lt; 2e-16 ***
DESTIN_SZMPSZ02      -0.8985650  0.0060322  -148.961  &lt; 2e-16 ***
DESTIN_SZMPSZ03      -0.1802688  0.0046394   -38.856  &lt; 2e-16 ***
DESTIN_SZMUSZ02      -2.2856058  0.0199642  -114.485  &lt; 2e-16 ***
DESTIN_SZNTSZ01      -3.5819854  0.0447754   -79.999  &lt; 2e-16 ***
DESTIN_SZNTSZ02      -1.8970904  0.0108739  -174.462  &lt; 2e-16 ***
DESTIN_SZNTSZ03      -1.1453158  0.0076148  -150.406  &lt; 2e-16 ***
DESTIN_SZNTSZ05      -1.8600812  0.0249543   -74.539  &lt; 2e-16 ***
DESTIN_SZNTSZ06      -3.0005362  0.0428602   -70.007  &lt; 2e-16 ***
DESTIN_SZNVSZ01      -0.3540976  0.0044294   -79.943  &lt; 2e-16 ***
DESTIN_SZNVSZ02      -0.6354596  0.0052782  -120.393  &lt; 2e-16 ***
DESTIN_SZNVSZ03      -0.6926039  0.0054248  -127.673  &lt; 2e-16 ***
DESTIN_SZNVSZ04      -2.2171459  0.0106997  -207.216  &lt; 2e-16 ***
DESTIN_SZNVSZ05      -1.8175824  0.0089062  -204.081  &lt; 2e-16 ***
DESTIN_SZPGSZ01      -1.6121145  0.0153049  -105.333  &lt; 2e-16 ***
DESTIN_SZPGSZ02      -0.9704812  0.0067275  -144.257  &lt; 2e-16 ***
DESTIN_SZPGSZ03       0.2711837  0.0040244    67.385  &lt; 2e-16 ***
DESTIN_SZPGSZ04      -0.2060179  0.0044926   -45.857  &lt; 2e-16 ***
DESTIN_SZPGSZ05      -0.9938937  0.0070849  -140.283  &lt; 2e-16 ***
DESTIN_SZPLSZ01      -0.3008324  0.0068281   -44.058  &lt; 2e-16 ***
DESTIN_SZPLSZ02      -1.4752107  0.0131164  -112.471  &lt; 2e-16 ***
DESTIN_SZPLSZ03      -0.1959443  0.0095866   -20.439  &lt; 2e-16 ***
DESTIN_SZPLSZ04      -0.2883047  0.0093371   -30.877  &lt; 2e-16 ***
DESTIN_SZPLSZ05      -0.8039780  0.0116854   -68.802  &lt; 2e-16 ***
DESTIN_SZPNSZ01       0.9421407  0.0050047   188.249  &lt; 2e-16 ***
DESTIN_SZPNSZ02       1.3639714  0.0064548   211.310  &lt; 2e-16 ***
DESTIN_SZPNSZ03       0.5711018  0.0077106    74.067  &lt; 2e-16 ***
DESTIN_SZPNSZ04       1.3960432  0.0075778   184.229  &lt; 2e-16 ***
DESTIN_SZPNSZ05       0.4474974  0.0115933    38.600  &lt; 2e-16 ***
DESTIN_SZPRSZ01      -1.1291886  0.0084669  -133.366  &lt; 2e-16 ***
DESTIN_SZPRSZ02      -0.3162629  0.0049878   -63.407  &lt; 2e-16 ***
DESTIN_SZPRSZ03       0.4878487  0.0038516   126.660  &lt; 2e-16 ***
DESTIN_SZPRSZ04      -0.7406307  0.0079063   -93.676  &lt; 2e-16 ***
DESTIN_SZPRSZ05      -0.0733002  0.0044984   -16.295  &lt; 2e-16 ***
DESTIN_SZPRSZ06       0.2616531  0.0052026    50.293  &lt; 2e-16 ***
DESTIN_SZPRSZ07      -1.4589011  0.0117302  -124.372  &lt; 2e-16 ***
DESTIN_SZPRSZ08      -0.8621991  0.0064876  -132.901  &lt; 2e-16 ***
DESTIN_SZQTSZ01      -1.1965821  0.0085396  -140.121  &lt; 2e-16 ***
DESTIN_SZQTSZ02      -1.4263894  0.0073430  -194.251  &lt; 2e-16 ***
DESTIN_SZQTSZ03      -0.7982677  0.0064063  -124.606  &lt; 2e-16 ***
DESTIN_SZQTSZ04      -0.9187054  0.0065358  -140.565  &lt; 2e-16 ***
DESTIN_SZQTSZ05      -0.8844581  0.0058478  -151.245  &lt; 2e-16 ***
DESTIN_SZQTSZ06      -1.1629136  0.0063565  -182.948  &lt; 2e-16 ***
DESTIN_SZQTSZ07      -1.4908922  0.0108734  -137.113  &lt; 2e-16 ***
DESTIN_SZQTSZ08      -0.0247369  0.0047985    -5.155 2.53e-07 ***
DESTIN_SZQTSZ09      -0.5510822  0.0057381   -96.039  &lt; 2e-16 ***
DESTIN_SZQTSZ10      -0.6181793  0.0054209  -114.037  &lt; 2e-16 ***
DESTIN_SZQTSZ11      -0.4072294  0.0054692   -74.458  &lt; 2e-16 ***
DESTIN_SZQTSZ12      -0.5688076  0.0070694   -80.460  &lt; 2e-16 ***
DESTIN_SZQTSZ13      -0.1613461  0.0051342   -31.426  &lt; 2e-16 ***
DESTIN_SZQTSZ14      -0.4899105  0.0062248   -78.703  &lt; 2e-16 ***
DESTIN_SZQTSZ15      -0.1580039  0.0073137   -21.604  &lt; 2e-16 ***
DESTIN_SZRCSZ01      -0.5530825  0.0071801   -77.030  &lt; 2e-16 ***
DESTIN_SZRCSZ06      -2.0318919  0.0188791  -107.627  &lt; 2e-16 ***
DESTIN_SZRVSZ01      -2.5041818  0.0162325  -154.269  &lt; 2e-16 ***
DESTIN_SZRVSZ02      -3.1631541  0.0326142   -96.987  &lt; 2e-16 ***
DESTIN_SZRVSZ03      -2.4702654  0.0135081  -182.872  &lt; 2e-16 ***
DESTIN_SZRVSZ04      -1.8004502  0.0154976  -116.176  &lt; 2e-16 ***
DESTIN_SZRVSZ05      -2.9498980  0.0256329  -115.083  &lt; 2e-16 ***
DESTIN_SZSBSZ01      -0.2407682  0.0060596   -39.733  &lt; 2e-16 ***
DESTIN_SZSBSZ02      -1.1716104  0.0076342  -153.469  &lt; 2e-16 ***
DESTIN_SZSBSZ03       0.5025478  0.0041456   121.224  &lt; 2e-16 ***
DESTIN_SZSBSZ04      -0.0336083  0.0051433    -6.534 6.39e-11 ***
DESTIN_SZSBSZ05      -1.0065693  0.0071975  -139.849  &lt; 2e-16 ***
DESTIN_SZSBSZ06      -2.3640414  0.0221608  -106.677  &lt; 2e-16 ***
DESTIN_SZSBSZ07      -1.0042413  0.0181727   -55.261  &lt; 2e-16 ***
DESTIN_SZSBSZ08       1.1356376  0.0051662   219.821  &lt; 2e-16 ***
DESTIN_SZSBSZ09       0.6729359  0.0048386   139.076  &lt; 2e-16 ***
DESTIN_SZSESZ02      -0.3864535  0.0046690   -82.770  &lt; 2e-16 ***
DESTIN_SZSESZ03       0.4365473  0.0036988   118.024  &lt; 2e-16 ***
DESTIN_SZSESZ04      -0.7772131  0.0054287  -143.166  &lt; 2e-16 ***
DESTIN_SZSESZ05      -0.4159594  0.0047537   -87.502  &lt; 2e-16 ***
DESTIN_SZSESZ06      -0.7197420  0.0057104  -126.040  &lt; 2e-16 ***
DESTIN_SZSESZ07      -3.0503330  0.0226808  -134.490  &lt; 2e-16 ***
DESTIN_SZSGSZ01      -0.5759283  0.0058294   -98.798  &lt; 2e-16 ***
DESTIN_SZSGSZ02      -0.1161709  0.0051649   -22.492  &lt; 2e-16 ***
DESTIN_SZSGSZ03      -0.4106263  0.0047157   -87.077  &lt; 2e-16 ***
DESTIN_SZSGSZ04      -0.3163870  0.0046868   -67.506  &lt; 2e-16 ***
DESTIN_SZSGSZ05      -2.2280281  0.0097909  -227.562  &lt; 2e-16 ***
DESTIN_SZSGSZ06       0.3187814  0.0037949    84.002  &lt; 2e-16 ***
DESTIN_SZSGSZ07      -0.5874335  0.0051371  -114.352  &lt; 2e-16 ***
DESTIN_SZSISZ01      -1.2917491  0.0257804   -50.106  &lt; 2e-16 ***
DESTIN_SZSKSZ01      -0.1088797  0.0066893   -16.277  &lt; 2e-16 ***
DESTIN_SZSKSZ02       0.9106755  0.0050278   181.128  &lt; 2e-16 ***
DESTIN_SZSKSZ03      -0.1543859  0.0059159   -26.097  &lt; 2e-16 ***
DESTIN_SZSKSZ04      -0.7057575  0.0139698   -50.520  &lt; 2e-16 ***
DESTIN_SZSKSZ05      -0.0121301  0.0104904    -1.156  0.24755    
DESTIN_SZSLSZ01      -0.6832113  0.0083380   -81.939  &lt; 2e-16 ***
DESTIN_SZSLSZ04      -0.8877801  0.0070348  -126.199  &lt; 2e-16 ***
DESTIN_SZSRSZ01      -2.1769985  0.0127231  -171.106  &lt; 2e-16 ***
DESTIN_SZTHSZ01      -2.9236668  0.0366843   -79.698  &lt; 2e-16 ***
DESTIN_SZTHSZ03      -2.2436488  0.0250852   -89.441  &lt; 2e-16 ***
DESTIN_SZTHSZ04      -2.1614123  0.0213692  -101.146  &lt; 2e-16 ***
DESTIN_SZTHSZ06      -1.5413261  0.0150039  -102.728  &lt; 2e-16 ***
DESTIN_SZTMSZ01      -0.0352953  0.0055152    -6.400 1.56e-10 ***
DESTIN_SZTMSZ02       1.5046218  0.0032643   460.933  &lt; 2e-16 ***
DESTIN_SZTMSZ03       0.6299992  0.0037167   169.506  &lt; 2e-16 ***
DESTIN_SZTMSZ04       0.8101842  0.0037611   215.414  &lt; 2e-16 ***
DESTIN_SZTMSZ05       0.4133985  0.0051282    80.613  &lt; 2e-16 ***
DESTIN_SZTNSZ01      -1.2547855  0.0066985  -187.324  &lt; 2e-16 ***
DESTIN_SZTNSZ02      -1.9449320  0.0096551  -201.441  &lt; 2e-16 ***
DESTIN_SZTNSZ03      -2.0073616  0.0115726  -173.458  &lt; 2e-16 ***
DESTIN_SZTNSZ04      -1.2287484  0.0068502  -179.374  &lt; 2e-16 ***
DESTIN_SZTPSZ01      -0.6386471  0.0055775  -114.505  &lt; 2e-16 ***
DESTIN_SZTPSZ02       0.1716304  0.0037260    46.062  &lt; 2e-16 ***
DESTIN_SZTPSZ03      -0.4174415  0.0054889   -76.052  &lt; 2e-16 ***
DESTIN_SZTPSZ04      -1.4950882  0.0071592  -208.835  &lt; 2e-16 ***
DESTIN_SZTPSZ05      -0.8842788  0.0056754  -155.809  &lt; 2e-16 ***
DESTIN_SZTPSZ06      -0.1789661  0.0062669   -28.558  &lt; 2e-16 ***
DESTIN_SZTPSZ07      -1.9286389  0.0116567  -165.454  &lt; 2e-16 ***
DESTIN_SZTPSZ08      -1.4130347  0.0085538  -165.195  &lt; 2e-16 ***
DESTIN_SZTPSZ09      -0.4981579  0.0059404   -83.860  &lt; 2e-16 ***
DESTIN_SZTPSZ10      -1.1404224  0.0084489  -134.980  &lt; 2e-16 ***
DESTIN_SZTPSZ11      -0.3973636  0.0050912   -78.049  &lt; 2e-16 ***
DESTIN_SZTPSZ12      -0.8099589  0.0061327  -132.072  &lt; 2e-16 ***
DESTIN_SZTSSZ01      -0.8455348  0.0208533   -40.547  &lt; 2e-16 ***
DESTIN_SZTSSZ02       0.5462129  0.0093784    58.242  &lt; 2e-16 ***
DESTIN_SZTSSZ03       1.4128184  0.0064443   219.237  &lt; 2e-16 ***
DESTIN_SZTSSZ04       1.2433626  0.0067892   183.138  &lt; 2e-16 ***
DESTIN_SZTSSZ05       1.3979287  0.0073701   189.675  &lt; 2e-16 ***
DESTIN_SZTSSZ06       0.1654437  0.0137913    11.996  &lt; 2e-16 ***
DESTIN_SZWCSZ01       1.3237346  0.0045380   291.698  &lt; 2e-16 ***
DESTIN_SZWCSZ02      -0.7071355  0.0122995   -57.493  &lt; 2e-16 ***
DESTIN_SZWCSZ03      -2.2322890  0.0325130   -68.658  &lt; 2e-16 ***
DESTIN_SZWDSZ01       1.3833409  0.0034823   397.248  &lt; 2e-16 ***
DESTIN_SZWDSZ02      -0.4933824  0.0055232   -89.330  &lt; 2e-16 ***
DESTIN_SZWDSZ03       1.0032194  0.0036331   276.136  &lt; 2e-16 ***
DESTIN_SZWDSZ04      -0.4482317  0.0058446   -76.692  &lt; 2e-16 ***
DESTIN_SZWDSZ05      -0.1842471  0.0053992   -34.125  &lt; 2e-16 ***
DESTIN_SZWDSZ06       0.4160272  0.0040354   103.093  &lt; 2e-16 ***
DESTIN_SZWDSZ07       0.4464085  0.0061783    72.255  &lt; 2e-16 ***
DESTIN_SZWDSZ08       0.4097875  0.0060966    67.216  &lt; 2e-16 ***
DESTIN_SZWDSZ09       0.5609089  0.0044866   125.018  &lt; 2e-16 ***
DESTIN_SZYSSZ01       1.0631470  0.0038249   277.952  &lt; 2e-16 ***
DESTIN_SZYSSZ02       0.1815975  0.0048221    37.660  &lt; 2e-16 ***
DESTIN_SZYSSZ03      -0.1701590  0.0051388   -33.113  &lt; 2e-16 ***
DESTIN_SZYSSZ04      -0.0488067  0.0048687   -10.025  &lt; 2e-16 ***
DESTIN_SZYSSZ05      -1.6356303  0.0100323  -163.037  &lt; 2e-16 ***
DESTIN_SZYSSZ06      -1.8593634  0.0098619  -188.541  &lt; 2e-16 ***
DESTIN_SZYSSZ07      -1.0655380  0.0111530   -95.538  &lt; 2e-16 ***
DESTIN_SZYSSZ08       0.5479624  0.0039557   138.525  &lt; 2e-16 ***
DESTIN_SZYSSZ09       0.3662081  0.0038906    94.127  &lt; 2e-16 ***
log(ORIGIN_AGE7_12)   0.1312205  0.0007252   180.949  &lt; 2e-16 ***
log(ORIGIN_AGE13_24)  0.6245430  0.0009598   650.677  &lt; 2e-16 ***
log(ORIGIN_AGE25_64) -0.4273627  0.0009266  -461.217  &lt; 2e-16 ***
log(dist)            -0.6917367  0.0001295 -5343.066  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 60796037  on 14733  degrees of freedom
Residual deviance: 25692617  on 14450  degrees of freedom
AIC: 25784812

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>The R-squared value of the destination-constrained SIM is 0.513.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(decSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, decSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5133868</code></pre>
</div>
</div>
</section>
<section id="doubly-constrained-sim" class="level2">
<h2 class="anchored" data-anchor-id="doubly-constrained-sim">3.7 Doubly-constrained SIM</h2>
<p>We calibrate a doubly-constrained SIM as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>dbcSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                ORIGIN_SZ <span class="sc">+</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                DESTIN_SZ <span class="sc">+</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dbcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + DESTIN_SZ + log(dist), family = poisson(link = "log"), 
    data = SIM_data, na.action = na.exclude)

Coefficients:
                  Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)     12.4165310  0.0043949  2825.242  &lt; 2e-16 ***
ORIGIN_SZAMSZ02  0.9496891  0.0045740   207.630  &lt; 2e-16 ***
ORIGIN_SZAMSZ03  0.5519174  0.0046672   118.253  &lt; 2e-16 ***
ORIGIN_SZAMSZ04  0.1028140  0.0052468    19.596  &lt; 2e-16 ***
ORIGIN_SZAMSZ05  0.0822549  0.0058663    14.022  &lt; 2e-16 ***
ORIGIN_SZAMSZ06  0.6617809  0.0052580   125.861  &lt; 2e-16 ***
ORIGIN_SZAMSZ07 -0.9508298  0.0097681   -97.340  &lt; 2e-16 ***
ORIGIN_SZAMSZ08 -0.7271779  0.0090946   -79.958  &lt; 2e-16 ***
ORIGIN_SZAMSZ09  0.4896781  0.0055203    88.704  &lt; 2e-16 ***
ORIGIN_SZAMSZ10  0.4819428  0.0048175   100.040  &lt; 2e-16 ***
ORIGIN_SZAMSZ11 -1.7719841  0.0130695  -135.582  &lt; 2e-16 ***
ORIGIN_SZAMSZ12 -1.7679107  0.0108777  -162.526  &lt; 2e-16 ***
ORIGIN_SZBDSZ01  0.8314812  0.0045187   184.010  &lt; 2e-16 ***
ORIGIN_SZBDSZ02  0.4305836  0.0052535    81.961  &lt; 2e-16 ***
ORIGIN_SZBDSZ03  0.8009370  0.0046384   172.676  &lt; 2e-16 ***
ORIGIN_SZBDSZ04  1.4562985  0.0040456   359.971  &lt; 2e-16 ***
ORIGIN_SZBDSZ05  0.4501939  0.0046960    95.867  &lt; 2e-16 ***
ORIGIN_SZBDSZ06  0.7745026  0.0047424   163.314  &lt; 2e-16 ***
ORIGIN_SZBDSZ07 -1.1784123  0.0098105  -120.117  &lt; 2e-16 ***
ORIGIN_SZBDSZ08 -0.9830996  0.0091135  -107.873  &lt; 2e-16 ***
ORIGIN_SZBKSZ01 -0.3042966  0.0067086   -45.359  &lt; 2e-16 ***
ORIGIN_SZBKSZ02  0.4801541  0.0054160    88.655  &lt; 2e-16 ***
ORIGIN_SZBKSZ03  0.7823931  0.0052007   150.440  &lt; 2e-16 ***
ORIGIN_SZBKSZ04 -0.1292545  0.0061735   -20.937  &lt; 2e-16 ***
ORIGIN_SZBKSZ05 -0.0258584  0.0060192    -4.296 1.74e-05 ***
ORIGIN_SZBKSZ06  0.1994719  0.0061206    32.590  &lt; 2e-16 ***
ORIGIN_SZBKSZ07  0.7434860  0.0046598   159.553  &lt; 2e-16 ***
ORIGIN_SZBKSZ08  0.1625007  0.0055219    29.428  &lt; 2e-16 ***
ORIGIN_SZBKSZ09 -0.0864293  0.0059533   -14.518  &lt; 2e-16 ***
ORIGIN_SZBLSZ01 -2.1022485  0.0150316  -139.855  &lt; 2e-16 ***
ORIGIN_SZBLSZ02 -2.9460181  0.0195760  -150.491  &lt; 2e-16 ***
ORIGIN_SZBLSZ03 -4.9412872  0.0398540  -123.985  &lt; 2e-16 ***
ORIGIN_SZBLSZ04 -2.8143593  0.0239209  -117.653  &lt; 2e-16 ***
ORIGIN_SZBMSZ01 -0.0264561  0.0053639    -4.932 8.13e-07 ***
ORIGIN_SZBMSZ02 -0.8656513  0.0068511  -126.353  &lt; 2e-16 ***
ORIGIN_SZBMSZ03 -0.1723467  0.0059613   -28.911  &lt; 2e-16 ***
ORIGIN_SZBMSZ04  0.2169844  0.0053578    40.499  &lt; 2e-16 ***
ORIGIN_SZBMSZ05 -2.0252956  0.0126107  -160.602  &lt; 2e-16 ***
ORIGIN_SZBMSZ06 -1.7642018  0.0163931  -107.619  &lt; 2e-16 ***
ORIGIN_SZBMSZ07 -0.3271629  0.0058137   -56.274  &lt; 2e-16 ***
ORIGIN_SZBMSZ08 -0.2533255  0.0059335   -42.694  &lt; 2e-16 ***
ORIGIN_SZBMSZ09 -0.7712635  0.0087939   -87.704  &lt; 2e-16 ***
ORIGIN_SZBMSZ10 -1.0098048  0.0092519  -109.145  &lt; 2e-16 ***
ORIGIN_SZBMSZ11 -0.3816187  0.0067302   -56.702  &lt; 2e-16 ***
ORIGIN_SZBMSZ12 -0.6666616  0.0095680   -69.676  &lt; 2e-16 ***
ORIGIN_SZBMSZ13 -0.0076108  0.0059040    -1.289  0.19737    
ORIGIN_SZBMSZ14 -0.1682476  0.0069391   -24.246  &lt; 2e-16 ***
ORIGIN_SZBMSZ15  0.0904585  0.0062822    14.399  &lt; 2e-16 ***
ORIGIN_SZBMSZ16 -1.1808741  0.0092258  -127.997  &lt; 2e-16 ***
ORIGIN_SZBMSZ17 -1.7189127  0.0158408  -108.512  &lt; 2e-16 ***
ORIGIN_SZBPSZ01  0.4294645  0.0058051    73.980  &lt; 2e-16 ***
ORIGIN_SZBPSZ02  0.5028906  0.0068169    73.771  &lt; 2e-16 ***
ORIGIN_SZBPSZ03  0.6656178  0.0066126   100.658  &lt; 2e-16 ***
ORIGIN_SZBPSZ04  0.5203612  0.0053224    97.769  &lt; 2e-16 ***
ORIGIN_SZBPSZ05  0.5377769  0.0047907   112.256  &lt; 2e-16 ***
ORIGIN_SZBPSZ06 -1.2327809  0.0094950  -129.835  &lt; 2e-16 ***
ORIGIN_SZBPSZ07 -0.9035255  0.0088739  -101.818  &lt; 2e-16 ***
ORIGIN_SZBSSZ01  0.1210027  0.0053990    22.412  &lt; 2e-16 ***
ORIGIN_SZBSSZ02  0.4618449  0.0048641    94.951  &lt; 2e-16 ***
ORIGIN_SZBSSZ03  0.2160739  0.0047835    45.170  &lt; 2e-16 ***
ORIGIN_SZBTSZ01 -0.1108042  0.0055599   -19.929  &lt; 2e-16 ***
ORIGIN_SZBTSZ02 -0.8911221  0.0079213  -112.498  &lt; 2e-16 ***
ORIGIN_SZBTSZ03 -0.2203980  0.0059325   -37.151  &lt; 2e-16 ***
ORIGIN_SZBTSZ04 -0.6427946  0.0105438   -60.964  &lt; 2e-16 ***
ORIGIN_SZBTSZ05 -1.4662312  0.0111784  -131.166  &lt; 2e-16 ***
ORIGIN_SZBTSZ06 -0.6105884  0.0073456   -83.123  &lt; 2e-16 ***
ORIGIN_SZBTSZ07 -1.9041317  0.0132781  -143.404  &lt; 2e-16 ***
ORIGIN_SZBTSZ08 -1.0627939  0.0095982  -110.728  &lt; 2e-16 ***
ORIGIN_SZCBSZ01 -2.9365941  0.0548632   -53.526  &lt; 2e-16 ***
ORIGIN_SZCCSZ01 -1.5313555  0.0134599  -113.772  &lt; 2e-16 ***
ORIGIN_SZCHSZ01 -1.2034494  0.0119468  -100.734  &lt; 2e-16 ***
ORIGIN_SZCHSZ02 -0.8299415  0.0081984  -101.232  &lt; 2e-16 ***
ORIGIN_SZCHSZ03 -0.5143946  0.0061944   -83.042  &lt; 2e-16 ***
ORIGIN_SZCKSZ01  0.2372583  0.0053612    44.255  &lt; 2e-16 ***
ORIGIN_SZCKSZ02  0.9124836  0.0054472   167.515  &lt; 2e-16 ***
ORIGIN_SZCKSZ03  0.7237808  0.0048401   149.539  &lt; 2e-16 ***
ORIGIN_SZCKSZ04  1.6884022  0.0050169   336.540  &lt; 2e-16 ***
ORIGIN_SZCKSZ05  1.3932005  0.0062346   223.464  &lt; 2e-16 ***
ORIGIN_SZCKSZ06  1.0670053  0.0066112   161.394  &lt; 2e-16 ***
ORIGIN_SZCLSZ01 -0.8602837  0.0079240  -108.567  &lt; 2e-16 ***
ORIGIN_SZCLSZ02 -1.3853421  0.0137444  -100.793  &lt; 2e-16 ***
ORIGIN_SZCLSZ03 -0.8582608  0.0081177  -105.727  &lt; 2e-16 ***
ORIGIN_SZCLSZ04  0.7836027  0.0046427   168.782  &lt; 2e-16 ***
ORIGIN_SZCLSZ05 -1.8121756  0.0148960  -121.655  &lt; 2e-16 ***
ORIGIN_SZCLSZ06  0.8296870  0.0043909   188.955  &lt; 2e-16 ***
ORIGIN_SZCLSZ07 -0.2325219  0.0057432   -40.487  &lt; 2e-16 ***
ORIGIN_SZCLSZ08  0.2714336  0.0062625    43.342  &lt; 2e-16 ***
ORIGIN_SZCLSZ09 -2.2223744  0.0160946  -138.082  &lt; 2e-16 ***
ORIGIN_SZDTSZ02 -4.0704970  0.0834192   -48.796  &lt; 2e-16 ***
ORIGIN_SZDTSZ03 -3.4529031  0.0738295   -46.769  &lt; 2e-16 ***
ORIGIN_SZDTSZ13 -2.8301983  0.0313085   -90.397  &lt; 2e-16 ***
ORIGIN_SZGLSZ01 -1.4674986  0.0093137  -157.563  &lt; 2e-16 ***
ORIGIN_SZGLSZ02  0.2749369  0.0050051    54.931  &lt; 2e-16 ***
ORIGIN_SZGLSZ03  0.0781954  0.0049748    15.718  &lt; 2e-16 ***
ORIGIN_SZGLSZ04  0.8167797  0.0043260   188.808  &lt; 2e-16 ***
ORIGIN_SZGLSZ05  0.5277509  0.0044879   117.595  &lt; 2e-16 ***
ORIGIN_SZHGSZ01  0.2323885  0.0048555    47.861  &lt; 2e-16 ***
ORIGIN_SZHGSZ02  0.5707182  0.0048256   118.268  &lt; 2e-16 ***
ORIGIN_SZHGSZ03  0.4231170  0.0052149    81.136  &lt; 2e-16 ***
ORIGIN_SZHGSZ04  0.9341168  0.0044128   211.681  &lt; 2e-16 ***
ORIGIN_SZHGSZ05  1.2192790  0.0043790   278.437  &lt; 2e-16 ***
ORIGIN_SZHGSZ06  0.0490041  0.0054961     8.916  &lt; 2e-16 ***
ORIGIN_SZHGSZ07  0.6337041  0.0045735   138.559  &lt; 2e-16 ***
ORIGIN_SZHGSZ08  0.0312612  0.0054684     5.717 1.09e-08 ***
ORIGIN_SZHGSZ09 -0.6985397  0.0071800   -97.289  &lt; 2e-16 ***
ORIGIN_SZHGSZ10 -2.9958967  0.0422303   -70.942  &lt; 2e-16 ***
ORIGIN_SZJESZ01  0.4363431  0.0051329    85.010  &lt; 2e-16 ***
ORIGIN_SZJESZ02  0.3460900  0.0051372    67.370  &lt; 2e-16 ***
ORIGIN_SZJESZ03  0.2928005  0.0055108    53.132  &lt; 2e-16 ***
ORIGIN_SZJESZ04 -1.1924298  0.0093540  -127.478  &lt; 2e-16 ***
ORIGIN_SZJESZ05 -2.0178136  0.0139479  -144.668  &lt; 2e-16 ***
ORIGIN_SZJESZ06  0.1637633  0.0050685    32.310  &lt; 2e-16 ***
ORIGIN_SZJESZ07 -1.8227460  0.0119383  -152.680  &lt; 2e-16 ***
ORIGIN_SZJESZ08 -1.1556281  0.0117870   -98.043  &lt; 2e-16 ***
ORIGIN_SZJESZ09  0.4766229  0.0052813    90.248  &lt; 2e-16 ***
ORIGIN_SZJESZ10 -2.6868992  0.0186864  -143.789  &lt; 2e-16 ***
ORIGIN_SZJESZ11 -3.0618150  0.0199755  -153.278  &lt; 2e-16 ***
ORIGIN_SZJWSZ01  0.4417418  0.0068611    64.383  &lt; 2e-16 ***
ORIGIN_SZJWSZ02  0.9738087  0.0047905   203.281  &lt; 2e-16 ***
ORIGIN_SZJWSZ03  1.1548028  0.0045180   255.599  &lt; 2e-16 ***
ORIGIN_SZJWSZ04  0.9078417  0.0046668   194.532  &lt; 2e-16 ***
ORIGIN_SZJWSZ05 -1.7092500  0.0127422  -134.141  &lt; 2e-16 ***
ORIGIN_SZJWSZ06 -1.3284287  0.0109785  -121.002  &lt; 2e-16 ***
ORIGIN_SZJWSZ07 -2.3231549  0.0281427   -82.549  &lt; 2e-16 ***
ORIGIN_SZJWSZ08  1.9386127  0.0046041   421.059  &lt; 2e-16 ***
ORIGIN_SZJWSZ09  1.3987549  0.0042610   328.266  &lt; 2e-16 ***
ORIGIN_SZKLSZ01  0.2617735  0.0050089    52.261  &lt; 2e-16 ***
ORIGIN_SZKLSZ02 -0.4325093  0.0064279   -67.286  &lt; 2e-16 ***
ORIGIN_SZKLSZ03 -0.2787173  0.0060380   -46.161  &lt; 2e-16 ***
ORIGIN_SZKLSZ04 -1.9432693  0.0119163  -163.076  &lt; 2e-16 ***
ORIGIN_SZKLSZ05 -0.5420067  0.0085529   -63.371  &lt; 2e-16 ***
ORIGIN_SZKLSZ06 -4.2949009  0.1857686   -23.120  &lt; 2e-16 ***
ORIGIN_SZKLSZ07 -0.8576946  0.0085178  -100.694  &lt; 2e-16 ***
ORIGIN_SZKLSZ08 -1.3840925  0.0092323  -149.918  &lt; 2e-16 ***
ORIGIN_SZLKSZ01 -2.8108510  0.0392356   -71.640  &lt; 2e-16 ***
ORIGIN_SZMDSZ01 -1.6745388  0.0296543   -56.469  &lt; 2e-16 ***
ORIGIN_SZMDSZ02 -0.8193738  0.0106631   -76.842  &lt; 2e-16 ***
ORIGIN_SZMDSZ03 -1.5088267  0.0172032   -87.706  &lt; 2e-16 ***
ORIGIN_SZMPSZ01 -0.9860154  0.0085053  -115.929  &lt; 2e-16 ***
ORIGIN_SZMPSZ02 -0.5958875  0.0070097   -85.008  &lt; 2e-16 ***
ORIGIN_SZMPSZ03 -0.0490122  0.0054582    -8.980  &lt; 2e-16 ***
ORIGIN_SZMUSZ02 -3.5233367  0.1037749   -33.952  &lt; 2e-16 ***
ORIGIN_SZNTSZ01 -2.6451541  0.0353125   -74.907  &lt; 2e-16 ***
ORIGIN_SZNTSZ02 -2.7710546  0.0232841  -119.011  &lt; 2e-16 ***
ORIGIN_SZNTSZ03 -0.6123404  0.0079083   -77.430  &lt; 2e-16 ***
ORIGIN_SZNTSZ05 -2.9257445  0.0496704   -58.903  &lt; 2e-16 ***
ORIGIN_SZNTSZ06 -3.3260031  0.0557966   -59.609  &lt; 2e-16 ***
ORIGIN_SZNVSZ01  0.6421306  0.0046037   139.482  &lt; 2e-16 ***
ORIGIN_SZNVSZ02 -0.4251550  0.0065890   -64.525  &lt; 2e-16 ***
ORIGIN_SZNVSZ03 -1.0765622  0.0078766  -136.679  &lt; 2e-16 ***
ORIGIN_SZNVSZ04 -1.2289504  0.0091468  -134.358  &lt; 2e-16 ***
ORIGIN_SZNVSZ05 -2.3551389  0.0158219  -148.853  &lt; 2e-16 ***
ORIGIN_SZPGSZ01  0.1518212  0.0154825     9.806  &lt; 2e-16 ***
ORIGIN_SZPGSZ02 -0.4062609  0.0073780   -55.064  &lt; 2e-16 ***
ORIGIN_SZPGSZ03  0.8976913  0.0046122   194.636  &lt; 2e-16 ***
ORIGIN_SZPGSZ04  1.1161685  0.0045850   243.437  &lt; 2e-16 ***
ORIGIN_SZPGSZ05  0.4794249  0.0060213    79.621  &lt; 2e-16 ***
ORIGIN_SZPLSZ01 -0.8322377  0.0107898   -77.132  &lt; 2e-16 ***
ORIGIN_SZPLSZ02 -1.2968937  0.0149841   -86.551  &lt; 2e-16 ***
ORIGIN_SZPLSZ03 -3.2744991  0.0374541   -87.427  &lt; 2e-16 ***
ORIGIN_SZPLSZ04 -3.5423615  0.0372570   -95.079  &lt; 2e-16 ***
ORIGIN_SZPLSZ05 -2.4343705  0.0227807  -106.861  &lt; 2e-16 ***
ORIGIN_SZPNSZ01  0.8052461  0.0056124   143.476  &lt; 2e-16 ***
ORIGIN_SZPNSZ02 -1.8042362  0.0128222  -140.712  &lt; 2e-16 ***
ORIGIN_SZPNSZ03 -2.6363996  0.0200058  -131.782  &lt; 2e-16 ***
ORIGIN_SZPNSZ04 -4.8427070  0.0320126  -151.275  &lt; 2e-16 ***
ORIGIN_SZPNSZ05 -3.6613775  0.0285686  -128.161  &lt; 2e-16 ***
ORIGIN_SZPRSZ01 -0.5645384  0.0117126   -48.199  &lt; 2e-16 ***
ORIGIN_SZPRSZ02  0.9145886  0.0048137   189.998  &lt; 2e-16 ***
ORIGIN_SZPRSZ03  0.4478971  0.0048102    93.113  &lt; 2e-16 ***
ORIGIN_SZPRSZ04 -0.5312444  0.0079019   -67.230  &lt; 2e-16 ***
ORIGIN_SZPRSZ05  1.1462662  0.0045250   253.318  &lt; 2e-16 ***
ORIGIN_SZPRSZ06 -0.7392744  0.0090347   -81.826  &lt; 2e-16 ***
ORIGIN_SZPRSZ07 -2.1667862  0.0162528  -133.318  &lt; 2e-16 ***
ORIGIN_SZPRSZ08 -0.1327079  0.0065712   -20.195  &lt; 2e-16 ***
ORIGIN_SZQTSZ01  0.1062151  0.0071538    14.847  &lt; 2e-16 ***
ORIGIN_SZQTSZ02 -0.4993990  0.0064382   -77.568  &lt; 2e-16 ***
ORIGIN_SZQTSZ03  0.1161844  0.0058822    19.752  &lt; 2e-16 ***
ORIGIN_SZQTSZ04 -0.8102612  0.0072742  -111.389  &lt; 2e-16 ***
ORIGIN_SZQTSZ05 -0.0417272  0.0061917    -6.739 1.59e-11 ***
ORIGIN_SZQTSZ06 -0.2521417  0.0066449   -37.945  &lt; 2e-16 ***
ORIGIN_SZQTSZ07 -1.2395975  0.0097496  -127.143  &lt; 2e-16 ***
ORIGIN_SZQTSZ08 -0.1105467  0.0059364   -18.622  &lt; 2e-16 ***
ORIGIN_SZQTSZ09 -0.5078461  0.0067895   -74.798  &lt; 2e-16 ***
ORIGIN_SZQTSZ10 -0.3866593  0.0066995   -57.714  &lt; 2e-16 ***
ORIGIN_SZQTSZ11 -1.5264609  0.0099770  -152.998  &lt; 2e-16 ***
ORIGIN_SZQTSZ12 -1.3866518  0.0106887  -129.730  &lt; 2e-16 ***
ORIGIN_SZQTSZ13 -0.3764286  0.0066707   -56.430  &lt; 2e-16 ***
ORIGIN_SZQTSZ14 -1.4907399  0.0100120  -148.896  &lt; 2e-16 ***
ORIGIN_SZQTSZ15 -1.0552239  0.0108792   -96.994  &lt; 2e-16 ***
ORIGIN_SZRCSZ01 -1.3136074  0.0126986  -103.445  &lt; 2e-16 ***
ORIGIN_SZRCSZ06 -0.2418276  0.0085509   -28.281  &lt; 2e-16 ***
ORIGIN_SZRVSZ01 -2.9263747  0.0324968   -90.051  &lt; 2e-16 ***
ORIGIN_SZRVSZ02 -2.2980940  0.0278202   -82.605  &lt; 2e-16 ***
ORIGIN_SZRVSZ03 -2.4663765  0.0238674  -103.336  &lt; 2e-16 ***
ORIGIN_SZRVSZ04 -3.1853677  0.0556939   -57.194  &lt; 2e-16 ***
ORIGIN_SZRVSZ05 -1.5695490  0.0166684   -94.163  &lt; 2e-16 ***
ORIGIN_SZSBSZ01  0.7674590  0.0061811   124.163  &lt; 2e-16 ***
ORIGIN_SZSBSZ02 -0.7307279  0.0084105   -86.883  &lt; 2e-16 ***
ORIGIN_SZSBSZ03  0.5920074  0.0050167   118.008  &lt; 2e-16 ***
ORIGIN_SZSBSZ04  0.3684857  0.0058575    62.908  &lt; 2e-16 ***
ORIGIN_SZSBSZ05 -0.0036863  0.0068459    -0.538  0.59026    
ORIGIN_SZSBSZ06 -1.1939284  0.0181541   -65.766  &lt; 2e-16 ***
ORIGIN_SZSBSZ07 -0.4896579  0.0135618   -36.106  &lt; 2e-16 ***
ORIGIN_SZSBSZ08 -2.1221691  0.0127258  -166.762  &lt; 2e-16 ***
ORIGIN_SZSBSZ09 -1.2032410  0.0089611  -134.273  &lt; 2e-16 ***
ORIGIN_SZSESZ02  1.0721820  0.0045336   236.498  &lt; 2e-16 ***
ORIGIN_SZSESZ03  1.0808012  0.0042923   251.801  &lt; 2e-16 ***
ORIGIN_SZSESZ04  1.0137448  0.0050668   200.076  &lt; 2e-16 ***
ORIGIN_SZSESZ05 -0.1678679  0.0060206   -27.882  &lt; 2e-16 ***
ORIGIN_SZSESZ06  0.9165834  0.0048323   189.677  &lt; 2e-16 ***
ORIGIN_SZSESZ07 -2.2499789  0.0196327  -114.603  &lt; 2e-16 ***
ORIGIN_SZSGSZ01 -0.9369800  0.0087282  -107.351  &lt; 2e-16 ***
ORIGIN_SZSGSZ02 -1.1690716  0.0097131  -120.360  &lt; 2e-16 ***
ORIGIN_SZSGSZ03  0.2604352  0.0052709    49.410  &lt; 2e-16 ***
ORIGIN_SZSGSZ04  0.3468823  0.0048897    70.942  &lt; 2e-16 ***
ORIGIN_SZSGSZ05 -1.5927797  0.0106308  -149.827  &lt; 2e-16 ***
ORIGIN_SZSGSZ06  0.3605651  0.0046361    77.774  &lt; 2e-16 ***
ORIGIN_SZSGSZ07 -0.5333873  0.0063119   -84.504  &lt; 2e-16 ***
ORIGIN_SZSKSZ01 -0.2706750  0.0082836   -32.676  &lt; 2e-16 ***
ORIGIN_SZSKSZ02  0.0970953  0.0063378    15.320  &lt; 2e-16 ***
ORIGIN_SZSKSZ03 -0.6954342  0.0082538   -84.256  &lt; 2e-16 ***
ORIGIN_SZSKSZ04 -2.3863580  0.0284607   -83.847  &lt; 2e-16 ***
ORIGIN_SZSKSZ05 -1.5443140  0.0179059   -86.246  &lt; 2e-16 ***
ORIGIN_SZSLSZ01 -2.9450656  0.0307283   -95.842  &lt; 2e-16 ***
ORIGIN_SZSLSZ04 -0.5739349  0.0077851   -73.722  &lt; 2e-16 ***
ORIGIN_SZSRSZ01 -1.6136735  0.0160199  -100.729  &lt; 2e-16 ***
ORIGIN_SZTHSZ01 -2.6034976  0.0489378   -53.200  &lt; 2e-16 ***
ORIGIN_SZTHSZ03 -1.2770601  0.0229815   -55.569  &lt; 2e-16 ***
ORIGIN_SZTHSZ04 -2.0110399  0.0287527   -69.943  &lt; 2e-16 ***
ORIGIN_SZTHSZ06 -1.7720116  0.0180394   -98.230  &lt; 2e-16 ***
ORIGIN_SZTMSZ01  0.1254729  0.0060924    20.595  &lt; 2e-16 ***
ORIGIN_SZTMSZ02  1.6667504  0.0039836   418.403  &lt; 2e-16 ***
ORIGIN_SZTMSZ03  1.0941176  0.0042911   254.976  &lt; 2e-16 ***
ORIGIN_SZTMSZ04  0.3209520  0.0050349    63.746  &lt; 2e-16 ***
ORIGIN_SZTMSZ05 -0.8155124  0.0079342  -102.785  &lt; 2e-16 ***
ORIGIN_SZTNSZ01 -1.4237298  0.0104636  -136.064  &lt; 2e-16 ***
ORIGIN_SZTNSZ02 -1.2718890  0.0098660  -128.916  &lt; 2e-16 ***
ORIGIN_SZTNSZ03 -1.7960517  0.0134675  -133.362  &lt; 2e-16 ***
ORIGIN_SZTNSZ04 -0.3508142  0.0073556   -47.694  &lt; 2e-16 ***
ORIGIN_SZTPSZ01 -0.3841699  0.0064137   -59.898  &lt; 2e-16 ***
ORIGIN_SZTPSZ02  0.5315265  0.0044497   119.451  &lt; 2e-16 ***
ORIGIN_SZTPSZ03 -0.4669723  0.0062160   -75.124  &lt; 2e-16 ***
ORIGIN_SZTPSZ04 -0.0617169  0.0058830   -10.491  &lt; 2e-16 ***
ORIGIN_SZTPSZ05  0.0713309  0.0062133    11.480  &lt; 2e-16 ***
ORIGIN_SZTPSZ06  0.6800356  0.0069456    97.909  &lt; 2e-16 ***
ORIGIN_SZTPSZ07 -0.0432782  0.0064382    -6.722 1.79e-11 ***
ORIGIN_SZTPSZ08 -0.6976429  0.0092416   -75.490  &lt; 2e-16 ***
ORIGIN_SZTPSZ09 -0.3708833  0.0063548   -58.363  &lt; 2e-16 ***
ORIGIN_SZTPSZ10 -0.4063575  0.0077803   -52.229  &lt; 2e-16 ***
ORIGIN_SZTPSZ11  0.1040282  0.0056115    18.538  &lt; 2e-16 ***
ORIGIN_SZTPSZ12 -0.5104672  0.0066261   -77.039  &lt; 2e-16 ***
ORIGIN_SZTSSZ01 -3.5036830  0.0487290   -71.901  &lt; 2e-16 ***
ORIGIN_SZTSSZ02 -0.0386819  0.0094886    -4.077 4.57e-05 ***
ORIGIN_SZTSSZ03 -0.3862387  0.0095139   -40.597  &lt; 2e-16 ***
ORIGIN_SZTSSZ04 -0.6380676  0.0099905   -63.867  &lt; 2e-16 ***
ORIGIN_SZTSSZ05 -2.7354613  0.0162414  -168.425  &lt; 2e-16 ***
ORIGIN_SZTSSZ06 -2.6310865  0.0255772  -102.868  &lt; 2e-16 ***
ORIGIN_SZWCSZ01 -1.1561047  0.0087394  -132.286  &lt; 2e-16 ***
ORIGIN_SZWCSZ02 -2.6956217  0.0319117   -84.471  &lt; 2e-16 ***
ORIGIN_SZWCSZ03 -4.3526889  0.1241082   -35.072  &lt; 2e-16 ***
ORIGIN_SZWDSZ01  0.8712417  0.0043720   199.277  &lt; 2e-16 ***
ORIGIN_SZWDSZ02  0.9119539  0.0050326   181.210  &lt; 2e-16 ***
ORIGIN_SZWDSZ03  1.6205678  0.0045250   358.136  &lt; 2e-16 ***
ORIGIN_SZWDSZ04  1.2081941  0.0054272   222.618  &lt; 2e-16 ***
ORIGIN_SZWDSZ05  0.4284783  0.0052752    81.224  &lt; 2e-16 ***
ORIGIN_SZWDSZ06  0.9018716  0.0049820   181.028  &lt; 2e-16 ***
ORIGIN_SZWDSZ07 -0.6444820  0.0084731   -76.062  &lt; 2e-16 ***
ORIGIN_SZWDSZ08 -0.8764983  0.0082622  -106.085  &lt; 2e-16 ***
ORIGIN_SZWDSZ09  1.3292589  0.0048663   273.158  &lt; 2e-16 ***
ORIGIN_SZYSSZ01 -0.4780462  0.0058489   -81.733  &lt; 2e-16 ***
ORIGIN_SZYSSZ02  0.9323419  0.0054402   171.380  &lt; 2e-16 ***
ORIGIN_SZYSSZ03  2.0577240  0.0046737   440.274  &lt; 2e-16 ***
ORIGIN_SZYSSZ04  0.8697472  0.0047269   184.000  &lt; 2e-16 ***
ORIGIN_SZYSSZ05  0.1662764  0.0060376    27.540  &lt; 2e-16 ***
ORIGIN_SZYSSZ06 -0.8115617  0.0109084   -74.398  &lt; 2e-16 ***
ORIGIN_SZYSSZ07 -0.8971248  0.0119220   -75.250  &lt; 2e-16 ***
ORIGIN_SZYSSZ08 -0.2738680  0.0063553   -43.093  &lt; 2e-16 ***
ORIGIN_SZYSSZ09  1.2274518  0.0044951   273.066  &lt; 2e-16 ***
DESTIN_SZAMSZ02 -0.0516322  0.0042829   -12.055  &lt; 2e-16 ***
DESTIN_SZAMSZ03  0.0801823  0.0041904    19.135  &lt; 2e-16 ***
DESTIN_SZAMSZ04 -0.9282211  0.0061322  -151.368  &lt; 2e-16 ***
DESTIN_SZAMSZ05 -1.0794168  0.0062543  -172.588  &lt; 2e-16 ***
DESTIN_SZAMSZ06 -0.8839603  0.0060851  -145.267  &lt; 2e-16 ***
DESTIN_SZAMSZ07 -1.5835093  0.0096846  -163.508  &lt; 2e-16 ***
DESTIN_SZAMSZ08 -0.9756903  0.0068829  -141.756  &lt; 2e-16 ***
DESTIN_SZAMSZ09 -1.0362692  0.0061651  -168.087  &lt; 2e-16 ***
DESTIN_SZAMSZ10 -0.1227646  0.0044788   -27.410  &lt; 2e-16 ***
DESTIN_SZAMSZ11 -0.4802374  0.0088108   -54.506  &lt; 2e-16 ***
DESTIN_SZAMSZ12  0.2142621  0.0050653    42.300  &lt; 2e-16 ***
DESTIN_SZBDSZ01  0.3582789  0.0039578    90.524  &lt; 2e-16 ***
DESTIN_SZBDSZ02 -0.4368229  0.0051384   -85.012  &lt; 2e-16 ***
DESTIN_SZBDSZ03 -0.1568727  0.0044329   -35.388  &lt; 2e-16 ***
DESTIN_SZBDSZ04  0.6731669  0.0036215   185.882  &lt; 2e-16 ***
DESTIN_SZBDSZ05  0.3647198  0.0040496    90.062  &lt; 2e-16 ***
DESTIN_SZBDSZ06  0.0589240  0.0044352    13.286  &lt; 2e-16 ***
DESTIN_SZBDSZ07 -0.6648168  0.0095742   -69.438  &lt; 2e-16 ***
DESTIN_SZBDSZ08 -1.7214136  0.0106600  -161.483  &lt; 2e-16 ***
DESTIN_SZBKSZ01 -1.2688264  0.0067263  -188.637  &lt; 2e-16 ***
DESTIN_SZBKSZ02 -0.3912129  0.0055446   -70.558  &lt; 2e-16 ***
DESTIN_SZBKSZ03 -0.8663392  0.0058693  -147.605  &lt; 2e-16 ***
DESTIN_SZBKSZ04 -0.1247273  0.0051254   -24.335  &lt; 2e-16 ***
DESTIN_SZBKSZ05 -0.7407774  0.0059120  -125.300  &lt; 2e-16 ***
DESTIN_SZBKSZ06 -0.9934643  0.0063345  -156.834  &lt; 2e-16 ***
DESTIN_SZBKSZ07  0.0882230  0.0042928    20.551  &lt; 2e-16 ***
DESTIN_SZBKSZ08 -1.1134447  0.0070752  -157.372  &lt; 2e-16 ***
DESTIN_SZBKSZ09 -0.1788171  0.0051327   -34.839  &lt; 2e-16 ***
DESTIN_SZBLSZ01 -0.7696433  0.0071898  -107.047  &lt; 2e-16 ***
DESTIN_SZBLSZ02  0.4076650  0.0068001    59.950  &lt; 2e-16 ***
DESTIN_SZBLSZ03  1.5398488  0.0078230   196.836  &lt; 2e-16 ***
DESTIN_SZBLSZ04 -0.3499486  0.0136985   -25.546  &lt; 2e-16 ***
DESTIN_SZBMSZ01 -0.2114705  0.0048311   -43.773  &lt; 2e-16 ***
DESTIN_SZBMSZ02 -0.3316806  0.0049958   -66.391  &lt; 2e-16 ***
DESTIN_SZBMSZ03 -0.5134774  0.0058534   -87.723  &lt; 2e-16 ***
DESTIN_SZBMSZ04 -0.2205274  0.0051028   -43.217  &lt; 2e-16 ***
DESTIN_SZBMSZ05 -0.2101165  0.0067710   -31.032  &lt; 2e-16 ***
DESTIN_SZBMSZ06 -1.3832385  0.0124821  -110.818  &lt; 2e-16 ***
DESTIN_SZBMSZ07 -0.0133462  0.0046787    -2.853  0.00434 ** 
DESTIN_SZBMSZ08 -0.9056756  0.0063868  -141.805  &lt; 2e-16 ***
DESTIN_SZBMSZ09 -2.3175407  0.0144523  -160.358  &lt; 2e-16 ***
DESTIN_SZBMSZ10 -1.3973725  0.0090463  -154.470  &lt; 2e-16 ***
DESTIN_SZBMSZ11 -1.3950206  0.0080459  -173.383  &lt; 2e-16 ***
DESTIN_SZBMSZ12 -0.6882789  0.0081539   -84.411  &lt; 2e-16 ***
DESTIN_SZBMSZ13 -0.2729120  0.0052969   -51.523  &lt; 2e-16 ***
DESTIN_SZBMSZ14 -0.7581980  0.0080215   -94.521  &lt; 2e-16 ***
DESTIN_SZBMSZ15 -0.9323237  0.0071093  -131.142  &lt; 2e-16 ***
DESTIN_SZBMSZ16 -2.0655530  0.0108490  -190.391  &lt; 2e-16 ***
DESTIN_SZBMSZ17 -2.5124893  0.0165366  -151.935  &lt; 2e-16 ***
DESTIN_SZBPSZ01 -0.8203274  0.0057682  -142.216  &lt; 2e-16 ***
DESTIN_SZBPSZ02 -1.5284265  0.0087447  -174.783  &lt; 2e-16 ***
DESTIN_SZBPSZ03 -1.2434382  0.0080852  -153.792  &lt; 2e-16 ***
DESTIN_SZBPSZ04 -0.7778558  0.0060900  -127.727  &lt; 2e-16 ***
DESTIN_SZBPSZ05  0.1782204  0.0042331    42.101  &lt; 2e-16 ***
DESTIN_SZBPSZ06 -0.6758807  0.0079728   -84.773  &lt; 2e-16 ***
DESTIN_SZBPSZ07 -0.5029450  0.0081151   -61.976  &lt; 2e-16 ***
DESTIN_SZBSSZ01 -0.1269916  0.0046949   -27.049  &lt; 2e-16 ***
DESTIN_SZBSSZ02 -0.7536917  0.0051895  -145.233  &lt; 2e-16 ***
DESTIN_SZBSSZ03  0.2747969  0.0039115    70.254  &lt; 2e-16 ***
DESTIN_SZBTSZ01  0.1708577  0.0043381    39.385  &lt; 2e-16 ***
DESTIN_SZBTSZ02 -0.6820190  0.0067243  -101.427  &lt; 2e-16 ***
DESTIN_SZBTSZ03  0.0610599  0.0049825    12.255  &lt; 2e-16 ***
DESTIN_SZBTSZ04 -1.3199639  0.0107063  -123.288  &lt; 2e-16 ***
DESTIN_SZBTSZ05 -0.4174991  0.0069221   -60.314  &lt; 2e-16 ***
DESTIN_SZBTSZ06 -0.5260242  0.0061145   -86.029  &lt; 2e-16 ***
DESTIN_SZBTSZ07 -1.6678047  0.0106335  -156.844  &lt; 2e-16 ***
DESTIN_SZBTSZ08 -0.7999935  0.0089175   -89.711  &lt; 2e-16 ***
DESTIN_SZCBSZ01 -5.6321332  0.3162476   -17.809  &lt; 2e-16 ***
DESTIN_SZCCSZ01 -0.9342781  0.0081409  -114.763  &lt; 2e-16 ***
DESTIN_SZCHSZ01 -1.2808546  0.0096774  -132.355  &lt; 2e-16 ***
DESTIN_SZCHSZ02  0.0067332  0.0054322     1.239  0.21516    
DESTIN_SZCHSZ03  1.0988838  0.0041378   265.570  &lt; 2e-16 ***
DESTIN_SZCKSZ01 -0.3192235  0.0050632   -63.048  &lt; 2e-16 ***
DESTIN_SZCKSZ02 -0.7776453  0.0055279  -140.676  &lt; 2e-16 ***
DESTIN_SZCKSZ03  0.2772358  0.0042541    65.170  &lt; 2e-16 ***
DESTIN_SZCKSZ04 -1.3842048  0.0065159  -212.436  &lt; 2e-16 ***
DESTIN_SZCKSZ05 -1.2051808  0.0076814  -156.897  &lt; 2e-16 ***
DESTIN_SZCKSZ06  0.1321955  0.0061568    21.472  &lt; 2e-16 ***
DESTIN_SZCLSZ01  0.1942449  0.0049977    38.867  &lt; 2e-16 ***
DESTIN_SZCLSZ02 -2.0828648  0.0134597  -154.749  &lt; 2e-16 ***
DESTIN_SZCLSZ03 -0.8823728  0.0078307  -112.681  &lt; 2e-16 ***
DESTIN_SZCLSZ04 -0.2311432  0.0047194   -48.977  &lt; 2e-16 ***
DESTIN_SZCLSZ05 -1.0113430  0.0085536  -118.237  &lt; 2e-16 ***
DESTIN_SZCLSZ06  0.0694682  0.0042166    16.475  &lt; 2e-16 ***
DESTIN_SZCLSZ07 -0.4953961  0.0054184   -91.429  &lt; 2e-16 ***
DESTIN_SZCLSZ08 -0.3849563  0.0061404   -62.693  &lt; 2e-16 ***
DESTIN_SZCLSZ09  0.4201808  0.0067112    62.609  &lt; 2e-16 ***
DESTIN_SZDTSZ02 -2.6513032  0.0348725   -76.029  &lt; 2e-16 ***
DESTIN_SZDTSZ03 -1.5192228  0.0144477  -105.153  &lt; 2e-16 ***
DESTIN_SZDTSZ13 -2.2041951  0.0161726  -136.292  &lt; 2e-16 ***
DESTIN_SZGLSZ01 -0.0139744  0.0052464    -2.664  0.00773 ** 
DESTIN_SZGLSZ02 -0.2850816  0.0047467   -60.059  &lt; 2e-16 ***
DESTIN_SZGLSZ03  0.3511872  0.0039473    88.969  &lt; 2e-16 ***
DESTIN_SZGLSZ04  0.2909117  0.0039436    73.769  &lt; 2e-16 ***
DESTIN_SZGLSZ05  0.1845361  0.0040011    46.121  &lt; 2e-16 ***
DESTIN_SZHGSZ01  0.1418382  0.0039875    35.571  &lt; 2e-16 ***
DESTIN_SZHGSZ02 -0.7233151  0.0052374  -138.105  &lt; 2e-16 ***
DESTIN_SZHGSZ03 -1.1918463  0.0062129  -191.834  &lt; 2e-16 ***
DESTIN_SZHGSZ04 -0.4380360  0.0044839   -97.691  &lt; 2e-16 ***
DESTIN_SZHGSZ05 -0.5671024  0.0046427  -122.149  &lt; 2e-16 ***
DESTIN_SZHGSZ06 -0.8271411  0.0054935  -150.566  &lt; 2e-16 ***
DESTIN_SZHGSZ07  0.0721800  0.0041589    17.356  &lt; 2e-16 ***
DESTIN_SZHGSZ08 -0.4297429  0.0050021   -85.913  &lt; 2e-16 ***
DESTIN_SZHGSZ09 -0.2085461  0.0052544   -39.690  &lt; 2e-16 ***
DESTIN_SZHGSZ10 -2.9169699  0.0262698  -111.039  &lt; 2e-16 ***
DESTIN_SZJESZ01 -0.2822473  0.0051166   -55.163  &lt; 2e-16 ***
DESTIN_SZJESZ02 -0.6761389  0.0053635  -126.063  &lt; 2e-16 ***
DESTIN_SZJESZ03 -0.7371756  0.0058983  -124.980  &lt; 2e-16 ***
DESTIN_SZJESZ04 -0.4593491  0.0067970   -67.581  &lt; 2e-16 ***
DESTIN_SZJESZ05 -1.1418012  0.0099049  -115.277  &lt; 2e-16 ***
DESTIN_SZJESZ06  0.1759680  0.0042791    41.123  &lt; 2e-16 ***
DESTIN_SZJESZ07 -1.2260587  0.0082714  -148.229  &lt; 2e-16 ***
DESTIN_SZJESZ08 -0.8547001  0.0080417  -106.283  &lt; 2e-16 ***
DESTIN_SZJESZ09 -0.4306353  0.0057006   -75.542  &lt; 2e-16 ***
DESTIN_SZJESZ10  0.6584971  0.0073664    89.392  &lt; 2e-16 ***
DESTIN_SZJESZ11  0.9661208  0.0070491   137.056  &lt; 2e-16 ***
DESTIN_SZJWSZ01 -0.9128436  0.0069529  -131.290  &lt; 2e-16 ***
DESTIN_SZJWSZ02 -0.7285851  0.0054839  -132.859  &lt; 2e-16 ***
DESTIN_SZJWSZ03  0.2601455  0.0043215    60.198  &lt; 2e-16 ***
DESTIN_SZJWSZ04  0.6860274  0.0041135   166.775  &lt; 2e-16 ***
DESTIN_SZJWSZ05 -0.4684576  0.0062875   -74.506  &lt; 2e-16 ***
DESTIN_SZJWSZ06 -0.2459774  0.0057575   -42.723  &lt; 2e-16 ***
DESTIN_SZJWSZ07 -1.8854234  0.0287721   -65.529  &lt; 2e-16 ***
DESTIN_SZJWSZ08 -0.5523308  0.0051054  -108.186  &lt; 2e-16 ***
DESTIN_SZJWSZ09  0.8818747  0.0037800   233.301  &lt; 2e-16 ***
DESTIN_SZKLSZ01 -0.5814386  0.0052711  -110.308  &lt; 2e-16 ***
DESTIN_SZKLSZ02 -0.7090577  0.0058161  -121.914  &lt; 2e-16 ***
DESTIN_SZKLSZ03 -1.2191910  0.0065984  -184.772  &lt; 2e-16 ***
DESTIN_SZKLSZ04 -1.6961428  0.0087866  -193.038  &lt; 2e-16 ***
DESTIN_SZKLSZ05 -0.6927144  0.0073574   -94.153  &lt; 2e-16 ***
DESTIN_SZKLSZ06 -2.2967464  0.0362605   -63.340  &lt; 2e-16 ***
DESTIN_SZKLSZ07 -0.9536980  0.0066777  -142.819  &lt; 2e-16 ***
DESTIN_SZKLSZ08 -0.4565596  0.0051736   -88.249  &lt; 2e-16 ***
DESTIN_SZLKSZ01 -1.7277135  0.0207336   -83.329  &lt; 2e-16 ***
DESTIN_SZMDSZ01 -1.7155417  0.0210080   -81.661  &lt; 2e-16 ***
DESTIN_SZMDSZ02 -1.3694928  0.0114174  -119.948  &lt; 2e-16 ***
DESTIN_SZMDSZ03 -2.7183729  0.0252678  -107.582  &lt; 2e-16 ***
DESTIN_SZMPSZ01 -0.8051991  0.0078564  -102.490  &lt; 2e-16 ***
DESTIN_SZMPSZ02 -0.7627000  0.0061386  -124.246  &lt; 2e-16 ***
DESTIN_SZMPSZ03 -0.0649484  0.0047787   -13.591  &lt; 2e-16 ***
DESTIN_SZMUSZ02 -1.9549128  0.0200160   -97.667  &lt; 2e-16 ***
DESTIN_SZNTSZ01 -3.3048398  0.0448053   -73.760  &lt; 2e-16 ***
DESTIN_SZNTSZ02 -1.6454847  0.0109337  -150.497  &lt; 2e-16 ***
DESTIN_SZNTSZ03 -1.1389723  0.0077396  -147.161  &lt; 2e-16 ***
DESTIN_SZNTSZ05 -2.0264109  0.0250226   -80.983  &lt; 2e-16 ***
DESTIN_SZNTSZ06 -3.3496282  0.0428989   -78.082  &lt; 2e-16 ***
DESTIN_SZNVSZ01 -0.3407614  0.0045493   -74.905  &lt; 2e-16 ***
DESTIN_SZNVSZ02 -0.4987695  0.0053942   -92.465  &lt; 2e-16 ***
DESTIN_SZNVSZ03 -0.4936107  0.0055158   -89.491  &lt; 2e-16 ***
DESTIN_SZNVSZ04 -1.9141281  0.0107557  -177.964  &lt; 2e-16 ***
DESTIN_SZNVSZ05 -1.5378263  0.0089577  -171.677  &lt; 2e-16 ***
DESTIN_SZPGSZ01 -1.7744485  0.0194346   -91.304  &lt; 2e-16 ***
DESTIN_SZPGSZ02 -0.9282918  0.0069006  -134.523  &lt; 2e-16 ***
DESTIN_SZPGSZ03  0.0885025  0.0042145    21.000  &lt; 2e-16 ***
DESTIN_SZPGSZ04 -0.3879375  0.0046862   -82.784  &lt; 2e-16 ***
DESTIN_SZPGSZ05 -0.9649873  0.0074625  -129.311  &lt; 2e-16 ***
DESTIN_SZPLSZ01 -0.6159175  0.0070845   -86.939  &lt; 2e-16 ***
DESTIN_SZPLSZ02 -1.7551386  0.0133081  -131.885  &lt; 2e-16 ***
DESTIN_SZPLSZ03 -0.1378379  0.0098704   -13.965  &lt; 2e-16 ***
DESTIN_SZPLSZ04 -0.1411200  0.0096446   -14.632  &lt; 2e-16 ***
DESTIN_SZPLSZ05 -0.8483196  0.0119048   -71.259  &lt; 2e-16 ***
DESTIN_SZPNSZ01 -0.1579087  0.0057330   -27.544  &lt; 2e-16 ***
DESTIN_SZPNSZ02  1.0243480  0.0076680   133.587  &lt; 2e-16 ***
DESTIN_SZPNSZ03  0.0451598  0.0081444     5.545 2.94e-08 ***
DESTIN_SZPNSZ04  1.8941928  0.0087479   216.530  &lt; 2e-16 ***
DESTIN_SZPNSZ05  1.0341581  0.0130830    79.046  &lt; 2e-16 ***
DESTIN_SZPRSZ01 -1.4038513  0.0086911  -161.527  &lt; 2e-16 ***
DESTIN_SZPRSZ02 -0.4942539  0.0052403   -94.319  &lt; 2e-16 ***
DESTIN_SZPRSZ03  0.4219510  0.0040281   104.751  &lt; 2e-16 ***
DESTIN_SZPRSZ04 -0.4841099  0.0083498   -57.979  &lt; 2e-16 ***
DESTIN_SZPRSZ05 -0.2988481  0.0047512   -62.899  &lt; 2e-16 ***
DESTIN_SZPRSZ06  0.0012333  0.0054530     0.226  0.82108    
DESTIN_SZPRSZ07 -1.1417482  0.0118845   -96.070  &lt; 2e-16 ***
DESTIN_SZPRSZ08 -0.8259249  0.0066757  -123.720  &lt; 2e-16 ***
DESTIN_SZQTSZ01 -1.2134330  0.0089222  -136.002  &lt; 2e-16 ***
DESTIN_SZQTSZ02 -1.2397956  0.0074512  -166.388  &lt; 2e-16 ***
DESTIN_SZQTSZ03 -0.7448659  0.0066511  -111.992  &lt; 2e-16 ***
DESTIN_SZQTSZ04 -0.6243112  0.0066812   -93.443  &lt; 2e-16 ***
DESTIN_SZQTSZ05 -0.6102589  0.0060458  -100.940  &lt; 2e-16 ***
DESTIN_SZQTSZ06 -0.9164592  0.0065095  -140.788  &lt; 2e-16 ***
DESTIN_SZQTSZ07 -1.4600643  0.0109976  -132.762  &lt; 2e-16 ***
DESTIN_SZQTSZ08  0.0004582  0.0050178     0.091  0.92724    
DESTIN_SZQTSZ09 -0.5226213  0.0058901   -88.728  &lt; 2e-16 ***
DESTIN_SZQTSZ10 -0.3867082  0.0055876   -69.208  &lt; 2e-16 ***
DESTIN_SZQTSZ11  0.0260589  0.0055065     4.732 2.22e-06 ***
DESTIN_SZQTSZ12 -0.3387634  0.0072779   -46.547  &lt; 2e-16 ***
DESTIN_SZQTSZ13 -0.0512118  0.0053664    -9.543  &lt; 2e-16 ***
DESTIN_SZQTSZ14 -0.2555346  0.0063792   -40.057  &lt; 2e-16 ***
DESTIN_SZQTSZ15 -0.1820651  0.0077537   -23.481  &lt; 2e-16 ***
DESTIN_SZRCSZ01 -0.4641196  0.0072515   -64.003  &lt; 2e-16 ***
DESTIN_SZRCSZ06 -2.0929548  0.0189106  -110.676  &lt; 2e-16 ***
DESTIN_SZRVSZ01 -1.7885682  0.0163492  -109.398  &lt; 2e-16 ***
DESTIN_SZRVSZ02 -3.1669721  0.0326320   -97.051  &lt; 2e-16 ***
DESTIN_SZRVSZ03 -2.0306835  0.0135749  -149.591  &lt; 2e-16 ***
DESTIN_SZRVSZ04 -1.5113470  0.0155637   -97.107  &lt; 2e-16 ***
DESTIN_SZRVSZ05 -2.3683855  0.0259334   -91.326  &lt; 2e-16 ***
DESTIN_SZSBSZ01 -0.5841063  0.0068588   -85.162  &lt; 2e-16 ***
DESTIN_SZSBSZ02 -1.0777704  0.0078288  -137.667  &lt; 2e-16 ***
DESTIN_SZSBSZ03  0.4734371  0.0045880   103.190  &lt; 2e-16 ***
DESTIN_SZSBSZ04  0.0546094  0.0057517     9.494  &lt; 2e-16 ***
DESTIN_SZSBSZ05 -0.9588198  0.0075242  -127.431  &lt; 2e-16 ***
DESTIN_SZSBSZ06 -1.8528944  0.0234040   -79.170  &lt; 2e-16 ***
DESTIN_SZSBSZ07 -1.8403768  0.0195878   -93.955  &lt; 2e-16 ***
DESTIN_SZSBSZ08  0.9205969  0.0055698   165.285  &lt; 2e-16 ***
DESTIN_SZSBSZ09  0.5166486  0.0051939    99.472  &lt; 2e-16 ***
DESTIN_SZSESZ02 -0.5728211  0.0048270  -118.669  &lt; 2e-16 ***
DESTIN_SZSESZ03  0.2554787  0.0038335    66.645  &lt; 2e-16 ***
DESTIN_SZSESZ04 -0.8982794  0.0056698  -158.432  &lt; 2e-16 ***
DESTIN_SZSESZ05 -0.4661655  0.0048578   -95.962  &lt; 2e-16 ***
DESTIN_SZSESZ06 -0.8392849  0.0059198  -141.777  &lt; 2e-16 ***
DESTIN_SZSESZ07 -3.2182325  0.0227089  -141.717  &lt; 2e-16 ***
DESTIN_SZSGSZ01 -0.2751206  0.0059581   -46.176  &lt; 2e-16 ***
DESTIN_SZSGSZ02 -0.2951806  0.0052515   -56.209  &lt; 2e-16 ***
DESTIN_SZSGSZ03 -0.4469508  0.0048181   -92.766  &lt; 2e-16 ***
DESTIN_SZSGSZ04 -0.2842809  0.0047961   -59.274  &lt; 2e-16 ***
DESTIN_SZSGSZ05 -2.0643753  0.0098252  -210.109  &lt; 2e-16 ***
DESTIN_SZSGSZ06  0.2501247  0.0038873    64.343  &lt; 2e-16 ***
DESTIN_SZSGSZ07 -0.5743750  0.0052184  -110.067  &lt; 2e-16 ***
DESTIN_SZSISZ01 -1.1030669  0.0259113   -42.571  &lt; 2e-16 ***
DESTIN_SZSKSZ01 -0.5462538  0.0071443   -76.460  &lt; 2e-16 ***
DESTIN_SZSKSZ02  0.2965180  0.0056707    52.290  &lt; 2e-16 ***
DESTIN_SZSKSZ03 -0.4521490  0.0062177   -72.719  &lt; 2e-16 ***
DESTIN_SZSKSZ04 -0.6665145  0.0148252   -44.958  &lt; 2e-16 ***
DESTIN_SZSKSZ05 -0.1474142  0.0121958   -12.087  &lt; 2e-16 ***
DESTIN_SZSLSZ01 -0.8855715  0.0084587  -104.693  &lt; 2e-16 ***
DESTIN_SZSLSZ04 -1.1787840  0.0071355  -165.200  &lt; 2e-16 ***
DESTIN_SZSRSZ01 -1.6435064  0.0128822  -127.580  &lt; 2e-16 ***
DESTIN_SZTHSZ01 -3.4388625  0.0367651   -93.536  &lt; 2e-16 ***
DESTIN_SZTHSZ03 -2.5809435  0.0256853  -100.483  &lt; 2e-16 ***
DESTIN_SZTHSZ04 -2.4887189  0.0214441  -116.056  &lt; 2e-16 ***
DESTIN_SZTHSZ06 -1.7965101  0.0152160  -118.067  &lt; 2e-16 ***
DESTIN_SZTMSZ01 -0.3251891  0.0058067   -56.002  &lt; 2e-16 ***
DESTIN_SZTMSZ02  1.1558743  0.0034703   333.080  &lt; 2e-16 ***
DESTIN_SZTMSZ03  0.4525619  0.0039244   115.319  &lt; 2e-16 ***
DESTIN_SZTMSZ04  0.8223271  0.0040060   205.274  &lt; 2e-16 ***
DESTIN_SZTMSZ05  0.3880619  0.0054308    71.456  &lt; 2e-16 ***
DESTIN_SZTNSZ01 -0.9533112  0.0067853  -140.496  &lt; 2e-16 ***
DESTIN_SZTNSZ02 -1.5909451  0.0097396  -163.348  &lt; 2e-16 ***
DESTIN_SZTNSZ03 -1.6470771  0.0116598  -141.261  &lt; 2e-16 ***
DESTIN_SZTNSZ04 -1.0686173  0.0069848  -152.993  &lt; 2e-16 ***
DESTIN_SZTPSZ01 -0.5180183  0.0056886   -91.063  &lt; 2e-16 ***
DESTIN_SZTPSZ02  0.2160781  0.0038283    56.443  &lt; 2e-16 ***
DESTIN_SZTPSZ03 -0.2479956  0.0056651   -43.776  &lt; 2e-16 ***
DESTIN_SZTPSZ04 -1.5015463  0.0072444  -207.271  &lt; 2e-16 ***
DESTIN_SZTPSZ05 -0.9551144  0.0057981  -164.729  &lt; 2e-16 ***
DESTIN_SZTPSZ06 -0.4846634  0.0074621   -64.950  &lt; 2e-16 ***
DESTIN_SZTPSZ07 -1.9753440  0.0118295  -166.984  &lt; 2e-16 ***
DESTIN_SZTPSZ08 -1.3455063  0.0086909  -154.817  &lt; 2e-16 ***
DESTIN_SZTPSZ09 -0.3556620  0.0061296   -58.024  &lt; 2e-16 ***
DESTIN_SZTPSZ10 -1.3213501  0.0085951  -153.733  &lt; 2e-16 ***
DESTIN_SZTPSZ11 -0.3877006  0.0052409   -73.977  &lt; 2e-16 ***
DESTIN_SZTPSZ12 -0.7064020  0.0062472  -113.075  &lt; 2e-16 ***
DESTIN_SZTSSZ01 -0.8827157  0.0218327   -40.431  &lt; 2e-16 ***
DESTIN_SZTSSZ02 -0.6067055  0.0115514   -52.522  &lt; 2e-16 ***
DESTIN_SZTSSZ03  0.4380259  0.0086774    50.479  &lt; 2e-16 ***
DESTIN_SZTSSZ04  0.4902124  0.0089922    54.515  &lt; 2e-16 ***
DESTIN_SZTSSZ05  1.4336278  0.0093410   153.477  &lt; 2e-16 ***
DESTIN_SZTSSZ06  0.9223573  0.0209024    44.127  &lt; 2e-16 ***
DESTIN_SZWCSZ01  1.1559309  0.0051787   223.208  &lt; 2e-16 ***
DESTIN_SZWCSZ02 -1.2664455  0.0126131  -100.407  &lt; 2e-16 ***
DESTIN_SZWCSZ03 -2.7360882  0.0325753   -83.993  &lt; 2e-16 ***
DESTIN_SZWDSZ01  0.8193492  0.0037301   219.657  &lt; 2e-16 ***
DESTIN_SZWDSZ02 -0.7852474  0.0058655  -133.875  &lt; 2e-16 ***
DESTIN_SZWDSZ03  0.5742422  0.0041884   137.104  &lt; 2e-16 ***
DESTIN_SZWDSZ04 -0.8391525  0.0065075  -128.951  &lt; 2e-16 ***
DESTIN_SZWDSZ05 -0.3510692  0.0057253   -61.319  &lt; 2e-16 ***
DESTIN_SZWDSZ06  0.1358804  0.0043968    30.905  &lt; 2e-16 ***
DESTIN_SZWDSZ07 -0.2207379  0.0066369   -33.259  &lt; 2e-16 ***
DESTIN_SZWDSZ08 -0.0264655  0.0065065    -4.068 4.75e-05 ***
DESTIN_SZWDSZ09 -0.2065828  0.0050524   -40.888  &lt; 2e-16 ***
DESTIN_SZYSSZ01  0.7467996  0.0040979   182.238  &lt; 2e-16 ***
DESTIN_SZYSSZ02 -0.3002718  0.0053434   -56.195  &lt; 2e-16 ***
DESTIN_SZYSSZ03 -1.1087686  0.0057219  -193.778  &lt; 2e-16 ***
DESTIN_SZYSSZ04 -0.3748076  0.0051481   -72.805  &lt; 2e-16 ***
DESTIN_SZYSSZ05 -1.7909654  0.0102064  -175.475  &lt; 2e-16 ***
DESTIN_SZYSSZ06 -1.8519179  0.0099601  -185.933  &lt; 2e-16 ***
DESTIN_SZYSSZ07 -0.9246626  0.0118101   -78.294  &lt; 2e-16 ***
DESTIN_SZYSSZ08  0.4403129  0.0041268   106.697  &lt; 2e-16 ***
DESTIN_SZYSSZ09  0.0267012  0.0041393     6.451 1.11e-10 ***
log(dist)       -0.6721961  0.0001353 -4969.566  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 60796037  on 14733  degrees of freedom
Residual deviance: 20988409  on 14175  degrees of freedom
AIC: 21081154

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>The R-squared value of the doubly-constrained SIM is 0.574.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(dbcSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, dbcSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5739638</code></pre>
</div>
</div>
</section>
<section id="model-comparison" class="level2">
<h2 class="anchored" data-anchor-id="model-comparison">3.8 Model comparison</h2>
<p>We could compare the model performance using the root mean squared error (RMSE). We first create a list of the four models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">unconstrained=</span>uncSIM,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">originConstrained=</span>orcSIM,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">destinationConstrained=</span>decSIM,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">doublyConstrained=</span>dbcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then compute the RMSE of all the models using the <code>compare_performance()</code> function from the <code>performance</code> package. The results show that doubly constrained SIM is the best model with the smallest RMSE value of 3252.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(model_list,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="st">"RMSE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                   | Model |     RMSE
-----------------------------------------
unconstrained          |   glm | 4177.524
originConstrained      |   glm | 3643.596
destinationConstrained |   glm | 3347.482
doublyConstrained      |   glm | 3252.297</code></pre>
</div>
</div>
</section>
<section id="visualising-fitted-values" class="level2">
<h2 class="anchored" data-anchor-id="visualising-fitted-values">3.9 Visualising fitted values</h2>
<p>In this section, we will visualise the observed values against the fitted values.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Extract models’ fitted values</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Visualisation</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>The code below extracts the fitted values from each model and appends them to the <code>SIM_data</code> dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Unconstrained SIM</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(uncSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">uncTRIPS =</span> <span class="st">"uncSIM$fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Origin-constrained SIM</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(orcSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">orcTRIPS =</span> <span class="st">"orcSIM$fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Destination-constrained SIM</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(decSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">decTRIPS =</span> <span class="st">"decSIM$fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Doubly-constrained SIM</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dbcSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dbcTRIPS =</span> <span class="st">"dbcSIM$fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>unc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> uncTRIPS,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>orc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> orcTRIPS,</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>dec_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> decTRIPS,</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>dbc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> dbcTRIPS,</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(unc_p, orc_p, dec_p, dbc_p,</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Hands-on_Ex09B_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>