{
  "hash": "9a417d2a49915d9df9f724aa0cc64403",
  "result": {
    "markdown": "---\ntitle: \"Hands-on Ex 9B\"\nsubtitle: \"Calibrating Spatial Interaction Models\"\nauthor: \"Stephen Tay\"\ndate: \"2 Nov 2024\"\ndate-modified:  \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  message: false\n  freeze: true \n---\n\n\nThe hands-on exercise on **Modelling Geographical Accessibility** is in [Hands-on Ex 10](https://geospatialanalytics-stephentay.netlify.app/Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html)\n\n# 1. Overview\n**Spatial Interaction Models (SIMs)** are mathematical models for estimating flows between locations. These models help to analyse movement patterns by assessing the factors influencing interactions between places. There are four main types of SIMs:\n\n- **Unconstrained:** Estimates flows without restrictions, assuming all spatial units interact freely.\n- **Origin-constrained (or production-constrained):** Constrains the total flow from each origin, focusing on the production capacity of each origin location.\n- **Destination-constrained (or attraction-constrained):** Constrains the total flow into each destination, considering the attraction capacity of each destination.\n- **Doubly-constrained:** Balances flows from both origins and destinations, ensuring both production and attraction capacities are met.\n\nOrdinary Least Squares (OLS), log-normal, Poisson, and negative binomial (NB) regression methods are commonly used to calibrate OD flow models by treating flow data as different types of dependent variables. In this exercise, we will be using Poisson regression to calibrate a SIM to determine factors affecting the bus commuter flows on weekday morning peak hours in Singapore.\n\nCalibration is the process of adjusting model parameters to ensure the model’s estimates closely match observed data. Goodness-of-fit statistics are typically used to confirm that the optimal solution has been achieved.\n\nThe following R packages are used in this exercise:\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tmap, sf, sp, performance, reshape2, ggpubr, tidyverse)\n```\n:::\n\n\n# 2. Importing & Preparing Data\nThis exercise builds on [Hands-on Ex 9A](https://geospatialanalytics-stephentay.netlify.app/Hands-on_Ex/Hands-on_Ex9/Hands-on_Ex9A.html) on **Processing & Visualising Flow Data**, and utilises the following datasets:\n\n- **OD Matrix of Bus Commuter Flow**: Data on weekday morning peak-hour bus commuter flows, derived from LTA’s dataset.\n- **MPSZ-2019**: Sub-zone boundary data from the URA Master Plan 2019.\n- **Sub-Zone Population Data**: Population counts by age group (e.g., 7-12, 13-24, 25-64) at the sub-zone level.\n\n## 2.1 Prepare distance matrix between planning subzones\nThe following steps are taken to compute the distance matrix between planning subzones.\n\n::: panel-tabset\n### 1. Import MPSZ\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz <- read_rds(\"data/rds/mpsz.rds\")\nmpsz\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n                 SUBZONE_N SUBZONE_C       PLN_AREA_N PLN_AREA_C       REGION_N\n1              MARINA EAST    MESZ01      MARINA EAST         ME CENTRAL REGION\n2         INSTITUTION HILL    RVSZ05     RIVER VALLEY         RV CENTRAL REGION\n3           ROBERTSON QUAY    SRSZ01  SINGAPORE RIVER         SR CENTRAL REGION\n4  JURONG ISLAND AND BUKOM    WISZ01  WESTERN ISLANDS         WI    WEST REGION\n5             FORT CANNING    MUSZ02           MUSEUM         MU CENTRAL REGION\n6         MARINA EAST (MP)    MPSZ05    MARINE PARADE         MP CENTRAL REGION\n7                   SUDONG    WISZ03  WESTERN ISLANDS         WI    WEST REGION\n8                  SEMAKAU    WISZ02  WESTERN ISLANDS         WI    WEST REGION\n9           SOUTHERN GROUP    SISZ02 SOUTHERN ISLANDS         SI CENTRAL REGION\n10                 SENTOSA    SISZ01 SOUTHERN ISLANDS         SI CENTRAL REGION\n   REGION_C                       geometry\n1        CR MULTIPOLYGON (((33222.98 29...\n2        CR MULTIPOLYGON (((28481.45 30...\n3        CR MULTIPOLYGON (((28087.34 30...\n4        WR MULTIPOLYGON (((14557.7 304...\n5        CR MULTIPOLYGON (((29542.53 31...\n6        CR MULTIPOLYGON (((35279.55 30...\n7        WR MULTIPOLYGON (((15772.59 21...\n8        WR MULTIPOLYGON (((19843.41 21...\n9        CR MULTIPOLYGON (((30870.53 22...\n10       CR MULTIPOLYGON (((26879.04 26...\n```\n:::\n:::\n\n\n### 2. Convert to sp dataframe\nBefore computing the distance matrix (i.e., distances between pairs of locations), we convert the sf dataframe to an sp dataframe. Although the distance matrix can be computed directly from an sf dataframe, the sp method is generally more time-efficient.\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_sp <- as(mpsz, \"Spatial\")\nmpsz_sp\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nclass       : SpatialPolygonsDataFrame \nfeatures    : 332 \nextent      : 2667.538, 56396.44, 15748.72, 50256.33  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 6\nnames       : SUBZONE_N, SUBZONE_C, PLN_AREA_N, PLN_AREA_C,       REGION_N, REGION_C \nmin values  : ADMIRALTY,    AMSZ01, ANG MO KIO,         AM, CENTRAL REGION,       CR \nmax values  :    YUNNAN,    YSSZ09,     YISHUN,         YS,    WEST REGION,       WR \n```\n:::\n:::\n\n### 3. Compute distance matrix\nWe use the spDists() function from the sp package to compute the Euclidean distance between the centroids of the planning subzones.\n\n::: {.cell}\n\n```{.r .cell-code}\ndist <- spDists(mpsz_sp, \n                longlat = FALSE)\nhead(dist, n=c(10, 10))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           [,1]       [,2]      [,3]      [,4]       [,5]      [,6]      [,7]\n [1,]     0.000  3926.0025  3939.108 20252.964  2989.9839  1431.330 19211.836\n [2,]  3926.003     0.0000   305.737 16513.865   951.8314  5254.066 16242.523\n [3,]  3939.108   305.7370     0.000 16412.062  1045.9088  5299.849 16026.146\n [4,] 20252.964 16513.8648 16412.062     0.000 17450.3044 21665.795  7229.017\n [5,]  2989.984   951.8314  1045.909 17450.304     0.0000  4303.232 17020.916\n [6,]  1431.330  5254.0664  5299.849 21665.795  4303.2323     0.000 20617.082\n [7,] 19211.836 16242.5230 16026.146  7229.017 17020.9161 20617.082     0.000\n [8,] 14960.942 12749.4101 12477.871 11284.279 13336.0421 16281.453  5606.082\n [9,]  7515.256  7934.8082  7649.776 18427.503  7801.6163  8403.896 14810.930\n[10,]  6391.342  4975.0021  4669.295 15469.566  5226.8731  7707.091 13111.391\n           [,8]      [,9]     [,10]\n [1,] 14960.942  7515.256  6391.342\n [2,] 12749.410  7934.808  4975.002\n [3,] 12477.871  7649.776  4669.295\n [4,] 11284.279 18427.503 15469.566\n [5,] 13336.042  7801.616  5226.873\n [6,] 16281.453  8403.896  7707.091\n [7,]  5606.082 14810.930 13111.391\n [8,]     0.000  9472.024  8575.490\n [9,]  9472.024     0.000  3780.800\n[10,]  8575.490  3780.800     0.000\n```\n:::\n:::\n\n\n### 4. Label row and column headers of distance matrix\nSince the row and column headers of the distance matrix are unlabeled, we perform the following steps to add labels for the planning subzone codes:\n\n-\tCreate a list of planning subzone codes sorted to match the order of the distance matrix.\n-\tAttach SUBZONE_C labels to the rows and columns of the distance matrix for alignment.\n\n::: {.cell}\n\n```{.r .cell-code}\nsz_names <- mpsz$SUBZONE_C\n\ncolnames(dist) <- paste0(sz_names)\nrownames(dist) <- paste0(sz_names)\n\nhead(dist, n=c(5, 5))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          MESZ01     RVSZ05    SRSZ01   WISZ01     MUSZ02\nMESZ01     0.000  3926.0025  3939.108 20252.96  2989.9839\nRVSZ05  3926.003     0.0000   305.737 16513.86   951.8314\nSRSZ01  3939.108   305.7370     0.000 16412.06  1045.9088\nWISZ01 20252.964 16513.8648 16412.062     0.00 17450.3044\nMUSZ02  2989.984   951.8314  1045.909 17450.30     0.0000\n```\n:::\n:::\n\n\n### 5. Convert distance matrix to long table format\nWe use the `melt()` function to convert the distance matrix into a long-table format. Note that intra-zonal distances are 0.\n\n::: {.cell}\n\n```{.r .cell-code}\ndistPair <- melt(dist) %>%\n  rename(dist = value)\nhead(distPair, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Var1   Var2      dist\n1  MESZ01 MESZ01     0.000\n2  RVSZ05 MESZ01  3926.003\n3  SRSZ01 MESZ01  3939.108\n4  WISZ01 MESZ01 20252.964\n5  MUSZ02 MESZ01  2989.984\n6  MPSZ05 MESZ01  1431.330\n7  WISZ03 MESZ01 19211.836\n8  WISZ02 MESZ01 14960.942\n9  SISZ02 MESZ01  7515.256\n10 SISZ01 MESZ01  6391.342\n```\n:::\n:::\n\n\n### 6. Update intra-zonal distance\nWe assign a small non-zero constant to replace intra-zonal distances of 0.\n\nFirst, we find out the minimum inter-zonal distance using `summary()`.\n\n::: {.cell}\n\n```{.r .cell-code}\ndistPair %>%\n  filter(dist > 0) %>%\n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      Var1             Var2             dist        \n MESZ01 :   331   MESZ01 :   331   Min.   :  173.8  \n RVSZ05 :   331   RVSZ05 :   331   1st Qu.: 7149.5  \n SRSZ01 :   331   SRSZ01 :   331   Median :11890.0  \n WISZ01 :   331   WISZ01 :   331   Mean   :12229.4  \n MUSZ02 :   331   MUSZ02 :   331   3rd Qu.:16401.7  \n MPSZ05 :   331   MPSZ05 :   331   Max.   :49894.4  \n (Other):107906   (Other):107906                    \n```\n:::\n:::\n\nWe assign a constant of 50m to replace intra-zonal distances.\n\n::: {.cell}\n\n```{.r .cell-code}\ndistPair$dist <- ifelse(distPair$dist == 0,\n                        50, distPair$dist)\n\ndistPair %>%\n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      Var1             Var2             dist      \n MESZ01 :   332   MESZ01 :   332   Min.   :   50  \n RVSZ05 :   332   RVSZ05 :   332   1st Qu.: 7097  \n SRSZ01 :   332   SRSZ01 :   332   Median :11864  \n WISZ01 :   332   WISZ01 :   332   Mean   :12193  \n MUSZ02 :   332   MUSZ02 :   332   3rd Qu.:16388  \n MPSZ05 :   332   MPSZ05 :   332   Max.   :49894  \n (Other):108232   (Other):108232                  \n```\n:::\n:::\n\n\nWe rename the variables for clarity.\n\n::: {.cell}\n\n```{.r .cell-code}\ndistPair <- distPair %>%\n  rename(orig = Var1,\n         dest = Var2)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n:::\n\n## 2.2 Prepare flow data\n\n::: panel-tabset\n### 1. Import OD matrix of bus commuter flow\nThe OD matrix of bus commuter flow was computed in Ex 9A. We will import the OD matrix for this exercise.\n\n::: {.cell}\n\n```{.r .cell-code}\nod_data_fii <- read_rds(\"data/rds/od_data_fii.rds\")\n```\n:::\n\n\n### 2. Compute total bus commuter trips\nWe compute the total commuter trips between and within planning subzones as follows:\n\n::: {.cell}\n\n```{.r .cell-code}\nflow_data <- od_data_fii %>%\n  group_by(ORIGIN_SZ, DESTIN_SZ) %>% \n  summarize(TRIPS = sum(MORNING_PEAK)) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'ORIGIN_SZ'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nhead(flow_data, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 × 3\n# Groups:   ORIGIN_SZ [1]\n   ORIGIN_SZ DESTIN_SZ TRIPS\n   <chr>     <chr>     <dbl>\n 1 AMSZ01    AMSZ01     1998\n 2 AMSZ01    AMSZ02     8289\n 3 AMSZ01    AMSZ03     8971\n 4 AMSZ01    AMSZ04     2252\n 5 AMSZ01    AMSZ05     6136\n 6 AMSZ01    AMSZ06     2148\n 7 AMSZ01    AMSZ07     1620\n 8 AMSZ01    AMSZ08     1925\n 9 AMSZ01    AMSZ09     1773\n10 AMSZ01    AMSZ10       63\n```\n:::\n:::\n\n\n### 3. Add new fields for intra-zonal flows\nTwo new fields specific to intra-zonal flows are added to the dataset.\n\n::: {.cell}\n\n```{.r .cell-code}\nflow_data$FlowNoIntra <- ifelse(\n  flow_data$ORIGIN_SZ == flow_data$DESTIN_SZ, \n  0, flow_data$TRIPS)\nflow_data$offset <- ifelse(\n  flow_data$ORIGIN_SZ == flow_data$DESTIN_SZ, \n  0.000001, 1)\nglimpse(flow_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 14,734\nColumns: 5\nGroups: ORIGIN_SZ [279]\n$ ORIGIN_SZ   <chr> \"AMSZ01\", \"AMSZ01\", \"AMSZ01\", \"AMSZ01\", \"AMSZ01\", \"AMSZ01\"…\n$ DESTIN_SZ   <chr> \"AMSZ01\", \"AMSZ02\", \"AMSZ03\", \"AMSZ04\", \"AMSZ05\", \"AMSZ06\"…\n$ TRIPS       <dbl> 1998, 8289, 8971, 2252, 6136, 2148, 1620, 1925, 1773, 63, …\n$ FlowNoIntra <dbl> 0, 8289, 8971, 2252, 6136, 2148, 1620, 1925, 1773, 63, 542…\n$ offset      <dbl> 1e-06, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e…\n```\n:::\n:::\n\n\n### 4. Combine flow data with distance\nBefore joining the flow data with the distance dataset, we need to convert the origin and destination subzones to factor data types.\n\n::: {.cell}\n\n```{.r .cell-code}\nflow_data$ORIGIN_SZ <- as.factor(flow_data$ORIGIN_SZ)\nflow_data$DESTIN_SZ <- as.factor(flow_data$DESTIN_SZ)\n\nflow_data1 <- flow_data %>%\n  left_join(distPair,\n            by = c(\"ORIGIN_SZ\" = \"orig\", \"DESTIN_SZ\" = \"dest\"))\nglimpse(flow_data1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 14,734\nColumns: 6\nGroups: ORIGIN_SZ [279]\n$ ORIGIN_SZ   <fct> AMSZ01, AMSZ01, AMSZ01, AMSZ01, AMSZ01, AMSZ01, AMSZ01, AM…\n$ DESTIN_SZ   <fct> AMSZ01, AMSZ02, AMSZ03, AMSZ04, AMSZ05, AMSZ06, AMSZ07, AM…\n$ TRIPS       <dbl> 1998, 8289, 8971, 2252, 6136, 2148, 1620, 1925, 1773, 63, …\n$ FlowNoIntra <dbl> 0, 8289, 8971, 2252, 6136, 2148, 1620, 1925, 1773, 63, 542…\n$ offset      <dbl> 1e-06, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e…\n$ dist        <dbl> 50.0000, 810.4491, 1360.9294, 840.4432, 1076.7916, 805.297…\n```\n:::\n:::\n\n:::\n\n## 2.3 Prepare origin & destination attributes\n\n::: panel-tabset\n### 1. Import sub-zone population data\n\n::: {.cell}\n\n```{.r .cell-code}\npop <- read_csv(\"data/aspatial/pop.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 332 Columns: 5\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): PA, SZ\ndbl (3): AGE7_12, AGE13_24, AGE25_64\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nglimpse(pop)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 332\nColumns: 5\n$ PA       <chr> \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO\", \"ANG …\n$ SZ       <chr> \"ANG MO KIO TOWN CENTRE\", \"CHENG SAN\", \"CHONG BOON\", \"KEBUN B…\n$ AGE7_12  <dbl> 310, 1140, 1010, 1050, 420, 810, 390, 980, 0, 260, 0, 1190, 6…\n$ AGE13_24 <dbl> 710, 2770, 2650, 2390, 1120, 1920, 1150, 2000, 0, 650, 0, 326…\n$ AGE25_64 <dbl> 2780, 15700, 14240, 12460, 3620, 9650, 4350, 11320, 0, 2500, …\n```\n:::\n:::\n\n### 2. Append subzone code\nWe left join pop dataset with mpsz dataset to retrieve the subzone codes.\n\n::: {.cell}\n\n```{.r .cell-code}\npop <- pop %>%\n  left_join(mpsz,\n            by = c(\"PA\" = \"PLN_AREA_N\",\n                   \"SZ\" = \"SUBZONE_N\")) %>%\n  select(1:6) %>%\n  rename(SZ_NAME = SZ,\n         SZ = SUBZONE_C)\nglimpse(pop)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 332\nColumns: 6\n$ PA       <chr> \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO\", \"ANG …\n$ SZ_NAME  <chr> \"ANG MO KIO TOWN CENTRE\", \"CHENG SAN\", \"CHONG BOON\", \"KEBUN B…\n$ AGE7_12  <dbl> 310, 1140, 1010, 1050, 420, 810, 390, 980, 0, 260, 0, 1190, 6…\n$ AGE13_24 <dbl> 710, 2770, 2650, 2390, 1120, 1920, 1150, 2000, 0, 650, 0, 326…\n$ AGE25_64 <dbl> 2780, 15700, 14240, 12460, 3620, 9650, 4350, 11320, 0, 2500, …\n$ SZ       <chr> \"AMSZ01\", \"AMSZ02\", \"AMSZ03\", \"AMSZ06\", \"AMSZ07\", \"AMSZ05\", \"…\n```\n:::\n:::\n\n\n### 3. Prepare origin attribute\nWe add origin attributes to the flow data.\n\n::: {.cell}\n\n```{.r .cell-code}\nflow_data1 <- flow_data1 %>%\n  left_join(pop,\n            by = c(ORIGIN_SZ = \"SZ\")) %>%\n  rename(ORIGIN_AGE7_12 = AGE7_12,\n         ORIGIN_AGE13_24 = AGE13_24,\n         ORIGIN_AGE25_64 = AGE25_64) %>%\n  select(-c(PA, SZ_NAME))\n```\n:::\n\n\n### 4. Prepare destination attribute\nWe add destination attributes to the flow data.\n\n::: {.cell}\n\n```{.r .cell-code}\nSIM_data <- flow_data1 %>%\n  left_join(pop,\n            by = c(DESTIN_SZ = \"SZ\")) %>%\n  rename(DESTIN_AGE7_12 = AGE7_12,\n         DESTIN_AGE13_24 = AGE13_24,\n         DESTIN_AGE25_64 = AGE25_64) %>%\n  select(-c(PA, SZ_NAME))\nglimpse(SIM_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 14,734\nColumns: 12\nGroups: ORIGIN_SZ [279]\n$ ORIGIN_SZ       <chr> \"AMSZ01\", \"AMSZ01\", \"AMSZ01\", \"AMSZ01\", \"AMSZ01\", \"AMS…\n$ DESTIN_SZ       <chr> \"AMSZ01\", \"AMSZ02\", \"AMSZ03\", \"AMSZ04\", \"AMSZ05\", \"AMS…\n$ TRIPS           <dbl> 1998, 8289, 8971, 2252, 6136, 2148, 1620, 1925, 1773, …\n$ FlowNoIntra     <dbl> 0, 8289, 8971, 2252, 6136, 2148, 1620, 1925, 1773, 63,…\n$ offset          <dbl> 1e-06, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00…\n$ dist            <dbl> 50.0000, 810.4491, 1360.9294, 840.4432, 1076.7916, 805…\n$ ORIGIN_AGE7_12  <dbl> 310, 310, 310, 310, 310, 310, 310, 310, 310, 310, 310,…\n$ ORIGIN_AGE13_24 <dbl> 710, 710, 710, 710, 710, 710, 710, 710, 710, 710, 710,…\n$ ORIGIN_AGE25_64 <dbl> 2780, 2780, 2780, 2780, 2780, 2780, 2780, 2780, 2780, …\n$ DESTIN_AGE7_12  <dbl> 310, 1140, 1010, 980, 810, 1050, 420, 390, 1190, 0, 0,…\n$ DESTIN_AGE13_24 <dbl> 710, 2770, 2650, 2000, 1920, 2390, 1120, 1150, 3260, 0…\n$ DESTIN_AGE25_64 <dbl> 2780, 15700, 14240, 11320, 9650, 12460, 3620, 4350, 13…\n```\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n:::\n\n# 3. Calibrating Spatial Interaction Models\nIn this section, we will calibrate Spatial Interaction Models using Poisson Regression.\n\n## 3.1 Visualise dependent variable\n\n::: panel-tabset\n### Histogram of DV\nThe distribution of the dependent variable (total number of trips between zones) is shown below. The distribution is highly skewed and has a non-normal distribution.\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = SIM_data,\n       aes(x = TRIPS)) +\n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](Hands-on_Ex09B_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n### Scatterplot between DV and distance\nThe scatterplot below shows the relationship between the total number of trips and the key independent variable of the Spatial Interaction Model, distance. The relationship does not resemble any linear relationship.\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = SIM_data,\n       aes(x = dist,\n           y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Hands-on_Ex09B_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n### Log-transformed scatterplot\nA log-transformation of both variables reveals a relationship that closely approximates linearity.\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = SIM_data,\n       aes(x = log(dist),\n           y = log(TRIPS))) +\n  geom_point() +\n  geom_smooth(method = lm)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Hands-on_Ex09B_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n:::\n\n## 3.2 Check for zero values\nSince Poisson regression uses the natural logarithm, and log(0) is undefined, we must ensure there are no zero values in the explanatory variables. The summary indicates that some variables contain zero values.\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(SIM_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  ORIGIN_SZ          DESTIN_SZ             TRIPS         FlowNoIntra      \n Length:14734       Length:14734       Min.   :     1   Min.   :     0.0  \n Class :character   Class :character   1st Qu.:    14   1st Qu.:    13.0  \n Mode  :character   Mode  :character   Median :    76   Median :    70.0  \n                                       Mean   :  1021   Mean   :   839.9  \n                                       3rd Qu.:   426   3rd Qu.:   379.0  \n                                       Max.   :232187   Max.   :148274.0  \n     offset              dist       ORIGIN_AGE7_12 ORIGIN_AGE13_24\n Min.   :0.000001   Min.   :   50   Min.   :   0   Min.   :    0  \n 1st Qu.:1.000000   1st Qu.: 3346   1st Qu.: 240   1st Qu.:  440  \n Median :1.000000   Median : 6067   Median : 700   Median : 1350  \n Mean   :0.982150   Mean   : 6880   Mean   :1032   Mean   : 2269  \n 3rd Qu.:1.000000   3rd Qu.: 9729   3rd Qu.:1480   3rd Qu.: 3260  \n Max.   :1.000000   Max.   :26136   Max.   :6340   Max.   :16380  \n ORIGIN_AGE25_64 DESTIN_AGE7_12 DESTIN_AGE13_24 DESTIN_AGE25_64\n Min.   :    0   Min.   :   0   Min.   :    0   Min.   :    0  \n 1st Qu.: 2200   1st Qu.: 240   1st Qu.:  460   1st Qu.: 2200  \n Median : 6810   Median : 720   Median : 1420   Median : 7030  \n Mean   :10487   Mean   :1033   Mean   : 2290   Mean   :10574  \n 3rd Qu.:15770   3rd Qu.:1500   3rd Qu.: 3260   3rd Qu.:15830  \n Max.   :74610   Max.   :6340   Max.   :16380   Max.   :74610  \n```\n:::\n:::\n\n\n## 3.3 Replace zero values with 0.99\nWe replace all zero values in the affected explanatory variables with 0.99.\n\n::: {.cell}\n\n```{.r .cell-code}\nSIM_data$DESTIN_AGE7_12 <- ifelse(\n  SIM_data$DESTIN_AGE7_12 == 0,\n  0.99, SIM_data$DESTIN_AGE7_12)\nSIM_data$DESTIN_AGE13_24 <- ifelse(\n  SIM_data$DESTIN_AGE13_24 == 0,\n  0.99, SIM_data$DESTIN_AGE13_24)\nSIM_data$DESTIN_AGE25_64 <- ifelse(\n  SIM_data$DESTIN_AGE25_64 == 0,\n  0.99, SIM_data$DESTIN_AGE25_64)\nSIM_data$ORIGIN_AGE7_12 <- ifelse(\n  SIM_data$ORIGIN_AGE7_12 == 0,\n  0.99, SIM_data$ORIGIN_AGE7_12)\nSIM_data$ORIGIN_AGE13_24 <- ifelse(\n  SIM_data$ORIGIN_AGE13_24 == 0,\n  0.99, SIM_data$ORIGIN_AGE13_24)\nSIM_data$ORIGIN_AGE25_64 <- ifelse(\n  SIM_data$ORIGIN_AGE25_64 == 0,\n  0.99, SIM_data$ORIGIN_AGE25_64)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(SIM_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  ORIGIN_SZ          DESTIN_SZ             TRIPS         FlowNoIntra      \n Length:14734       Length:14734       Min.   :     1   Min.   :     0.0  \n Class :character   Class :character   1st Qu.:    14   1st Qu.:    13.0  \n Mode  :character   Mode  :character   Median :    76   Median :    70.0  \n                                       Mean   :  1021   Mean   :   839.9  \n                                       3rd Qu.:   426   3rd Qu.:   379.0  \n                                       Max.   :232187   Max.   :148274.0  \n     offset              dist       ORIGIN_AGE7_12    ORIGIN_AGE13_24   \n Min.   :0.000001   Min.   :   50   Min.   :   0.99   Min.   :    0.99  \n 1st Qu.:1.000000   1st Qu.: 3346   1st Qu.: 240.00   1st Qu.:  440.00  \n Median :1.000000   Median : 6067   Median : 700.00   Median : 1350.00  \n Mean   :0.982150   Mean   : 6880   Mean   :1031.86   Mean   : 2268.84  \n 3rd Qu.:1.000000   3rd Qu.: 9729   3rd Qu.:1480.00   3rd Qu.: 3260.00  \n Max.   :1.000000   Max.   :26136   Max.   :6340.00   Max.   :16380.00  \n ORIGIN_AGE25_64    DESTIN_AGE7_12    DESTIN_AGE13_24    DESTIN_AGE25_64   \n Min.   :    0.99   Min.   :   0.99   Min.   :    0.99   Min.   :    0.99  \n 1st Qu.: 2200.00   1st Qu.: 240.00   1st Qu.:  460.00   1st Qu.: 2200.00  \n Median : 6810.00   Median : 720.00   Median : 1420.00   Median : 7030.00  \n Mean   :10487.62   Mean   :1033.40   Mean   : 2290.35   Mean   :10574.46  \n 3rd Qu.:15770.00   3rd Qu.:1500.00   3rd Qu.: 3260.00   3rd Qu.:15830.00  \n Max.   :74610.00   Max.   :6340.00   Max.   :16380.00   Max.   :74610.00  \n```\n:::\n:::\n\n\n## 3.4 Unconstrained SIM\nWe will calibrate an unconstrained SIM with the following explanatory variables:\n\n- Origin population by different age cohort\n- Destination population by different age cohort\n- Distance between origin and destination in kilometers\n\n::: panel-tabset\n### Calibrate model\n\n::: {.cell}\n\n```{.r .cell-code}\nuncSIM <- glm(formula = TRIPS ~ \n                log(ORIGIN_AGE7_12) + \n                log(DESTIN_AGE7_12) +\n                log(ORIGIN_AGE13_24) + \n                log(DESTIN_AGE13_24) +\n                log(ORIGIN_AGE25_64) + \n                log(DESTIN_AGE25_64) +\n                log(dist),\n              family = poisson(link = \"log\"),\n              data = SIM_data,\n              na.action = na.exclude)\nuncSIM\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:  glm(formula = TRIPS ~ log(ORIGIN_AGE7_12) + log(DESTIN_AGE7_12) + \n    log(ORIGIN_AGE13_24) + log(DESTIN_AGE13_24) + log(ORIGIN_AGE25_64) + \n    log(DESTIN_AGE25_64) + log(dist), family = poisson(link = \"log\"), \n    data = SIM_data, na.action = na.exclude)\n\nCoefficients:\n         (Intercept)   log(ORIGIN_AGE7_12)   log(DESTIN_AGE7_12)  \n             10.8165                0.2906                0.1211  \nlog(ORIGIN_AGE13_24)  log(DESTIN_AGE13_24)  log(ORIGIN_AGE25_64)  \n              0.8176                0.4314               -0.7111  \nlog(DESTIN_AGE25_64)             log(dist)  \n             -0.4464               -0.6860  \n\nDegrees of Freedom: 14733 Total (i.e. Null);  14726 Residual\nNull Deviance:\t    60800000 \nResidual Deviance: 34170000 \tAIC: 34260000\n```\n:::\n:::\n\n### R-squared value of model\nTo assess how much of the variation in trip counts is explained by the model, we define a function to calculate the R-squared value as follows:\n\n::: {.cell}\n\n```{.r .cell-code}\nCalcRSquared <- function(observed,estimated){\n  r <- cor(observed,estimated)\n  R2 <- r^2\n  R2\n}\n```\n:::\n\n\nThe R-squared value of the unconstrained SIM is 0.234.\n\n::: {.cell}\n\n```{.r .cell-code}\nCalcRSquared(uncSIM$data$TRIPS, uncSIM$fitted.values)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2342639\n```\n:::\n:::\n\n\nThe McFadden’s R-squared value of the SIM (a metric commonly used to evaluate the goodness-of-fit in logistic and Poisson regression models) is 0.437.\n\n::: {.cell}\n\n```{.r .cell-code}\nr2_mcfadden(uncSIM)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# R2 for Generalized Linear Regression\n       R2: 0.437\n  adj. R2: 0.437\n```\n:::\n:::\n\n:::\n\n## 3.5 Origin-constrained SIM\nWe calibrate an origin-constrained SIM as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\norcSIM <- glm(formula = TRIPS ~ \n                ORIGIN_SZ +\n                log(DESTIN_AGE7_12) +\n                log(DESTIN_AGE13_24) +\n                log(DESTIN_AGE25_64) +\n                log(dist),\n              family = poisson(link = \"log\"),\n              data = SIM_data,\n              na.action = na.exclude)\nsummary(orcSIM)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = TRIPS ~ ORIGIN_SZ + log(DESTIN_AGE7_12) + log(DESTIN_AGE13_24) + \n    log(DESTIN_AGE25_64) + log(dist), family = poisson(link = \"log\"), \n    data = SIM_data, na.action = na.exclude)\n\nCoefficients:\n                       Estimate Std. Error   z value Pr(>|z|)    \n(Intercept)          12.1209378  0.0037844  3202.854  < 2e-16 ***\nORIGIN_SZAMSZ02       1.0187838  0.0044504   228.922  < 2e-16 ***\nORIGIN_SZAMSZ03       0.5683555  0.0045632   124.552  < 2e-16 ***\nORIGIN_SZAMSZ04      -0.0550997  0.0051871   -10.622  < 2e-16 ***\nORIGIN_SZAMSZ05      -0.1860842  0.0057901   -32.138  < 2e-16 ***\nORIGIN_SZAMSZ06       0.4294345  0.0051305    83.702  < 2e-16 ***\nORIGIN_SZAMSZ07      -1.3869513  0.0096832  -143.233  < 2e-16 ***\nORIGIN_SZAMSZ08      -1.0276730  0.0089558  -114.749  < 2e-16 ***\nORIGIN_SZAMSZ09       0.2150720  0.0054086    39.765  < 2e-16 ***\nORIGIN_SZAMSZ10       0.4977037  0.0047166   105.521  < 2e-16 ***\nORIGIN_SZAMSZ11      -1.8750654  0.0128531  -145.884  < 2e-16 ***\nORIGIN_SZAMSZ12      -1.5898468  0.0107575  -147.790  < 2e-16 ***\nORIGIN_SZBDSZ01       1.0857331  0.0043451   249.877  < 2e-16 ***\nORIGIN_SZBDSZ02       0.5150350  0.0050794   101.397  < 2e-16 ***\nORIGIN_SZBDSZ03       0.9924296  0.0044897   221.047  < 2e-16 ***\nORIGIN_SZBDSZ04       1.7594689  0.0038945   451.778  < 2e-16 ***\nORIGIN_SZBDSZ05       0.6406152  0.0045458   140.924  < 2e-16 ***\nORIGIN_SZBDSZ06       0.9224346  0.0045432   203.035  < 2e-16 ***\nORIGIN_SZBDSZ07      -1.2313874  0.0095588  -128.822  < 2e-16 ***\nORIGIN_SZBDSZ08      -1.1530523  0.0090321  -127.662  < 2e-16 ***\nORIGIN_SZBKSZ01      -0.4695429  0.0065384   -71.813  < 2e-16 ***\nORIGIN_SZBKSZ02       0.3594066  0.0051157    70.255  < 2e-16 ***\nORIGIN_SZBKSZ03       0.6220903  0.0049347   126.064  < 2e-16 ***\nORIGIN_SZBKSZ04      -0.1296646  0.0059142   -21.924  < 2e-16 ***\nORIGIN_SZBKSZ05      -0.2303731  0.0058323   -39.499  < 2e-16 ***\nORIGIN_SZBKSZ06       0.0125256  0.0058730     2.133   0.0329 *  \nORIGIN_SZBKSZ07       0.7273948  0.0044270   164.307  < 2e-16 ***\nORIGIN_SZBKSZ08      -0.0027694  0.0053490    -0.518   0.6046    \nORIGIN_SZBKSZ09      -0.1100106  0.0057215   -19.228  < 2e-16 ***\nORIGIN_SZBLSZ01      -1.7371433  0.0148179  -117.233  < 2e-16 ***\nORIGIN_SZBLSZ02      -2.1984262  0.0192395  -114.266  < 2e-16 ***\nORIGIN_SZBLSZ03      -3.2985270  0.0393023   -83.927  < 2e-16 ***\nORIGIN_SZBLSZ04      -2.2535624  0.0230581   -97.734  < 2e-16 ***\nORIGIN_SZBMSZ01      -0.0719379  0.0052227   -13.774  < 2e-16 ***\nORIGIN_SZBMSZ02      -1.0077791  0.0067432  -149.452  < 2e-16 ***\nORIGIN_SZBMSZ03      -0.3856771  0.0057944   -66.560  < 2e-16 ***\nORIGIN_SZBMSZ04       0.0077432  0.0051593     1.501   0.1334    \nORIGIN_SZBMSZ05      -2.2081774  0.0124686  -177.098  < 2e-16 ***\nORIGIN_SZBMSZ06      -2.2438352  0.0161793  -138.685  < 2e-16 ***\nORIGIN_SZBMSZ07      -0.4307340  0.0056542   -76.179  < 2e-16 ***\nORIGIN_SZBMSZ08      -0.5018691  0.0058124   -86.344  < 2e-16 ***\nORIGIN_SZBMSZ09      -1.1512938  0.0086892  -132.498  < 2e-16 ***\nORIGIN_SZBMSZ10      -1.3694760  0.0091320  -149.964  < 2e-16 ***\nORIGIN_SZBMSZ11      -0.7137687  0.0065970  -108.196  < 2e-16 ***\nORIGIN_SZBMSZ12      -0.9607730  0.0091520  -104.980  < 2e-16 ***\nORIGIN_SZBMSZ13      -0.0263432  0.0056935    -4.627 3.71e-06 ***\nORIGIN_SZBMSZ14      -0.4330847  0.0066331   -65.292  < 2e-16 ***\nORIGIN_SZBMSZ15      -0.2319806  0.0060570   -38.299  < 2e-16 ***\nORIGIN_SZBMSZ16      -1.4825258  0.0091453  -162.107  < 2e-16 ***\nORIGIN_SZBMSZ17      -2.1459696  0.0157582  -136.181  < 2e-16 ***\nORIGIN_SZBPSZ01       0.1156815  0.0055531    20.832  < 2e-16 ***\nORIGIN_SZBPSZ02      -0.0741048  0.0064631   -11.466  < 2e-16 ***\nORIGIN_SZBPSZ03       0.1167847  0.0061504    18.988  < 2e-16 ***\nORIGIN_SZBPSZ04       0.3474867  0.0050839    68.350  < 2e-16 ***\nORIGIN_SZBPSZ05       0.5308027  0.0045543   116.550  < 2e-16 ***\nORIGIN_SZBPSZ06      -1.4100989  0.0093113  -151.440  < 2e-16 ***\nORIGIN_SZBPSZ07      -1.0089222  0.0085753  -117.654  < 2e-16 ***\nORIGIN_SZBSSZ01      -0.0108455  0.0052757    -2.056   0.0398 *  \nORIGIN_SZBSSZ02       0.3139191  0.0047875    65.570  < 2e-16 ***\nORIGIN_SZBSSZ03       0.2733735  0.0046890    58.302  < 2e-16 ***\nORIGIN_SZBTSZ01      -0.0699347  0.0053853   -12.986  < 2e-16 ***\nORIGIN_SZBTSZ02      -1.0635587  0.0077970  -136.405  < 2e-16 ***\nORIGIN_SZBTSZ03      -0.2621867  0.0057277   -45.775  < 2e-16 ***\nORIGIN_SZBTSZ04      -1.0648632  0.0101890  -104.511  < 2e-16 ***\nORIGIN_SZBTSZ05      -1.6468606  0.0110013  -149.697  < 2e-16 ***\nORIGIN_SZBTSZ06      -0.8059153  0.0071811  -112.228  < 2e-16 ***\nORIGIN_SZBTSZ07      -2.2721680  0.0132102  -172.001  < 2e-16 ***\nORIGIN_SZBTSZ08      -1.2775355  0.0093948  -135.983  < 2e-16 ***\nORIGIN_SZCBSZ01      -1.9468532  0.0548336   -35.505  < 2e-16 ***\nORIGIN_SZCCSZ01      -1.7856729  0.0133115  -134.145  < 2e-16 ***\nORIGIN_SZCHSZ01      -1.0003449  0.0117996   -84.778  < 2e-16 ***\nORIGIN_SZCHSZ02      -0.4972406  0.0079404   -62.622  < 2e-16 ***\nORIGIN_SZCHSZ03       0.3958020  0.0058418    67.753  < 2e-16 ***\nORIGIN_SZCKSZ01       0.1577865  0.0051180    30.830  < 2e-16 ***\nORIGIN_SZCKSZ02       0.6382508  0.0050885   125.430  < 2e-16 ***\nORIGIN_SZCKSZ03       0.7558740  0.0045236   167.094  < 2e-16 ***\nORIGIN_SZCKSZ04       1.2463598  0.0045636   273.108  < 2e-16 ***\nORIGIN_SZCKSZ05       0.9055034  0.0053128   170.437  < 2e-16 ***\nORIGIN_SZCKSZ06       1.1556716  0.0050486   228.911  < 2e-16 ***\nORIGIN_SZCLSZ01      -0.7060065  0.0076614   -92.151  < 2e-16 ***\nORIGIN_SZCLSZ02      -1.8140877  0.0136423  -132.975  < 2e-16 ***\nORIGIN_SZCLSZ03      -1.0109639  0.0079490  -127.181  < 2e-16 ***\nORIGIN_SZCLSZ04       0.7095453  0.0044600   159.092  < 2e-16 ***\nORIGIN_SZCLSZ05      -1.9619359  0.0147402  -133.101  < 2e-16 ***\nORIGIN_SZCLSZ06       0.8620589  0.0042038   205.065  < 2e-16 ***\nORIGIN_SZCLSZ07      -0.2998150  0.0055762   -53.767  < 2e-16 ***\nORIGIN_SZCLSZ08       0.3414354  0.0058028    58.840  < 2e-16 ***\nORIGIN_SZCLSZ09      -1.7219806  0.0155521  -110.723  < 2e-16 ***\nORIGIN_SZDTSZ02      -3.9272928  0.0834098   -47.084  < 2e-16 ***\nORIGIN_SZDTSZ03      -3.9389954  0.0738072   -53.369  < 2e-16 ***\nORIGIN_SZDTSZ13      -2.9461670  0.0312869   -94.166  < 2e-16 ***\nORIGIN_SZGLSZ01      -1.3996966  0.0091924  -152.267  < 2e-16 ***\nORIGIN_SZGLSZ02       0.2815576  0.0048888    57.592  < 2e-16 ***\nORIGIN_SZGLSZ03       0.2733219  0.0048555    56.291  < 2e-16 ***\nORIGIN_SZGLSZ04       0.8707052  0.0042000   207.312  < 2e-16 ***\nORIGIN_SZGLSZ05       0.6317012  0.0043754   144.376  < 2e-16 ***\nORIGIN_SZHGSZ01       0.2906030  0.0047461    61.230  < 2e-16 ***\nORIGIN_SZHGSZ02       0.4788240  0.0047122   101.615  < 2e-16 ***\nORIGIN_SZHGSZ03       0.2555574  0.0051134    49.978  < 2e-16 ***\nORIGIN_SZHGSZ04       0.9087384  0.0043033   211.171  < 2e-16 ***\nORIGIN_SZHGSZ05       1.1511138  0.0042539   270.602  < 2e-16 ***\nORIGIN_SZHGSZ06      -0.1086696  0.0054130   -20.076  < 2e-16 ***\nORIGIN_SZHGSZ07       0.6938958  0.0044553   155.746  < 2e-16 ***\nORIGIN_SZHGSZ08       0.1013003  0.0053537    18.922  < 2e-16 ***\nORIGIN_SZHGSZ09      -0.5643866  0.0069627   -81.058  < 2e-16 ***\nORIGIN_SZHGSZ10      -3.5568988  0.0421146   -84.458  < 2e-16 ***\nORIGIN_SZJESZ01       0.3884172  0.0048694    79.766  < 2e-16 ***\nORIGIN_SZJESZ02       0.2229854  0.0049245    45.281  < 2e-16 ***\nORIGIN_SZJESZ03       0.1749558  0.0052879    33.086  < 2e-16 ***\nORIGIN_SZJESZ04      -0.9992402  0.0091447  -109.270  < 2e-16 ***\nORIGIN_SZJESZ05      -2.0565379  0.0138164  -148.848  < 2e-16 ***\nORIGIN_SZJESZ06       0.2846112  0.0048635    58.520  < 2e-16 ***\nORIGIN_SZJESZ07      -1.9055953  0.0118336  -161.032  < 2e-16 ***\nORIGIN_SZJESZ08      -1.0712086  0.0114719   -93.376  < 2e-16 ***\nORIGIN_SZJESZ09       0.5213418  0.0049596   105.117  < 2e-16 ***\nORIGIN_SZJESZ10      -1.8678483  0.0179990  -103.775  < 2e-16 ***\nORIGIN_SZJESZ11      -2.0531200  0.0193105  -106.321  < 2e-16 ***\nORIGIN_SZJWSZ01       0.1757580  0.0064058    27.437  < 2e-16 ***\nORIGIN_SZJWSZ02       0.8615814  0.0045219   190.537  < 2e-16 ***\nORIGIN_SZJWSZ03       1.2436554  0.0041883   296.936  < 2e-16 ***\nORIGIN_SZJWSZ04       1.2695751  0.0042803   296.611  < 2e-16 ***\nORIGIN_SZJWSZ05      -1.4401318  0.0125157  -115.066  < 2e-16 ***\nORIGIN_SZJWSZ06      -1.0717271  0.0106704  -100.439  < 2e-16 ***\nORIGIN_SZJWSZ07      -2.7512270  0.0275134   -99.996  < 2e-16 ***\nORIGIN_SZJWSZ08       1.8682135  0.0041149   454.017  < 2e-16 ***\nORIGIN_SZJWSZ09       1.7847006  0.0039011   457.486  < 2e-16 ***\nORIGIN_SZKLSZ01       0.1995591  0.0049023    40.707  < 2e-16 ***\nORIGIN_SZKLSZ02      -0.4523335  0.0063224   -71.545  < 2e-16 ***\nORIGIN_SZKLSZ03      -0.3595233  0.0059501   -60.423  < 2e-16 ***\nORIGIN_SZKLSZ04      -2.1912270  0.0118737  -184.544  < 2e-16 ***\nORIGIN_SZKLSZ05      -0.7904405  0.0082724   -95.552  < 2e-16 ***\nORIGIN_SZKLSZ06      -4.5781225  0.1857303   -24.649  < 2e-16 ***\nORIGIN_SZKLSZ07      -1.0553296  0.0084090  -125.500  < 2e-16 ***\nORIGIN_SZKLSZ08      -1.4333180  0.0091526  -156.602  < 2e-16 ***\nORIGIN_SZLKSZ01      -3.3183770  0.0387450   -85.647  < 2e-16 ***\nORIGIN_SZMDSZ01      -2.6480242  0.0280231   -94.494  < 2e-16 ***\nORIGIN_SZMDSZ02      -0.9531449  0.0103551   -92.046  < 2e-16 ***\nORIGIN_SZMDSZ03      -2.0097262  0.0170309  -118.005  < 2e-16 ***\nORIGIN_SZMPSZ01      -1.0632250  0.0083675  -127.066  < 2e-16 ***\nORIGIN_SZMPSZ02      -0.5590933  0.0068986   -81.044  < 2e-16 ***\nORIGIN_SZMPSZ03       0.0125385  0.0053192     2.357   0.0184 *  \nORIGIN_SZMUSZ02      -3.8374234  0.1037565   -36.985  < 2e-16 ***\nORIGIN_SZNTSZ01      -2.8373583  0.0352949   -80.390  < 2e-16 ***\nORIGIN_SZNTSZ02      -3.1538933  0.0232290  -135.774  < 2e-16 ***\nORIGIN_SZNTSZ03      -0.8515395  0.0077806  -109.443  < 2e-16 ***\nORIGIN_SZNTSZ05      -3.2637875  0.0496355   -65.755  < 2e-16 ***\nORIGIN_SZNTSZ06      -3.7496896  0.0557554   -67.252  < 2e-16 ***\nORIGIN_SZNVSZ01       0.4959413  0.0044827   110.635  < 2e-16 ***\nORIGIN_SZNVSZ02      -0.5530790  0.0064719   -85.459  < 2e-16 ***\nORIGIN_SZNVSZ03      -1.1862516  0.0077877  -152.323  < 2e-16 ***\nORIGIN_SZNVSZ04      -1.4642910  0.0090910  -161.070  < 2e-16 ***\nORIGIN_SZNVSZ05      -2.5864659  0.0157862  -163.844  < 2e-16 ***\nORIGIN_SZPGSZ01      -0.7885243  0.0122311   -64.469  < 2e-16 ***\nORIGIN_SZPGSZ02      -0.5217885  0.0072345   -72.125  < 2e-16 ***\nORIGIN_SZPGSZ03       0.9421480  0.0044396   212.214  < 2e-16 ***\nORIGIN_SZPGSZ04       1.0450387  0.0044216   236.346  < 2e-16 ***\nORIGIN_SZPGSZ05       0.2263192  0.0057633    39.269  < 2e-16 ***\nORIGIN_SZPLSZ01      -0.8480823  0.0104369   -81.258  < 2e-16 ***\nORIGIN_SZPLSZ02      -1.7175782  0.0147790  -116.218  < 2e-16 ***\nORIGIN_SZPLSZ03      -2.9936592  0.0367204   -81.526  < 2e-16 ***\nORIGIN_SZPLSZ04      -3.3026314  0.0368383   -89.652  < 2e-16 ***\nORIGIN_SZPLSZ05      -2.4897914  0.0224504  -110.902  < 2e-16 ***\nORIGIN_SZPNSZ01       1.3589692  0.0045842   296.448  < 2e-16 ***\nORIGIN_SZPNSZ02      -0.5485444  0.0110824   -49.497  < 2e-16 ***\nORIGIN_SZPNSZ03      -1.9287895  0.0194002   -99.421  < 2e-16 ***\nORIGIN_SZPNSZ04      -2.8062198  0.0311201   -90.174  < 2e-16 ***\nORIGIN_SZPNSZ05      -2.3203138  0.0262763   -88.305  < 2e-16 ***\nORIGIN_SZPRSZ01      -0.8321444  0.0114154   -72.897  < 2e-16 ***\nORIGIN_SZPRSZ02       0.8980816  0.0046165   194.538  < 2e-16 ***\nORIGIN_SZPRSZ03       0.7532873  0.0046266   162.816  < 2e-16 ***\nORIGIN_SZPRSZ04      -0.3757327  0.0075164   -49.989  < 2e-16 ***\nORIGIN_SZPRSZ05       1.2817237  0.0043273   296.193  < 2e-16 ***\nORIGIN_SZPRSZ06      -0.4042531  0.0086514   -46.727  < 2e-16 ***\nORIGIN_SZPRSZ07      -2.1300641  0.0161047  -132.264  < 2e-16 ***\nORIGIN_SZPRSZ08      -0.0102792  0.0063830    -1.610   0.1073    \nORIGIN_SZQTSZ01      -0.3187953  0.0068482   -46.552  < 2e-16 ***\nORIGIN_SZQTSZ02      -0.7542760  0.0063275  -119.207  < 2e-16 ***\nORIGIN_SZQTSZ03      -0.1674438  0.0056836   -29.461  < 2e-16 ***\nORIGIN_SZQTSZ04      -0.9784607  0.0071297  -137.237  < 2e-16 ***\nORIGIN_SZQTSZ05      -0.3031218  0.0059964   -50.550  < 2e-16 ***\nORIGIN_SZQTSZ06      -0.5162679  0.0064822   -79.644  < 2e-16 ***\nORIGIN_SZQTSZ07      -1.3977412  0.0096370  -145.039  < 2e-16 ***\nORIGIN_SZQTSZ08      -0.0641033  0.0057007   -11.245  < 2e-16 ***\nORIGIN_SZQTSZ09      -0.6332869  0.0066340   -95.461  < 2e-16 ***\nORIGIN_SZQTSZ10      -0.4798813  0.0065145   -73.663  < 2e-16 ***\nORIGIN_SZQTSZ11      -1.7680890  0.0098789  -178.977  < 2e-16 ***\nORIGIN_SZQTSZ12      -1.4664096  0.0104393  -140.471  < 2e-16 ***\nORIGIN_SZQTSZ13      -0.3321663  0.0064150   -51.780  < 2e-16 ***\nORIGIN_SZQTSZ14      -1.5411842  0.0098475  -156.505  < 2e-16 ***\nORIGIN_SZQTSZ15      -0.9795208  0.0102743   -95.337  < 2e-16 ***\nORIGIN_SZRCSZ01      -1.3230264  0.0126536  -104.557  < 2e-16 ***\nORIGIN_SZRCSZ06      -0.5882674  0.0084750   -69.412  < 2e-16 ***\nORIGIN_SZRVSZ01      -3.4226656  0.0323717  -105.730  < 2e-16 ***\nORIGIN_SZRVSZ02      -2.7988845  0.0277647  -100.807  < 2e-16 ***\nORIGIN_SZRVSZ03      -3.0305951  0.0237875  -127.403  < 2e-16 ***\nORIGIN_SZRVSZ04      -3.2779444  0.0556701   -58.882  < 2e-16 ***\nORIGIN_SZRVSZ05      -2.2791731  0.0164437  -138.605  < 2e-16 ***\nORIGIN_SZSBSZ01       0.6341692  0.0055297   114.685  < 2e-16 ***\nORIGIN_SZSBSZ02      -0.7238164  0.0082129   -88.132  < 2e-16 ***\nORIGIN_SZSBSZ03       0.9114552  0.0046127   197.597  < 2e-16 ***\nORIGIN_SZSBSZ04       0.6858447  0.0052926   129.587  < 2e-16 ***\nORIGIN_SZSBSZ05      -0.1301508  0.0065439   -19.889  < 2e-16 ***\nORIGIN_SZSBSZ06      -1.7360445  0.0171922  -100.979  < 2e-16 ***\nORIGIN_SZSBSZ07      -1.1789839  0.0125568   -93.892  < 2e-16 ***\nORIGIN_SZSBSZ08      -1.2426128  0.0122175  -101.707  < 2e-16 ***\nORIGIN_SZSBSZ09      -0.6467589  0.0085797   -75.382  < 2e-16 ***\nORIGIN_SZSESZ02       0.9437017  0.0044111   213.936  < 2e-16 ***\nORIGIN_SZSESZ03       1.1729037  0.0041655   281.575  < 2e-16 ***\nORIGIN_SZSESZ04       0.7654128  0.0048718   157.110  < 2e-16 ***\nORIGIN_SZSESZ05      -0.2294461  0.0059158   -38.785  < 2e-16 ***\nORIGIN_SZSESZ06       0.6975898  0.0046912   148.702  < 2e-16 ***\nORIGIN_SZSESZ07      -2.5700065  0.0196084  -131.067  < 2e-16 ***\nORIGIN_SZSGSZ01      -1.0544617  0.0085507  -123.319  < 2e-16 ***\nORIGIN_SZSGSZ02      -1.1336073  0.0095894  -118.214  < 2e-16 ***\nORIGIN_SZSGSZ03       0.2011727  0.0051675    38.930  < 2e-16 ***\nORIGIN_SZSGSZ04       0.2624590  0.0047915    54.776  < 2e-16 ***\nORIGIN_SZSGSZ05      -1.7768714  0.0105974  -167.671  < 2e-16 ***\nORIGIN_SZSGSZ06       0.4199408  0.0045407    92.483  < 2e-16 ***\nORIGIN_SZSGSZ07      -0.6068962  0.0062347   -97.342  < 2e-16 ***\nORIGIN_SZSKSZ01      -0.2113948  0.0077648   -27.225  < 2e-16 ***\nORIGIN_SZSKSZ02       0.5327488  0.0056933    93.574  < 2e-16 ***\nORIGIN_SZSKSZ03      -0.7103912  0.0079832   -88.986  < 2e-16 ***\nORIGIN_SZSKSZ04      -2.5754920  0.0270186   -95.323  < 2e-16 ***\nORIGIN_SZSKSZ05      -1.4178945  0.0155167   -91.379  < 2e-16 ***\nORIGIN_SZSLSZ01      -3.2481927  0.0305825  -106.211  < 2e-16 ***\nORIGIN_SZSLSZ04      -0.6891163  0.0076938   -89.568  < 2e-16 ***\nORIGIN_SZSRSZ01      -2.2351063  0.0158286  -141.207  < 2e-16 ***\nORIGIN_SZTHSZ01      -2.2503101  0.0488674   -46.049  < 2e-16 ***\nORIGIN_SZTHSZ03      -2.2773119  0.0224274  -101.542  < 2e-16 ***\nORIGIN_SZTHSZ04      -2.0423201  0.0286889   -71.189  < 2e-16 ***\nORIGIN_SZTHSZ06      -2.2955290  0.0178414  -128.663  < 2e-16 ***\nORIGIN_SZTMSZ01       0.4824051  0.0058158    82.948  < 2e-16 ***\nORIGIN_SZTMSZ02       2.1911756  0.0037956   577.295  < 2e-16 ***\nORIGIN_SZTMSZ03       1.3958381  0.0041089   339.712  < 2e-16 ***\nORIGIN_SZTMSZ04       0.9023632  0.0047421   190.286  < 2e-16 ***\nORIGIN_SZTMSZ05      -0.2645831  0.0075358   -35.110  < 2e-16 ***\nORIGIN_SZTNSZ01      -1.7828391  0.0103757  -171.829  < 2e-16 ***\nORIGIN_SZTNSZ02      -1.6482997  0.0097794  -168.548  < 2e-16 ***\nORIGIN_SZTNSZ03      -2.1974006  0.0133771  -164.266  < 2e-16 ***\nORIGIN_SZTNSZ04      -0.7492096  0.0071974  -104.094  < 2e-16 ***\nORIGIN_SZTPSZ01      -0.5842570  0.0062883   -92.912  < 2e-16 ***\nORIGIN_SZTPSZ02       0.5020483  0.0043476   115.476  < 2e-16 ***\nORIGIN_SZTPSZ03      -0.4998092  0.0060847   -82.141  < 2e-16 ***\nORIGIN_SZTPSZ04      -0.2388066  0.0057798   -41.317  < 2e-16 ***\nORIGIN_SZTPSZ05      -0.1520051  0.0060743   -25.024  < 2e-16 ***\nORIGIN_SZTPSZ06       0.4095248  0.0059459    68.875  < 2e-16 ***\nORIGIN_SZTPSZ07      -0.1762519  0.0063193   -27.891  < 2e-16 ***\nORIGIN_SZTPSZ08      -1.0247450  0.0091101  -112.484  < 2e-16 ***\nORIGIN_SZTPSZ09      -0.3187897  0.0061903   -51.498  < 2e-16 ***\nORIGIN_SZTPSZ10      -0.6488288  0.0076354   -84.976  < 2e-16 ***\nORIGIN_SZTPSZ11       0.1463240  0.0054609    26.795  < 2e-16 ***\nORIGIN_SZTPSZ12      -0.5602149  0.0065225   -85.889  < 2e-16 ***\nORIGIN_SZTSSZ01      -3.5581922  0.0473866   -75.089  < 2e-16 ***\nORIGIN_SZTSSZ02       0.2507171  0.0073339    34.186  < 2e-16 ***\nORIGIN_SZTSSZ03       0.3189859  0.0070725    45.102  < 2e-16 ***\nORIGIN_SZTSSZ04       0.3148947  0.0074623    42.198  < 2e-16 ***\nORIGIN_SZTSSZ05      -1.1475836  0.0140359   -81.760  < 2e-16 ***\nORIGIN_SZTSSZ06      -1.3520272  0.0171764   -78.714  < 2e-16 ***\nORIGIN_SZWCSZ01      -0.1244050  0.0078600   -15.828  < 2e-16 ***\nORIGIN_SZWCSZ02      -2.9222918  0.0315944   -92.494  < 2e-16 ***\nORIGIN_SZWCSZ03      -4.2194432  0.1240860   -34.004  < 2e-16 ***\nORIGIN_SZWDSZ01       1.3310700  0.0041463   321.028  < 2e-16 ***\nORIGIN_SZWDSZ02       0.9453630  0.0047521   198.934  < 2e-16 ***\nORIGIN_SZWDSZ03       2.0578468  0.0040469   508.495  < 2e-16 ***\nORIGIN_SZWDSZ04       1.0164885  0.0049713   204.471  < 2e-16 ***\nORIGIN_SZWDSZ05       0.4654287  0.0049999    93.087  < 2e-16 ***\nORIGIN_SZWDSZ06       1.1591226  0.0046126   251.292  < 2e-16 ***\nORIGIN_SZWDSZ07      -0.4168250  0.0080345   -51.879  < 2e-16 ***\nORIGIN_SZWDSZ08      -0.5361245  0.0078779   -68.054  < 2e-16 ***\nORIGIN_SZWDSZ09       1.4544589  0.0044030   330.337  < 2e-16 ***\nORIGIN_SZYSSZ01      -0.1372251  0.0056434   -24.316  < 2e-16 ***\nORIGIN_SZYSSZ02       0.8831289  0.0049730   177.584  < 2e-16 ***\nORIGIN_SZYSSZ03       1.7332402  0.0042770   405.250  < 2e-16 ***\nORIGIN_SZYSSZ04       0.8404561  0.0045384   185.186  < 2e-16 ***\nORIGIN_SZYSSZ05      -0.1120440  0.0059210   -18.923  < 2e-16 ***\nORIGIN_SZYSSZ06      -1.1650420  0.0107940  -107.934  < 2e-16 ***\nORIGIN_SZYSSZ07      -1.1647600  0.0112679  -103.370  < 2e-16 ***\nORIGIN_SZYSSZ08       0.0521578  0.0061045     8.544  < 2e-16 ***\nORIGIN_SZYSSZ09       1.3640045  0.0042393   321.750  < 2e-16 ***\nlog(DESTIN_AGE7_12)   0.0310508  0.0005469    56.778  < 2e-16 ***\nlog(DESTIN_AGE13_24)  0.3696152  0.0008476   436.066  < 2e-16 ***\nlog(DESTIN_AGE25_64) -0.3156201  0.0007399  -426.552  < 2e-16 ***\nlog(dist)            -0.6877846  0.0001306 -5266.858  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 60796037  on 14733  degrees of freedom\nResidual deviance: 26504448  on 14451  degrees of freedom\nAIC: 26596641\n\nNumber of Fisher Scoring iterations: 7\n```\n:::\n:::\n\nThe R-squared value of the origin-constrained SIM is 0.425.\n\n::: {.cell}\n\n```{.r .cell-code}\nCalcRSquared(orcSIM$data$TRIPS, orcSIM$fitted.values)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.4245111\n```\n:::\n:::\n\n\n## 3.6 Destination-constrained SIM\nWe calibrate a destination-constrained SIM as follows:\n\n::: {.cell}\n\n```{.r .cell-code}\ndecSIM <- glm(formula = TRIPS ~ \n                DESTIN_SZ + \n                log(ORIGIN_AGE7_12) + \n                log(ORIGIN_AGE13_24) + \n                log(ORIGIN_AGE25_64) + \n                log(dist),\n              family = poisson(link = \"log\"),\n              data = SIM_data,\n              na.action = na.exclude)\nsummary(decSIM)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = TRIPS ~ DESTIN_SZ + log(ORIGIN_AGE7_12) + log(ORIGIN_AGE13_24) + \n    log(ORIGIN_AGE25_64) + log(dist), family = poisson(link = \"log\"), \n    data = SIM_data, na.action = na.exclude)\n\nCoefficients:\n                       Estimate Std. Error   z value Pr(>|z|)    \n(Intercept)          11.0720649  0.0033387  3316.311  < 2e-16 ***\nDESTIN_SZAMSZ02       0.1852968  0.0041527    44.621  < 2e-16 ***\nDESTIN_SZAMSZ03       0.2128031  0.0040885    52.049  < 2e-16 ***\nDESTIN_SZAMSZ04      -0.8972995  0.0060638  -147.976  < 2e-16 ***\nDESTIN_SZAMSZ05      -1.1339418  0.0061804  -183.473  < 2e-16 ***\nDESTIN_SZAMSZ06      -0.8487725  0.0059244  -143.267  < 2e-16 ***\nDESTIN_SZAMSZ07      -1.8066517  0.0096073  -188.049  < 2e-16 ***\nDESTIN_SZAMSZ08      -1.0799461  0.0067767  -159.362  < 2e-16 ***\nDESTIN_SZAMSZ09      -0.9952558  0.0060438  -164.673  < 2e-16 ***\nDESTIN_SZAMSZ10       0.2201892  0.0043741    50.340  < 2e-16 ***\nDESTIN_SZAMSZ11      -0.4349092  0.0086213   -50.446  < 2e-16 ***\nDESTIN_SZAMSZ12       0.0158986  0.0049856     3.189  0.00143 ** \nDESTIN_SZBDSZ01       0.5117016  0.0037830   135.263  < 2e-16 ***\nDESTIN_SZBDSZ02      -0.3307180  0.0049527   -66.775  < 2e-16 ***\nDESTIN_SZBDSZ03      -0.0232998  0.0042692    -5.458 4.83e-08 ***\nDESTIN_SZBDSZ04       0.9540570  0.0034477   276.724  < 2e-16 ***\nDESTIN_SZBDSZ05       0.3392867  0.0039002    86.992  < 2e-16 ***\nDESTIN_SZBDSZ06       0.1597645  0.0042193    37.865  < 2e-16 ***\nDESTIN_SZBDSZ07      -1.0478710  0.0092938  -112.750  < 2e-16 ***\nDESTIN_SZBDSZ08      -1.8110923  0.0105724  -171.305  < 2e-16 ***\nDESTIN_SZBKSZ01      -1.2422949  0.0065586  -189.415  < 2e-16 ***\nDESTIN_SZBKSZ02      -0.2862891  0.0052053   -55.000  < 2e-16 ***\nDESTIN_SZBKSZ03      -0.5531058  0.0055616   -99.451  < 2e-16 ***\nDESTIN_SZBKSZ04      -0.0780893  0.0048278   -16.175  < 2e-16 ***\nDESTIN_SZBKSZ05      -0.8894679  0.0057113  -155.739  < 2e-16 ***\nDESTIN_SZBKSZ06      -0.8735113  0.0060936  -143.349  < 2e-16 ***\nDESTIN_SZBKSZ07       0.2008727  0.0040341    49.794  < 2e-16 ***\nDESTIN_SZBKSZ08      -1.1080882  0.0068759  -161.155  < 2e-16 ***\nDESTIN_SZBKSZ09      -0.3079773  0.0049065   -62.769  < 2e-16 ***\nDESTIN_SZBLSZ01      -0.5623349  0.0070249   -80.049  < 2e-16 ***\nDESTIN_SZBLSZ02       0.4534757  0.0065229    69.520  < 2e-16 ***\nDESTIN_SZBLSZ03       1.0664524  0.0074195   143.736  < 2e-16 ***\nDESTIN_SZBLSZ04      -0.3209662  0.0131597   -24.390  < 2e-16 ***\nDESTIN_SZBMSZ01      -0.2698406  0.0046919   -57.512  < 2e-16 ***\nDESTIN_SZBMSZ02      -0.4965536  0.0048849  -101.651  < 2e-16 ***\nDESTIN_SZBMSZ03      -0.7906801  0.0056859  -139.061  < 2e-16 ***\nDESTIN_SZBMSZ04      -0.4284013  0.0048904   -87.601  < 2e-16 ***\nDESTIN_SZBMSZ05      -0.4199940  0.0065983   -63.652  < 2e-16 ***\nDESTIN_SZBMSZ06      -1.9147547  0.0123063  -155.591  < 2e-16 ***\nDESTIN_SZBMSZ07      -0.2265615  0.0045297   -50.017  < 2e-16 ***\nDESTIN_SZBMSZ08      -1.1619546  0.0062636  -185.509  < 2e-16 ***\nDESTIN_SZBMSZ09      -2.6442887  0.0143545  -184.213  < 2e-16 ***\nDESTIN_SZBMSZ10      -1.7643824  0.0089290  -197.602  < 2e-16 ***\nDESTIN_SZBMSZ11      -1.5842892  0.0079304  -199.774  < 2e-16 ***\nDESTIN_SZBMSZ12      -1.0167052  0.0077744  -130.776  < 2e-16 ***\nDESTIN_SZBMSZ13      -0.4371753  0.0050839   -85.991  < 2e-16 ***\nDESTIN_SZBMSZ14      -0.9577515  0.0076374  -125.403  < 2e-16 ***\nDESTIN_SZBMSZ15      -1.0854212  0.0068710  -157.972  < 2e-16 ***\nDESTIN_SZBMSZ16      -2.2953368  0.0107911  -212.707  < 2e-16 ***\nDESTIN_SZBMSZ17      -2.6322277  0.0164773  -159.749  < 2e-16 ***\nDESTIN_SZBPSZ01      -0.7101053  0.0054624  -129.998  < 2e-16 ***\nDESTIN_SZBPSZ02      -1.5474896  0.0083287  -185.803  < 2e-16 ***\nDESTIN_SZBPSZ03      -1.1611407  0.0075123  -154.565  < 2e-16 ***\nDESTIN_SZBPSZ04      -0.7028609  0.0058078  -121.020  < 2e-16 ***\nDESTIN_SZBPSZ05       0.2754829  0.0039525    69.699  < 2e-16 ***\nDESTIN_SZBPSZ06      -1.0077024  0.0077403  -130.189  < 2e-16 ***\nDESTIN_SZBPSZ07      -0.7413012  0.0077771   -95.319  < 2e-16 ***\nDESTIN_SZBSSZ01      -0.3194362  0.0045804   -69.739  < 2e-16 ***\nDESTIN_SZBSSZ02      -0.7820187  0.0051078  -153.102  < 2e-16 ***\nDESTIN_SZBSSZ03       0.2033281  0.0038255    53.151  < 2e-16 ***\nDESTIN_SZBTSZ01       0.0302978  0.0041594     7.284 3.23e-13 ***\nDESTIN_SZBTSZ02      -0.8721155  0.0065666  -132.810  < 2e-16 ***\nDESTIN_SZBTSZ03      -0.2200433  0.0047958   -45.882  < 2e-16 ***\nDESTIN_SZBTSZ04      -1.8039520  0.0103713  -173.938  < 2e-16 ***\nDESTIN_SZBTSZ05      -0.8947709  0.0067421  -132.714  < 2e-16 ***\nDESTIN_SZBTSZ06      -0.8364293  0.0059757  -139.972  < 2e-16 ***\nDESTIN_SZBTSZ07      -2.0772780  0.0105603  -196.705  < 2e-16 ***\nDESTIN_SZBTSZ08      -1.3236499  0.0086834  -152.434  < 2e-16 ***\nDESTIN_SZCBSZ01      -4.8301319  0.3162418   -15.274  < 2e-16 ***\nDESTIN_SZCCSZ01      -1.0207882  0.0080154  -127.353  < 2e-16 ***\nDESTIN_SZCHSZ01      -1.0389616  0.0095291  -109.030  < 2e-16 ***\nDESTIN_SZCHSZ02       0.0656864  0.0052279    12.565  < 2e-16 ***\nDESTIN_SZCHSZ03       1.3924466  0.0039118   355.956  < 2e-16 ***\nDESTIN_SZCKSZ01      -0.2127434  0.0047578   -44.715  < 2e-16 ***\nDESTIN_SZCKSZ02      -0.5167632  0.0051559  -100.227  < 2e-16 ***\nDESTIN_SZCKSZ03       0.5383421  0.0038672   139.207  < 2e-16 ***\nDESTIN_SZCKSZ04      -0.7282445  0.0059886  -121.605  < 2e-16 ***\nDESTIN_SZCKSZ05      -0.6074140  0.0065447   -92.810  < 2e-16 ***\nDESTIN_SZCKSZ06       0.4961340  0.0045254   109.634  < 2e-16 ***\nDESTIN_SZCLSZ01       0.3122676  0.0047425    65.845  < 2e-16 ***\nDESTIN_SZCLSZ02      -2.3030933  0.0133374  -172.679  < 2e-16 ***\nDESTIN_SZCLSZ03      -1.0832335  0.0076555  -141.497  < 2e-16 ***\nDESTIN_SZCLSZ04      -0.1319656  0.0044889   -29.398  < 2e-16 ***\nDESTIN_SZCLSZ05      -1.3767449  0.0084080  -163.742  < 2e-16 ***\nDESTIN_SZCLSZ06       0.1588305  0.0040207    39.504  < 2e-16 ***\nDESTIN_SZCLSZ07      -0.6651443  0.0052627  -126.389  < 2e-16 ***\nDESTIN_SZCLSZ08      -0.4300984  0.0057224   -75.161  < 2e-16 ***\nDESTIN_SZCLSZ09       0.3632491  0.0063773    56.960  < 2e-16 ***\nDESTIN_SZDTSZ02      -2.8860959  0.0348379   -82.844  < 2e-16 ***\nDESTIN_SZDTSZ03      -1.4155739  0.0144113   -98.227  < 2e-16 ***\nDESTIN_SZDTSZ13      -2.2197108  0.0161427  -137.505  < 2e-16 ***\nDESTIN_SZGLSZ01       0.0360456  0.0051226     7.037 1.97e-12 ***\nDESTIN_SZGLSZ02      -0.2944546  0.0046197   -63.739  < 2e-16 ***\nDESTIN_SZGLSZ03       0.3996641  0.0038387   104.115  < 2e-16 ***\nDESTIN_SZGLSZ04       0.3387134  0.0038028    89.071  < 2e-16 ***\nDESTIN_SZGLSZ05       0.1935512  0.0038854    49.816  < 2e-16 ***\nDESTIN_SZHGSZ01       0.2886226  0.0038829    74.332  < 2e-16 ***\nDESTIN_SZHGSZ02      -0.6115672  0.0051189  -119.473  < 2e-16 ***\nDESTIN_SZHGSZ03      -1.0528824  0.0061020  -172.547  < 2e-16 ***\nDESTIN_SZHGSZ04      -0.2363236  0.0043617   -54.182  < 2e-16 ***\nDESTIN_SZHGSZ05      -0.3003303  0.0044868   -66.936  < 2e-16 ***\nDESTIN_SZHGSZ06      -0.8190218  0.0054086  -151.430  < 2e-16 ***\nDESTIN_SZHGSZ07       0.1973306  0.0040340    48.916  < 2e-16 ***\nDESTIN_SZHGSZ08      -0.4434470  0.0048969   -90.556  < 2e-16 ***\nDESTIN_SZHGSZ09       0.0495733  0.0051346     9.655  < 2e-16 ***\nDESTIN_SZHGSZ10      -2.9142272  0.0262066  -111.202  < 2e-16 ***\nDESTIN_SZJESZ01      -0.1274822  0.0048238   -26.428  < 2e-16 ***\nDESTIN_SZJESZ02      -0.5332323  0.0051518  -103.505  < 2e-16 ***\nDESTIN_SZJESZ03      -0.6434751  0.0056630  -113.627  < 2e-16 ***\nDESTIN_SZJESZ04      -0.1952696  0.0065530   -29.798  < 2e-16 ***\nDESTIN_SZJESZ05      -1.0016142  0.0097677  -102.543  < 2e-16 ***\nDESTIN_SZJESZ06       0.4183634  0.0040647   102.925  < 2e-16 ***\nDESTIN_SZJESZ07      -1.1907296  0.0081559  -145.997  < 2e-16 ***\nDESTIN_SZJESZ08      -0.6819949  0.0078081   -87.345  < 2e-16 ***\nDESTIN_SZJESZ09      -0.3842693  0.0053974   -71.195  < 2e-16 ***\nDESTIN_SZJESZ10       0.6233846  0.0069391    89.836  < 2e-16 ***\nDESTIN_SZJESZ11       0.8588253  0.0065842   130.438  < 2e-16 ***\nDESTIN_SZJWSZ01      -0.5743273  0.0064564   -88.954  < 2e-16 ***\nDESTIN_SZJWSZ02      -0.3954232  0.0051665   -76.535  < 2e-16 ***\nDESTIN_SZJWSZ03       0.5694389  0.0039307   144.871  < 2e-16 ***\nDESTIN_SZJWSZ04       0.8606902  0.0037226   231.205  < 2e-16 ***\nDESTIN_SZJWSZ05      -0.2823924  0.0060826   -46.426  < 2e-16 ***\nDESTIN_SZJWSZ06       0.2352724  0.0054595    43.094  < 2e-16 ***\nDESTIN_SZJWSZ07      -1.5375403  0.0280040   -54.904  < 2e-16 ***\nDESTIN_SZJWSZ08       0.3147094  0.0044680    70.437  < 2e-16 ***\nDESTIN_SZJWSZ09       1.2720518  0.0034024   373.865  < 2e-16 ***\nDESTIN_SZKLSZ01      -0.6242607  0.0051546  -121.107  < 2e-16 ***\nDESTIN_SZKLSZ02      -0.7374046  0.0057144  -129.044  < 2e-16 ***\nDESTIN_SZKLSZ03      -1.3284719  0.0065173  -203.839  < 2e-16 ***\nDESTIN_SZKLSZ04      -1.7896899  0.0087381  -204.814  < 2e-16 ***\nDESTIN_SZKLSZ05      -0.9281552  0.0071071  -130.596  < 2e-16 ***\nDESTIN_SZKLSZ06      -2.4472009  0.0362066   -67.590  < 2e-16 ***\nDESTIN_SZKLSZ07      -1.1154762  0.0065760  -169.627  < 2e-16 ***\nDESTIN_SZKLSZ08      -0.5706917  0.0050918  -112.080  < 2e-16 ***\nDESTIN_SZLKSZ01      -1.6795064  0.0204169   -82.260  < 2e-16 ***\nDESTIN_SZMDSZ01      -1.5536339  0.0198358   -78.325  < 2e-16 ***\nDESTIN_SZMDSZ02      -1.2079509  0.0111348  -108.484  < 2e-16 ***\nDESTIN_SZMDSZ03      -2.9726073  0.0250846  -118.503  < 2e-16 ***\nDESTIN_SZMPSZ01      -1.1488342  0.0077130  -148.948  < 2e-16 ***\nDESTIN_SZMPSZ02      -0.8985650  0.0060322  -148.961  < 2e-16 ***\nDESTIN_SZMPSZ03      -0.1802688  0.0046394   -38.856  < 2e-16 ***\nDESTIN_SZMUSZ02      -2.2856058  0.0199642  -114.485  < 2e-16 ***\nDESTIN_SZNTSZ01      -3.5819854  0.0447754   -79.999  < 2e-16 ***\nDESTIN_SZNTSZ02      -1.8970904  0.0108739  -174.462  < 2e-16 ***\nDESTIN_SZNTSZ03      -1.1453158  0.0076148  -150.406  < 2e-16 ***\nDESTIN_SZNTSZ05      -1.8600812  0.0249543   -74.539  < 2e-16 ***\nDESTIN_SZNTSZ06      -3.0005362  0.0428602   -70.007  < 2e-16 ***\nDESTIN_SZNVSZ01      -0.3540976  0.0044294   -79.943  < 2e-16 ***\nDESTIN_SZNVSZ02      -0.6354596  0.0052782  -120.393  < 2e-16 ***\nDESTIN_SZNVSZ03      -0.6926039  0.0054248  -127.673  < 2e-16 ***\nDESTIN_SZNVSZ04      -2.2171459  0.0106997  -207.216  < 2e-16 ***\nDESTIN_SZNVSZ05      -1.8175824  0.0089062  -204.081  < 2e-16 ***\nDESTIN_SZPGSZ01      -1.6121145  0.0153049  -105.333  < 2e-16 ***\nDESTIN_SZPGSZ02      -0.9704812  0.0067275  -144.257  < 2e-16 ***\nDESTIN_SZPGSZ03       0.2711837  0.0040244    67.385  < 2e-16 ***\nDESTIN_SZPGSZ04      -0.2060179  0.0044926   -45.857  < 2e-16 ***\nDESTIN_SZPGSZ05      -0.9938937  0.0070849  -140.283  < 2e-16 ***\nDESTIN_SZPLSZ01      -0.3008324  0.0068281   -44.058  < 2e-16 ***\nDESTIN_SZPLSZ02      -1.4752107  0.0131164  -112.471  < 2e-16 ***\nDESTIN_SZPLSZ03      -0.1959443  0.0095866   -20.439  < 2e-16 ***\nDESTIN_SZPLSZ04      -0.2883047  0.0093371   -30.877  < 2e-16 ***\nDESTIN_SZPLSZ05      -0.8039780  0.0116854   -68.802  < 2e-16 ***\nDESTIN_SZPNSZ01       0.9421407  0.0050047   188.249  < 2e-16 ***\nDESTIN_SZPNSZ02       1.3639714  0.0064548   211.310  < 2e-16 ***\nDESTIN_SZPNSZ03       0.5711018  0.0077106    74.067  < 2e-16 ***\nDESTIN_SZPNSZ04       1.3960432  0.0075778   184.229  < 2e-16 ***\nDESTIN_SZPNSZ05       0.4474974  0.0115933    38.600  < 2e-16 ***\nDESTIN_SZPRSZ01      -1.1291886  0.0084669  -133.366  < 2e-16 ***\nDESTIN_SZPRSZ02      -0.3162629  0.0049878   -63.407  < 2e-16 ***\nDESTIN_SZPRSZ03       0.4878487  0.0038516   126.660  < 2e-16 ***\nDESTIN_SZPRSZ04      -0.7406307  0.0079063   -93.676  < 2e-16 ***\nDESTIN_SZPRSZ05      -0.0733002  0.0044984   -16.295  < 2e-16 ***\nDESTIN_SZPRSZ06       0.2616531  0.0052026    50.293  < 2e-16 ***\nDESTIN_SZPRSZ07      -1.4589011  0.0117302  -124.372  < 2e-16 ***\nDESTIN_SZPRSZ08      -0.8621991  0.0064876  -132.901  < 2e-16 ***\nDESTIN_SZQTSZ01      -1.1965821  0.0085396  -140.121  < 2e-16 ***\nDESTIN_SZQTSZ02      -1.4263894  0.0073430  -194.251  < 2e-16 ***\nDESTIN_SZQTSZ03      -0.7982677  0.0064063  -124.606  < 2e-16 ***\nDESTIN_SZQTSZ04      -0.9187054  0.0065358  -140.565  < 2e-16 ***\nDESTIN_SZQTSZ05      -0.8844581  0.0058478  -151.245  < 2e-16 ***\nDESTIN_SZQTSZ06      -1.1629136  0.0063565  -182.948  < 2e-16 ***\nDESTIN_SZQTSZ07      -1.4908922  0.0108734  -137.113  < 2e-16 ***\nDESTIN_SZQTSZ08      -0.0247369  0.0047985    -5.155 2.53e-07 ***\nDESTIN_SZQTSZ09      -0.5510822  0.0057381   -96.039  < 2e-16 ***\nDESTIN_SZQTSZ10      -0.6181793  0.0054209  -114.037  < 2e-16 ***\nDESTIN_SZQTSZ11      -0.4072294  0.0054692   -74.458  < 2e-16 ***\nDESTIN_SZQTSZ12      -0.5688076  0.0070694   -80.460  < 2e-16 ***\nDESTIN_SZQTSZ13      -0.1613461  0.0051342   -31.426  < 2e-16 ***\nDESTIN_SZQTSZ14      -0.4899105  0.0062248   -78.703  < 2e-16 ***\nDESTIN_SZQTSZ15      -0.1580039  0.0073137   -21.604  < 2e-16 ***\nDESTIN_SZRCSZ01      -0.5530825  0.0071801   -77.030  < 2e-16 ***\nDESTIN_SZRCSZ06      -2.0318919  0.0188791  -107.627  < 2e-16 ***\nDESTIN_SZRVSZ01      -2.5041818  0.0162325  -154.269  < 2e-16 ***\nDESTIN_SZRVSZ02      -3.1631541  0.0326142   -96.987  < 2e-16 ***\nDESTIN_SZRVSZ03      -2.4702654  0.0135081  -182.872  < 2e-16 ***\nDESTIN_SZRVSZ04      -1.8004502  0.0154976  -116.176  < 2e-16 ***\nDESTIN_SZRVSZ05      -2.9498980  0.0256329  -115.083  < 2e-16 ***\nDESTIN_SZSBSZ01      -0.2407682  0.0060596   -39.733  < 2e-16 ***\nDESTIN_SZSBSZ02      -1.1716104  0.0076342  -153.469  < 2e-16 ***\nDESTIN_SZSBSZ03       0.5025478  0.0041456   121.224  < 2e-16 ***\nDESTIN_SZSBSZ04      -0.0336083  0.0051433    -6.534 6.39e-11 ***\nDESTIN_SZSBSZ05      -1.0065693  0.0071975  -139.849  < 2e-16 ***\nDESTIN_SZSBSZ06      -2.3640414  0.0221608  -106.677  < 2e-16 ***\nDESTIN_SZSBSZ07      -1.0042413  0.0181727   -55.261  < 2e-16 ***\nDESTIN_SZSBSZ08       1.1356376  0.0051662   219.821  < 2e-16 ***\nDESTIN_SZSBSZ09       0.6729359  0.0048386   139.076  < 2e-16 ***\nDESTIN_SZSESZ02      -0.3864535  0.0046690   -82.770  < 2e-16 ***\nDESTIN_SZSESZ03       0.4365473  0.0036988   118.024  < 2e-16 ***\nDESTIN_SZSESZ04      -0.7772131  0.0054287  -143.166  < 2e-16 ***\nDESTIN_SZSESZ05      -0.4159594  0.0047537   -87.502  < 2e-16 ***\nDESTIN_SZSESZ06      -0.7197420  0.0057104  -126.040  < 2e-16 ***\nDESTIN_SZSESZ07      -3.0503330  0.0226808  -134.490  < 2e-16 ***\nDESTIN_SZSGSZ01      -0.5759283  0.0058294   -98.798  < 2e-16 ***\nDESTIN_SZSGSZ02      -0.1161709  0.0051649   -22.492  < 2e-16 ***\nDESTIN_SZSGSZ03      -0.4106263  0.0047157   -87.077  < 2e-16 ***\nDESTIN_SZSGSZ04      -0.3163870  0.0046868   -67.506  < 2e-16 ***\nDESTIN_SZSGSZ05      -2.2280281  0.0097909  -227.562  < 2e-16 ***\nDESTIN_SZSGSZ06       0.3187814  0.0037949    84.002  < 2e-16 ***\nDESTIN_SZSGSZ07      -0.5874335  0.0051371  -114.352  < 2e-16 ***\nDESTIN_SZSISZ01      -1.2917491  0.0257804   -50.106  < 2e-16 ***\nDESTIN_SZSKSZ01      -0.1088797  0.0066893   -16.277  < 2e-16 ***\nDESTIN_SZSKSZ02       0.9106755  0.0050278   181.128  < 2e-16 ***\nDESTIN_SZSKSZ03      -0.1543859  0.0059159   -26.097  < 2e-16 ***\nDESTIN_SZSKSZ04      -0.7057575  0.0139698   -50.520  < 2e-16 ***\nDESTIN_SZSKSZ05      -0.0121301  0.0104904    -1.156  0.24755    \nDESTIN_SZSLSZ01      -0.6832113  0.0083380   -81.939  < 2e-16 ***\nDESTIN_SZSLSZ04      -0.8877801  0.0070348  -126.199  < 2e-16 ***\nDESTIN_SZSRSZ01      -2.1769985  0.0127231  -171.106  < 2e-16 ***\nDESTIN_SZTHSZ01      -2.9236668  0.0366843   -79.698  < 2e-16 ***\nDESTIN_SZTHSZ03      -2.2436488  0.0250852   -89.441  < 2e-16 ***\nDESTIN_SZTHSZ04      -2.1614123  0.0213692  -101.146  < 2e-16 ***\nDESTIN_SZTHSZ06      -1.5413261  0.0150039  -102.728  < 2e-16 ***\nDESTIN_SZTMSZ01      -0.0352953  0.0055152    -6.400 1.56e-10 ***\nDESTIN_SZTMSZ02       1.5046218  0.0032643   460.933  < 2e-16 ***\nDESTIN_SZTMSZ03       0.6299992  0.0037167   169.506  < 2e-16 ***\nDESTIN_SZTMSZ04       0.8101842  0.0037611   215.414  < 2e-16 ***\nDESTIN_SZTMSZ05       0.4133985  0.0051282    80.613  < 2e-16 ***\nDESTIN_SZTNSZ01      -1.2547855  0.0066985  -187.324  < 2e-16 ***\nDESTIN_SZTNSZ02      -1.9449320  0.0096551  -201.441  < 2e-16 ***\nDESTIN_SZTNSZ03      -2.0073616  0.0115726  -173.458  < 2e-16 ***\nDESTIN_SZTNSZ04      -1.2287484  0.0068502  -179.374  < 2e-16 ***\nDESTIN_SZTPSZ01      -0.6386471  0.0055775  -114.505  < 2e-16 ***\nDESTIN_SZTPSZ02       0.1716304  0.0037260    46.062  < 2e-16 ***\nDESTIN_SZTPSZ03      -0.4174415  0.0054889   -76.052  < 2e-16 ***\nDESTIN_SZTPSZ04      -1.4950882  0.0071592  -208.835  < 2e-16 ***\nDESTIN_SZTPSZ05      -0.8842788  0.0056754  -155.809  < 2e-16 ***\nDESTIN_SZTPSZ06      -0.1789661  0.0062669   -28.558  < 2e-16 ***\nDESTIN_SZTPSZ07      -1.9286389  0.0116567  -165.454  < 2e-16 ***\nDESTIN_SZTPSZ08      -1.4130347  0.0085538  -165.195  < 2e-16 ***\nDESTIN_SZTPSZ09      -0.4981579  0.0059404   -83.860  < 2e-16 ***\nDESTIN_SZTPSZ10      -1.1404224  0.0084489  -134.980  < 2e-16 ***\nDESTIN_SZTPSZ11      -0.3973636  0.0050912   -78.049  < 2e-16 ***\nDESTIN_SZTPSZ12      -0.8099589  0.0061327  -132.072  < 2e-16 ***\nDESTIN_SZTSSZ01      -0.8455348  0.0208533   -40.547  < 2e-16 ***\nDESTIN_SZTSSZ02       0.5462129  0.0093784    58.242  < 2e-16 ***\nDESTIN_SZTSSZ03       1.4128184  0.0064443   219.237  < 2e-16 ***\nDESTIN_SZTSSZ04       1.2433626  0.0067892   183.138  < 2e-16 ***\nDESTIN_SZTSSZ05       1.3979287  0.0073701   189.675  < 2e-16 ***\nDESTIN_SZTSSZ06       0.1654437  0.0137913    11.996  < 2e-16 ***\nDESTIN_SZWCSZ01       1.3237346  0.0045380   291.698  < 2e-16 ***\nDESTIN_SZWCSZ02      -0.7071355  0.0122995   -57.493  < 2e-16 ***\nDESTIN_SZWCSZ03      -2.2322890  0.0325130   -68.658  < 2e-16 ***\nDESTIN_SZWDSZ01       1.3833409  0.0034823   397.248  < 2e-16 ***\nDESTIN_SZWDSZ02      -0.4933824  0.0055232   -89.330  < 2e-16 ***\nDESTIN_SZWDSZ03       1.0032194  0.0036331   276.136  < 2e-16 ***\nDESTIN_SZWDSZ04      -0.4482317  0.0058446   -76.692  < 2e-16 ***\nDESTIN_SZWDSZ05      -0.1842471  0.0053992   -34.125  < 2e-16 ***\nDESTIN_SZWDSZ06       0.4160272  0.0040354   103.093  < 2e-16 ***\nDESTIN_SZWDSZ07       0.4464085  0.0061783    72.255  < 2e-16 ***\nDESTIN_SZWDSZ08       0.4097875  0.0060966    67.216  < 2e-16 ***\nDESTIN_SZWDSZ09       0.5609089  0.0044866   125.018  < 2e-16 ***\nDESTIN_SZYSSZ01       1.0631470  0.0038249   277.952  < 2e-16 ***\nDESTIN_SZYSSZ02       0.1815975  0.0048221    37.660  < 2e-16 ***\nDESTIN_SZYSSZ03      -0.1701590  0.0051388   -33.113  < 2e-16 ***\nDESTIN_SZYSSZ04      -0.0488067  0.0048687   -10.025  < 2e-16 ***\nDESTIN_SZYSSZ05      -1.6356303  0.0100323  -163.037  < 2e-16 ***\nDESTIN_SZYSSZ06      -1.8593634  0.0098619  -188.541  < 2e-16 ***\nDESTIN_SZYSSZ07      -1.0655380  0.0111530   -95.538  < 2e-16 ***\nDESTIN_SZYSSZ08       0.5479624  0.0039557   138.525  < 2e-16 ***\nDESTIN_SZYSSZ09       0.3662081  0.0038906    94.127  < 2e-16 ***\nlog(ORIGIN_AGE7_12)   0.1312205  0.0007252   180.949  < 2e-16 ***\nlog(ORIGIN_AGE13_24)  0.6245430  0.0009598   650.677  < 2e-16 ***\nlog(ORIGIN_AGE25_64) -0.4273627  0.0009266  -461.217  < 2e-16 ***\nlog(dist)            -0.6917367  0.0001295 -5343.066  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 60796037  on 14733  degrees of freedom\nResidual deviance: 25692617  on 14450  degrees of freedom\nAIC: 25784812\n\nNumber of Fisher Scoring iterations: 7\n```\n:::\n:::\n\nThe R-squared value of the destination-constrained SIM is 0.513.\n\n::: {.cell}\n\n```{.r .cell-code}\nCalcRSquared(decSIM$data$TRIPS, decSIM$fitted.values)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.5133868\n```\n:::\n:::\n\n\n## 3.7 Doubly-constrained SIM\nWe calibrate a doubly-constrained SIM as follows:\n\n::: {.cell}\n\n```{.r .cell-code}\ndbcSIM <- glm(formula = TRIPS ~ \n                ORIGIN_SZ + \n                DESTIN_SZ + \n                log(dist),\n              family = poisson(link = \"log\"),\n              data = SIM_data,\n              na.action = na.exclude)\nsummary(dbcSIM)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = TRIPS ~ ORIGIN_SZ + DESTIN_SZ + log(dist), family = poisson(link = \"log\"), \n    data = SIM_data, na.action = na.exclude)\n\nCoefficients:\n                  Estimate Std. Error   z value Pr(>|z|)    \n(Intercept)     12.4165310  0.0043949  2825.242  < 2e-16 ***\nORIGIN_SZAMSZ02  0.9496891  0.0045740   207.630  < 2e-16 ***\nORIGIN_SZAMSZ03  0.5519174  0.0046672   118.253  < 2e-16 ***\nORIGIN_SZAMSZ04  0.1028140  0.0052468    19.596  < 2e-16 ***\nORIGIN_SZAMSZ05  0.0822549  0.0058663    14.022  < 2e-16 ***\nORIGIN_SZAMSZ06  0.6617809  0.0052580   125.861  < 2e-16 ***\nORIGIN_SZAMSZ07 -0.9508298  0.0097681   -97.340  < 2e-16 ***\nORIGIN_SZAMSZ08 -0.7271779  0.0090946   -79.958  < 2e-16 ***\nORIGIN_SZAMSZ09  0.4896781  0.0055203    88.704  < 2e-16 ***\nORIGIN_SZAMSZ10  0.4819428  0.0048175   100.040  < 2e-16 ***\nORIGIN_SZAMSZ11 -1.7719841  0.0130695  -135.582  < 2e-16 ***\nORIGIN_SZAMSZ12 -1.7679107  0.0108777  -162.526  < 2e-16 ***\nORIGIN_SZBDSZ01  0.8314812  0.0045187   184.010  < 2e-16 ***\nORIGIN_SZBDSZ02  0.4305836  0.0052535    81.961  < 2e-16 ***\nORIGIN_SZBDSZ03  0.8009370  0.0046384   172.676  < 2e-16 ***\nORIGIN_SZBDSZ04  1.4562985  0.0040456   359.971  < 2e-16 ***\nORIGIN_SZBDSZ05  0.4501939  0.0046960    95.867  < 2e-16 ***\nORIGIN_SZBDSZ06  0.7745026  0.0047424   163.314  < 2e-16 ***\nORIGIN_SZBDSZ07 -1.1784123  0.0098105  -120.117  < 2e-16 ***\nORIGIN_SZBDSZ08 -0.9830996  0.0091135  -107.873  < 2e-16 ***\nORIGIN_SZBKSZ01 -0.3042966  0.0067086   -45.359  < 2e-16 ***\nORIGIN_SZBKSZ02  0.4801541  0.0054160    88.655  < 2e-16 ***\nORIGIN_SZBKSZ03  0.7823931  0.0052007   150.440  < 2e-16 ***\nORIGIN_SZBKSZ04 -0.1292545  0.0061735   -20.937  < 2e-16 ***\nORIGIN_SZBKSZ05 -0.0258584  0.0060192    -4.296 1.74e-05 ***\nORIGIN_SZBKSZ06  0.1994719  0.0061206    32.590  < 2e-16 ***\nORIGIN_SZBKSZ07  0.7434860  0.0046598   159.553  < 2e-16 ***\nORIGIN_SZBKSZ08  0.1625007  0.0055219    29.428  < 2e-16 ***\nORIGIN_SZBKSZ09 -0.0864293  0.0059533   -14.518  < 2e-16 ***\nORIGIN_SZBLSZ01 -2.1022485  0.0150316  -139.855  < 2e-16 ***\nORIGIN_SZBLSZ02 -2.9460181  0.0195760  -150.491  < 2e-16 ***\nORIGIN_SZBLSZ03 -4.9412872  0.0398540  -123.985  < 2e-16 ***\nORIGIN_SZBLSZ04 -2.8143593  0.0239209  -117.653  < 2e-16 ***\nORIGIN_SZBMSZ01 -0.0264561  0.0053639    -4.932 8.13e-07 ***\nORIGIN_SZBMSZ02 -0.8656513  0.0068511  -126.353  < 2e-16 ***\nORIGIN_SZBMSZ03 -0.1723467  0.0059613   -28.911  < 2e-16 ***\nORIGIN_SZBMSZ04  0.2169844  0.0053578    40.499  < 2e-16 ***\nORIGIN_SZBMSZ05 -2.0252956  0.0126107  -160.602  < 2e-16 ***\nORIGIN_SZBMSZ06 -1.7642018  0.0163931  -107.619  < 2e-16 ***\nORIGIN_SZBMSZ07 -0.3271629  0.0058137   -56.274  < 2e-16 ***\nORIGIN_SZBMSZ08 -0.2533255  0.0059335   -42.694  < 2e-16 ***\nORIGIN_SZBMSZ09 -0.7712635  0.0087939   -87.704  < 2e-16 ***\nORIGIN_SZBMSZ10 -1.0098048  0.0092519  -109.145  < 2e-16 ***\nORIGIN_SZBMSZ11 -0.3816187  0.0067302   -56.702  < 2e-16 ***\nORIGIN_SZBMSZ12 -0.6666616  0.0095680   -69.676  < 2e-16 ***\nORIGIN_SZBMSZ13 -0.0076108  0.0059040    -1.289  0.19737    \nORIGIN_SZBMSZ14 -0.1682476  0.0069391   -24.246  < 2e-16 ***\nORIGIN_SZBMSZ15  0.0904585  0.0062822    14.399  < 2e-16 ***\nORIGIN_SZBMSZ16 -1.1808741  0.0092258  -127.997  < 2e-16 ***\nORIGIN_SZBMSZ17 -1.7189127  0.0158408  -108.512  < 2e-16 ***\nORIGIN_SZBPSZ01  0.4294645  0.0058051    73.980  < 2e-16 ***\nORIGIN_SZBPSZ02  0.5028906  0.0068169    73.771  < 2e-16 ***\nORIGIN_SZBPSZ03  0.6656178  0.0066126   100.658  < 2e-16 ***\nORIGIN_SZBPSZ04  0.5203612  0.0053224    97.769  < 2e-16 ***\nORIGIN_SZBPSZ05  0.5377769  0.0047907   112.256  < 2e-16 ***\nORIGIN_SZBPSZ06 -1.2327809  0.0094950  -129.835  < 2e-16 ***\nORIGIN_SZBPSZ07 -0.9035255  0.0088739  -101.818  < 2e-16 ***\nORIGIN_SZBSSZ01  0.1210027  0.0053990    22.412  < 2e-16 ***\nORIGIN_SZBSSZ02  0.4618449  0.0048641    94.951  < 2e-16 ***\nORIGIN_SZBSSZ03  0.2160739  0.0047835    45.170  < 2e-16 ***\nORIGIN_SZBTSZ01 -0.1108042  0.0055599   -19.929  < 2e-16 ***\nORIGIN_SZBTSZ02 -0.8911221  0.0079213  -112.498  < 2e-16 ***\nORIGIN_SZBTSZ03 -0.2203980  0.0059325   -37.151  < 2e-16 ***\nORIGIN_SZBTSZ04 -0.6427946  0.0105438   -60.964  < 2e-16 ***\nORIGIN_SZBTSZ05 -1.4662312  0.0111784  -131.166  < 2e-16 ***\nORIGIN_SZBTSZ06 -0.6105884  0.0073456   -83.123  < 2e-16 ***\nORIGIN_SZBTSZ07 -1.9041317  0.0132781  -143.404  < 2e-16 ***\nORIGIN_SZBTSZ08 -1.0627939  0.0095982  -110.728  < 2e-16 ***\nORIGIN_SZCBSZ01 -2.9365941  0.0548632   -53.526  < 2e-16 ***\nORIGIN_SZCCSZ01 -1.5313555  0.0134599  -113.772  < 2e-16 ***\nORIGIN_SZCHSZ01 -1.2034494  0.0119468  -100.734  < 2e-16 ***\nORIGIN_SZCHSZ02 -0.8299415  0.0081984  -101.232  < 2e-16 ***\nORIGIN_SZCHSZ03 -0.5143946  0.0061944   -83.042  < 2e-16 ***\nORIGIN_SZCKSZ01  0.2372583  0.0053612    44.255  < 2e-16 ***\nORIGIN_SZCKSZ02  0.9124836  0.0054472   167.515  < 2e-16 ***\nORIGIN_SZCKSZ03  0.7237808  0.0048401   149.539  < 2e-16 ***\nORIGIN_SZCKSZ04  1.6884022  0.0050169   336.540  < 2e-16 ***\nORIGIN_SZCKSZ05  1.3932005  0.0062346   223.464  < 2e-16 ***\nORIGIN_SZCKSZ06  1.0670053  0.0066112   161.394  < 2e-16 ***\nORIGIN_SZCLSZ01 -0.8602837  0.0079240  -108.567  < 2e-16 ***\nORIGIN_SZCLSZ02 -1.3853421  0.0137444  -100.793  < 2e-16 ***\nORIGIN_SZCLSZ03 -0.8582608  0.0081177  -105.727  < 2e-16 ***\nORIGIN_SZCLSZ04  0.7836027  0.0046427   168.782  < 2e-16 ***\nORIGIN_SZCLSZ05 -1.8121756  0.0148960  -121.655  < 2e-16 ***\nORIGIN_SZCLSZ06  0.8296870  0.0043909   188.955  < 2e-16 ***\nORIGIN_SZCLSZ07 -0.2325219  0.0057432   -40.487  < 2e-16 ***\nORIGIN_SZCLSZ08  0.2714336  0.0062625    43.342  < 2e-16 ***\nORIGIN_SZCLSZ09 -2.2223744  0.0160946  -138.082  < 2e-16 ***\nORIGIN_SZDTSZ02 -4.0704970  0.0834192   -48.796  < 2e-16 ***\nORIGIN_SZDTSZ03 -3.4529031  0.0738295   -46.769  < 2e-16 ***\nORIGIN_SZDTSZ13 -2.8301983  0.0313085   -90.397  < 2e-16 ***\nORIGIN_SZGLSZ01 -1.4674986  0.0093137  -157.563  < 2e-16 ***\nORIGIN_SZGLSZ02  0.2749369  0.0050051    54.931  < 2e-16 ***\nORIGIN_SZGLSZ03  0.0781954  0.0049748    15.718  < 2e-16 ***\nORIGIN_SZGLSZ04  0.8167797  0.0043260   188.808  < 2e-16 ***\nORIGIN_SZGLSZ05  0.5277509  0.0044879   117.595  < 2e-16 ***\nORIGIN_SZHGSZ01  0.2323885  0.0048555    47.861  < 2e-16 ***\nORIGIN_SZHGSZ02  0.5707182  0.0048256   118.268  < 2e-16 ***\nORIGIN_SZHGSZ03  0.4231170  0.0052149    81.136  < 2e-16 ***\nORIGIN_SZHGSZ04  0.9341168  0.0044128   211.681  < 2e-16 ***\nORIGIN_SZHGSZ05  1.2192790  0.0043790   278.437  < 2e-16 ***\nORIGIN_SZHGSZ06  0.0490041  0.0054961     8.916  < 2e-16 ***\nORIGIN_SZHGSZ07  0.6337041  0.0045735   138.559  < 2e-16 ***\nORIGIN_SZHGSZ08  0.0312612  0.0054684     5.717 1.09e-08 ***\nORIGIN_SZHGSZ09 -0.6985397  0.0071800   -97.289  < 2e-16 ***\nORIGIN_SZHGSZ10 -2.9958967  0.0422303   -70.942  < 2e-16 ***\nORIGIN_SZJESZ01  0.4363431  0.0051329    85.010  < 2e-16 ***\nORIGIN_SZJESZ02  0.3460900  0.0051372    67.370  < 2e-16 ***\nORIGIN_SZJESZ03  0.2928005  0.0055108    53.132  < 2e-16 ***\nORIGIN_SZJESZ04 -1.1924298  0.0093540  -127.478  < 2e-16 ***\nORIGIN_SZJESZ05 -2.0178136  0.0139479  -144.668  < 2e-16 ***\nORIGIN_SZJESZ06  0.1637633  0.0050685    32.310  < 2e-16 ***\nORIGIN_SZJESZ07 -1.8227460  0.0119383  -152.680  < 2e-16 ***\nORIGIN_SZJESZ08 -1.1556281  0.0117870   -98.043  < 2e-16 ***\nORIGIN_SZJESZ09  0.4766229  0.0052813    90.248  < 2e-16 ***\nORIGIN_SZJESZ10 -2.6868992  0.0186864  -143.789  < 2e-16 ***\nORIGIN_SZJESZ11 -3.0618150  0.0199755  -153.278  < 2e-16 ***\nORIGIN_SZJWSZ01  0.4417418  0.0068611    64.383  < 2e-16 ***\nORIGIN_SZJWSZ02  0.9738087  0.0047905   203.281  < 2e-16 ***\nORIGIN_SZJWSZ03  1.1548028  0.0045180   255.599  < 2e-16 ***\nORIGIN_SZJWSZ04  0.9078417  0.0046668   194.532  < 2e-16 ***\nORIGIN_SZJWSZ05 -1.7092500  0.0127422  -134.141  < 2e-16 ***\nORIGIN_SZJWSZ06 -1.3284287  0.0109785  -121.002  < 2e-16 ***\nORIGIN_SZJWSZ07 -2.3231549  0.0281427   -82.549  < 2e-16 ***\nORIGIN_SZJWSZ08  1.9386127  0.0046041   421.059  < 2e-16 ***\nORIGIN_SZJWSZ09  1.3987549  0.0042610   328.266  < 2e-16 ***\nORIGIN_SZKLSZ01  0.2617735  0.0050089    52.261  < 2e-16 ***\nORIGIN_SZKLSZ02 -0.4325093  0.0064279   -67.286  < 2e-16 ***\nORIGIN_SZKLSZ03 -0.2787173  0.0060380   -46.161  < 2e-16 ***\nORIGIN_SZKLSZ04 -1.9432693  0.0119163  -163.076  < 2e-16 ***\nORIGIN_SZKLSZ05 -0.5420067  0.0085529   -63.371  < 2e-16 ***\nORIGIN_SZKLSZ06 -4.2949009  0.1857686   -23.120  < 2e-16 ***\nORIGIN_SZKLSZ07 -0.8576946  0.0085178  -100.694  < 2e-16 ***\nORIGIN_SZKLSZ08 -1.3840925  0.0092323  -149.918  < 2e-16 ***\nORIGIN_SZLKSZ01 -2.8108510  0.0392356   -71.640  < 2e-16 ***\nORIGIN_SZMDSZ01 -1.6745388  0.0296543   -56.469  < 2e-16 ***\nORIGIN_SZMDSZ02 -0.8193738  0.0106631   -76.842  < 2e-16 ***\nORIGIN_SZMDSZ03 -1.5088267  0.0172032   -87.706  < 2e-16 ***\nORIGIN_SZMPSZ01 -0.9860154  0.0085053  -115.929  < 2e-16 ***\nORIGIN_SZMPSZ02 -0.5958875  0.0070097   -85.008  < 2e-16 ***\nORIGIN_SZMPSZ03 -0.0490122  0.0054582    -8.980  < 2e-16 ***\nORIGIN_SZMUSZ02 -3.5233367  0.1037749   -33.952  < 2e-16 ***\nORIGIN_SZNTSZ01 -2.6451541  0.0353125   -74.907  < 2e-16 ***\nORIGIN_SZNTSZ02 -2.7710546  0.0232841  -119.011  < 2e-16 ***\nORIGIN_SZNTSZ03 -0.6123404  0.0079083   -77.430  < 2e-16 ***\nORIGIN_SZNTSZ05 -2.9257445  0.0496704   -58.903  < 2e-16 ***\nORIGIN_SZNTSZ06 -3.3260031  0.0557966   -59.609  < 2e-16 ***\nORIGIN_SZNVSZ01  0.6421306  0.0046037   139.482  < 2e-16 ***\nORIGIN_SZNVSZ02 -0.4251550  0.0065890   -64.525  < 2e-16 ***\nORIGIN_SZNVSZ03 -1.0765622  0.0078766  -136.679  < 2e-16 ***\nORIGIN_SZNVSZ04 -1.2289504  0.0091468  -134.358  < 2e-16 ***\nORIGIN_SZNVSZ05 -2.3551389  0.0158219  -148.853  < 2e-16 ***\nORIGIN_SZPGSZ01  0.1518212  0.0154825     9.806  < 2e-16 ***\nORIGIN_SZPGSZ02 -0.4062609  0.0073780   -55.064  < 2e-16 ***\nORIGIN_SZPGSZ03  0.8976913  0.0046122   194.636  < 2e-16 ***\nORIGIN_SZPGSZ04  1.1161685  0.0045850   243.437  < 2e-16 ***\nORIGIN_SZPGSZ05  0.4794249  0.0060213    79.621  < 2e-16 ***\nORIGIN_SZPLSZ01 -0.8322377  0.0107898   -77.132  < 2e-16 ***\nORIGIN_SZPLSZ02 -1.2968937  0.0149841   -86.551  < 2e-16 ***\nORIGIN_SZPLSZ03 -3.2744991  0.0374541   -87.427  < 2e-16 ***\nORIGIN_SZPLSZ04 -3.5423615  0.0372570   -95.079  < 2e-16 ***\nORIGIN_SZPLSZ05 -2.4343705  0.0227807  -106.861  < 2e-16 ***\nORIGIN_SZPNSZ01  0.8052461  0.0056124   143.476  < 2e-16 ***\nORIGIN_SZPNSZ02 -1.8042362  0.0128222  -140.712  < 2e-16 ***\nORIGIN_SZPNSZ03 -2.6363996  0.0200058  -131.782  < 2e-16 ***\nORIGIN_SZPNSZ04 -4.8427070  0.0320126  -151.275  < 2e-16 ***\nORIGIN_SZPNSZ05 -3.6613775  0.0285686  -128.161  < 2e-16 ***\nORIGIN_SZPRSZ01 -0.5645384  0.0117126   -48.199  < 2e-16 ***\nORIGIN_SZPRSZ02  0.9145886  0.0048137   189.998  < 2e-16 ***\nORIGIN_SZPRSZ03  0.4478971  0.0048102    93.113  < 2e-16 ***\nORIGIN_SZPRSZ04 -0.5312444  0.0079019   -67.230  < 2e-16 ***\nORIGIN_SZPRSZ05  1.1462662  0.0045250   253.318  < 2e-16 ***\nORIGIN_SZPRSZ06 -0.7392744  0.0090347   -81.826  < 2e-16 ***\nORIGIN_SZPRSZ07 -2.1667862  0.0162528  -133.318  < 2e-16 ***\nORIGIN_SZPRSZ08 -0.1327079  0.0065712   -20.195  < 2e-16 ***\nORIGIN_SZQTSZ01  0.1062151  0.0071538    14.847  < 2e-16 ***\nORIGIN_SZQTSZ02 -0.4993990  0.0064382   -77.568  < 2e-16 ***\nORIGIN_SZQTSZ03  0.1161844  0.0058822    19.752  < 2e-16 ***\nORIGIN_SZQTSZ04 -0.8102612  0.0072742  -111.389  < 2e-16 ***\nORIGIN_SZQTSZ05 -0.0417272  0.0061917    -6.739 1.59e-11 ***\nORIGIN_SZQTSZ06 -0.2521417  0.0066449   -37.945  < 2e-16 ***\nORIGIN_SZQTSZ07 -1.2395975  0.0097496  -127.143  < 2e-16 ***\nORIGIN_SZQTSZ08 -0.1105467  0.0059364   -18.622  < 2e-16 ***\nORIGIN_SZQTSZ09 -0.5078461  0.0067895   -74.798  < 2e-16 ***\nORIGIN_SZQTSZ10 -0.3866593  0.0066995   -57.714  < 2e-16 ***\nORIGIN_SZQTSZ11 -1.5264609  0.0099770  -152.998  < 2e-16 ***\nORIGIN_SZQTSZ12 -1.3866518  0.0106887  -129.730  < 2e-16 ***\nORIGIN_SZQTSZ13 -0.3764286  0.0066707   -56.430  < 2e-16 ***\nORIGIN_SZQTSZ14 -1.4907399  0.0100120  -148.896  < 2e-16 ***\nORIGIN_SZQTSZ15 -1.0552239  0.0108792   -96.994  < 2e-16 ***\nORIGIN_SZRCSZ01 -1.3136074  0.0126986  -103.445  < 2e-16 ***\nORIGIN_SZRCSZ06 -0.2418276  0.0085509   -28.281  < 2e-16 ***\nORIGIN_SZRVSZ01 -2.9263747  0.0324968   -90.051  < 2e-16 ***\nORIGIN_SZRVSZ02 -2.2980940  0.0278202   -82.605  < 2e-16 ***\nORIGIN_SZRVSZ03 -2.4663765  0.0238674  -103.336  < 2e-16 ***\nORIGIN_SZRVSZ04 -3.1853677  0.0556939   -57.194  < 2e-16 ***\nORIGIN_SZRVSZ05 -1.5695490  0.0166684   -94.163  < 2e-16 ***\nORIGIN_SZSBSZ01  0.7674590  0.0061811   124.163  < 2e-16 ***\nORIGIN_SZSBSZ02 -0.7307279  0.0084105   -86.883  < 2e-16 ***\nORIGIN_SZSBSZ03  0.5920074  0.0050167   118.008  < 2e-16 ***\nORIGIN_SZSBSZ04  0.3684857  0.0058575    62.908  < 2e-16 ***\nORIGIN_SZSBSZ05 -0.0036863  0.0068459    -0.538  0.59026    \nORIGIN_SZSBSZ06 -1.1939284  0.0181541   -65.766  < 2e-16 ***\nORIGIN_SZSBSZ07 -0.4896579  0.0135618   -36.106  < 2e-16 ***\nORIGIN_SZSBSZ08 -2.1221691  0.0127258  -166.762  < 2e-16 ***\nORIGIN_SZSBSZ09 -1.2032410  0.0089611  -134.273  < 2e-16 ***\nORIGIN_SZSESZ02  1.0721820  0.0045336   236.498  < 2e-16 ***\nORIGIN_SZSESZ03  1.0808012  0.0042923   251.801  < 2e-16 ***\nORIGIN_SZSESZ04  1.0137448  0.0050668   200.076  < 2e-16 ***\nORIGIN_SZSESZ05 -0.1678679  0.0060206   -27.882  < 2e-16 ***\nORIGIN_SZSESZ06  0.9165834  0.0048323   189.677  < 2e-16 ***\nORIGIN_SZSESZ07 -2.2499789  0.0196327  -114.603  < 2e-16 ***\nORIGIN_SZSGSZ01 -0.9369800  0.0087282  -107.351  < 2e-16 ***\nORIGIN_SZSGSZ02 -1.1690716  0.0097131  -120.360  < 2e-16 ***\nORIGIN_SZSGSZ03  0.2604352  0.0052709    49.410  < 2e-16 ***\nORIGIN_SZSGSZ04  0.3468823  0.0048897    70.942  < 2e-16 ***\nORIGIN_SZSGSZ05 -1.5927797  0.0106308  -149.827  < 2e-16 ***\nORIGIN_SZSGSZ06  0.3605651  0.0046361    77.774  < 2e-16 ***\nORIGIN_SZSGSZ07 -0.5333873  0.0063119   -84.504  < 2e-16 ***\nORIGIN_SZSKSZ01 -0.2706750  0.0082836   -32.676  < 2e-16 ***\nORIGIN_SZSKSZ02  0.0970953  0.0063378    15.320  < 2e-16 ***\nORIGIN_SZSKSZ03 -0.6954342  0.0082538   -84.256  < 2e-16 ***\nORIGIN_SZSKSZ04 -2.3863580  0.0284607   -83.847  < 2e-16 ***\nORIGIN_SZSKSZ05 -1.5443140  0.0179059   -86.246  < 2e-16 ***\nORIGIN_SZSLSZ01 -2.9450656  0.0307283   -95.842  < 2e-16 ***\nORIGIN_SZSLSZ04 -0.5739349  0.0077851   -73.722  < 2e-16 ***\nORIGIN_SZSRSZ01 -1.6136735  0.0160199  -100.729  < 2e-16 ***\nORIGIN_SZTHSZ01 -2.6034976  0.0489378   -53.200  < 2e-16 ***\nORIGIN_SZTHSZ03 -1.2770601  0.0229815   -55.569  < 2e-16 ***\nORIGIN_SZTHSZ04 -2.0110399  0.0287527   -69.943  < 2e-16 ***\nORIGIN_SZTHSZ06 -1.7720116  0.0180394   -98.230  < 2e-16 ***\nORIGIN_SZTMSZ01  0.1254729  0.0060924    20.595  < 2e-16 ***\nORIGIN_SZTMSZ02  1.6667504  0.0039836   418.403  < 2e-16 ***\nORIGIN_SZTMSZ03  1.0941176  0.0042911   254.976  < 2e-16 ***\nORIGIN_SZTMSZ04  0.3209520  0.0050349    63.746  < 2e-16 ***\nORIGIN_SZTMSZ05 -0.8155124  0.0079342  -102.785  < 2e-16 ***\nORIGIN_SZTNSZ01 -1.4237298  0.0104636  -136.064  < 2e-16 ***\nORIGIN_SZTNSZ02 -1.2718890  0.0098660  -128.916  < 2e-16 ***\nORIGIN_SZTNSZ03 -1.7960517  0.0134675  -133.362  < 2e-16 ***\nORIGIN_SZTNSZ04 -0.3508142  0.0073556   -47.694  < 2e-16 ***\nORIGIN_SZTPSZ01 -0.3841699  0.0064137   -59.898  < 2e-16 ***\nORIGIN_SZTPSZ02  0.5315265  0.0044497   119.451  < 2e-16 ***\nORIGIN_SZTPSZ03 -0.4669723  0.0062160   -75.124  < 2e-16 ***\nORIGIN_SZTPSZ04 -0.0617169  0.0058830   -10.491  < 2e-16 ***\nORIGIN_SZTPSZ05  0.0713309  0.0062133    11.480  < 2e-16 ***\nORIGIN_SZTPSZ06  0.6800356  0.0069456    97.909  < 2e-16 ***\nORIGIN_SZTPSZ07 -0.0432782  0.0064382    -6.722 1.79e-11 ***\nORIGIN_SZTPSZ08 -0.6976429  0.0092416   -75.490  < 2e-16 ***\nORIGIN_SZTPSZ09 -0.3708833  0.0063548   -58.363  < 2e-16 ***\nORIGIN_SZTPSZ10 -0.4063575  0.0077803   -52.229  < 2e-16 ***\nORIGIN_SZTPSZ11  0.1040282  0.0056115    18.538  < 2e-16 ***\nORIGIN_SZTPSZ12 -0.5104672  0.0066261   -77.039  < 2e-16 ***\nORIGIN_SZTSSZ01 -3.5036830  0.0487290   -71.901  < 2e-16 ***\nORIGIN_SZTSSZ02 -0.0386819  0.0094886    -4.077 4.57e-05 ***\nORIGIN_SZTSSZ03 -0.3862387  0.0095139   -40.597  < 2e-16 ***\nORIGIN_SZTSSZ04 -0.6380676  0.0099905   -63.867  < 2e-16 ***\nORIGIN_SZTSSZ05 -2.7354613  0.0162414  -168.425  < 2e-16 ***\nORIGIN_SZTSSZ06 -2.6310865  0.0255772  -102.868  < 2e-16 ***\nORIGIN_SZWCSZ01 -1.1561047  0.0087394  -132.286  < 2e-16 ***\nORIGIN_SZWCSZ02 -2.6956217  0.0319117   -84.471  < 2e-16 ***\nORIGIN_SZWCSZ03 -4.3526889  0.1241082   -35.072  < 2e-16 ***\nORIGIN_SZWDSZ01  0.8712417  0.0043720   199.277  < 2e-16 ***\nORIGIN_SZWDSZ02  0.9119539  0.0050326   181.210  < 2e-16 ***\nORIGIN_SZWDSZ03  1.6205678  0.0045250   358.136  < 2e-16 ***\nORIGIN_SZWDSZ04  1.2081941  0.0054272   222.618  < 2e-16 ***\nORIGIN_SZWDSZ05  0.4284783  0.0052752    81.224  < 2e-16 ***\nORIGIN_SZWDSZ06  0.9018716  0.0049820   181.028  < 2e-16 ***\nORIGIN_SZWDSZ07 -0.6444820  0.0084731   -76.062  < 2e-16 ***\nORIGIN_SZWDSZ08 -0.8764983  0.0082622  -106.085  < 2e-16 ***\nORIGIN_SZWDSZ09  1.3292589  0.0048663   273.158  < 2e-16 ***\nORIGIN_SZYSSZ01 -0.4780462  0.0058489   -81.733  < 2e-16 ***\nORIGIN_SZYSSZ02  0.9323419  0.0054402   171.380  < 2e-16 ***\nORIGIN_SZYSSZ03  2.0577240  0.0046737   440.274  < 2e-16 ***\nORIGIN_SZYSSZ04  0.8697472  0.0047269   184.000  < 2e-16 ***\nORIGIN_SZYSSZ05  0.1662764  0.0060376    27.540  < 2e-16 ***\nORIGIN_SZYSSZ06 -0.8115617  0.0109084   -74.398  < 2e-16 ***\nORIGIN_SZYSSZ07 -0.8971248  0.0119220   -75.250  < 2e-16 ***\nORIGIN_SZYSSZ08 -0.2738680  0.0063553   -43.093  < 2e-16 ***\nORIGIN_SZYSSZ09  1.2274518  0.0044951   273.066  < 2e-16 ***\nDESTIN_SZAMSZ02 -0.0516322  0.0042829   -12.055  < 2e-16 ***\nDESTIN_SZAMSZ03  0.0801823  0.0041904    19.135  < 2e-16 ***\nDESTIN_SZAMSZ04 -0.9282211  0.0061322  -151.368  < 2e-16 ***\nDESTIN_SZAMSZ05 -1.0794168  0.0062543  -172.588  < 2e-16 ***\nDESTIN_SZAMSZ06 -0.8839603  0.0060851  -145.267  < 2e-16 ***\nDESTIN_SZAMSZ07 -1.5835093  0.0096846  -163.508  < 2e-16 ***\nDESTIN_SZAMSZ08 -0.9756903  0.0068829  -141.756  < 2e-16 ***\nDESTIN_SZAMSZ09 -1.0362692  0.0061651  -168.087  < 2e-16 ***\nDESTIN_SZAMSZ10 -0.1227646  0.0044788   -27.410  < 2e-16 ***\nDESTIN_SZAMSZ11 -0.4802374  0.0088108   -54.506  < 2e-16 ***\nDESTIN_SZAMSZ12  0.2142621  0.0050653    42.300  < 2e-16 ***\nDESTIN_SZBDSZ01  0.3582789  0.0039578    90.524  < 2e-16 ***\nDESTIN_SZBDSZ02 -0.4368229  0.0051384   -85.012  < 2e-16 ***\nDESTIN_SZBDSZ03 -0.1568727  0.0044329   -35.388  < 2e-16 ***\nDESTIN_SZBDSZ04  0.6731669  0.0036215   185.882  < 2e-16 ***\nDESTIN_SZBDSZ05  0.3647198  0.0040496    90.062  < 2e-16 ***\nDESTIN_SZBDSZ06  0.0589240  0.0044352    13.286  < 2e-16 ***\nDESTIN_SZBDSZ07 -0.6648168  0.0095742   -69.438  < 2e-16 ***\nDESTIN_SZBDSZ08 -1.7214136  0.0106600  -161.483  < 2e-16 ***\nDESTIN_SZBKSZ01 -1.2688264  0.0067263  -188.637  < 2e-16 ***\nDESTIN_SZBKSZ02 -0.3912129  0.0055446   -70.558  < 2e-16 ***\nDESTIN_SZBKSZ03 -0.8663392  0.0058693  -147.605  < 2e-16 ***\nDESTIN_SZBKSZ04 -0.1247273  0.0051254   -24.335  < 2e-16 ***\nDESTIN_SZBKSZ05 -0.7407774  0.0059120  -125.300  < 2e-16 ***\nDESTIN_SZBKSZ06 -0.9934643  0.0063345  -156.834  < 2e-16 ***\nDESTIN_SZBKSZ07  0.0882230  0.0042928    20.551  < 2e-16 ***\nDESTIN_SZBKSZ08 -1.1134447  0.0070752  -157.372  < 2e-16 ***\nDESTIN_SZBKSZ09 -0.1788171  0.0051327   -34.839  < 2e-16 ***\nDESTIN_SZBLSZ01 -0.7696433  0.0071898  -107.047  < 2e-16 ***\nDESTIN_SZBLSZ02  0.4076650  0.0068001    59.950  < 2e-16 ***\nDESTIN_SZBLSZ03  1.5398488  0.0078230   196.836  < 2e-16 ***\nDESTIN_SZBLSZ04 -0.3499486  0.0136985   -25.546  < 2e-16 ***\nDESTIN_SZBMSZ01 -0.2114705  0.0048311   -43.773  < 2e-16 ***\nDESTIN_SZBMSZ02 -0.3316806  0.0049958   -66.391  < 2e-16 ***\nDESTIN_SZBMSZ03 -0.5134774  0.0058534   -87.723  < 2e-16 ***\nDESTIN_SZBMSZ04 -0.2205274  0.0051028   -43.217  < 2e-16 ***\nDESTIN_SZBMSZ05 -0.2101165  0.0067710   -31.032  < 2e-16 ***\nDESTIN_SZBMSZ06 -1.3832385  0.0124821  -110.818  < 2e-16 ***\nDESTIN_SZBMSZ07 -0.0133462  0.0046787    -2.853  0.00434 ** \nDESTIN_SZBMSZ08 -0.9056756  0.0063868  -141.805  < 2e-16 ***\nDESTIN_SZBMSZ09 -2.3175407  0.0144523  -160.358  < 2e-16 ***\nDESTIN_SZBMSZ10 -1.3973725  0.0090463  -154.470  < 2e-16 ***\nDESTIN_SZBMSZ11 -1.3950206  0.0080459  -173.383  < 2e-16 ***\nDESTIN_SZBMSZ12 -0.6882789  0.0081539   -84.411  < 2e-16 ***\nDESTIN_SZBMSZ13 -0.2729120  0.0052969   -51.523  < 2e-16 ***\nDESTIN_SZBMSZ14 -0.7581980  0.0080215   -94.521  < 2e-16 ***\nDESTIN_SZBMSZ15 -0.9323237  0.0071093  -131.142  < 2e-16 ***\nDESTIN_SZBMSZ16 -2.0655530  0.0108490  -190.391  < 2e-16 ***\nDESTIN_SZBMSZ17 -2.5124893  0.0165366  -151.935  < 2e-16 ***\nDESTIN_SZBPSZ01 -0.8203274  0.0057682  -142.216  < 2e-16 ***\nDESTIN_SZBPSZ02 -1.5284265  0.0087447  -174.783  < 2e-16 ***\nDESTIN_SZBPSZ03 -1.2434382  0.0080852  -153.792  < 2e-16 ***\nDESTIN_SZBPSZ04 -0.7778558  0.0060900  -127.727  < 2e-16 ***\nDESTIN_SZBPSZ05  0.1782204  0.0042331    42.101  < 2e-16 ***\nDESTIN_SZBPSZ06 -0.6758807  0.0079728   -84.773  < 2e-16 ***\nDESTIN_SZBPSZ07 -0.5029450  0.0081151   -61.976  < 2e-16 ***\nDESTIN_SZBSSZ01 -0.1269916  0.0046949   -27.049  < 2e-16 ***\nDESTIN_SZBSSZ02 -0.7536917  0.0051895  -145.233  < 2e-16 ***\nDESTIN_SZBSSZ03  0.2747969  0.0039115    70.254  < 2e-16 ***\nDESTIN_SZBTSZ01  0.1708577  0.0043381    39.385  < 2e-16 ***\nDESTIN_SZBTSZ02 -0.6820190  0.0067243  -101.427  < 2e-16 ***\nDESTIN_SZBTSZ03  0.0610599  0.0049825    12.255  < 2e-16 ***\nDESTIN_SZBTSZ04 -1.3199639  0.0107063  -123.288  < 2e-16 ***\nDESTIN_SZBTSZ05 -0.4174991  0.0069221   -60.314  < 2e-16 ***\nDESTIN_SZBTSZ06 -0.5260242  0.0061145   -86.029  < 2e-16 ***\nDESTIN_SZBTSZ07 -1.6678047  0.0106335  -156.844  < 2e-16 ***\nDESTIN_SZBTSZ08 -0.7999935  0.0089175   -89.711  < 2e-16 ***\nDESTIN_SZCBSZ01 -5.6321332  0.3162476   -17.809  < 2e-16 ***\nDESTIN_SZCCSZ01 -0.9342781  0.0081409  -114.763  < 2e-16 ***\nDESTIN_SZCHSZ01 -1.2808546  0.0096774  -132.355  < 2e-16 ***\nDESTIN_SZCHSZ02  0.0067332  0.0054322     1.239  0.21516    \nDESTIN_SZCHSZ03  1.0988838  0.0041378   265.570  < 2e-16 ***\nDESTIN_SZCKSZ01 -0.3192235  0.0050632   -63.048  < 2e-16 ***\nDESTIN_SZCKSZ02 -0.7776453  0.0055279  -140.676  < 2e-16 ***\nDESTIN_SZCKSZ03  0.2772358  0.0042541    65.170  < 2e-16 ***\nDESTIN_SZCKSZ04 -1.3842048  0.0065159  -212.436  < 2e-16 ***\nDESTIN_SZCKSZ05 -1.2051808  0.0076814  -156.897  < 2e-16 ***\nDESTIN_SZCKSZ06  0.1321955  0.0061568    21.472  < 2e-16 ***\nDESTIN_SZCLSZ01  0.1942449  0.0049977    38.867  < 2e-16 ***\nDESTIN_SZCLSZ02 -2.0828648  0.0134597  -154.749  < 2e-16 ***\nDESTIN_SZCLSZ03 -0.8823728  0.0078307  -112.681  < 2e-16 ***\nDESTIN_SZCLSZ04 -0.2311432  0.0047194   -48.977  < 2e-16 ***\nDESTIN_SZCLSZ05 -1.0113430  0.0085536  -118.237  < 2e-16 ***\nDESTIN_SZCLSZ06  0.0694682  0.0042166    16.475  < 2e-16 ***\nDESTIN_SZCLSZ07 -0.4953961  0.0054184   -91.429  < 2e-16 ***\nDESTIN_SZCLSZ08 -0.3849563  0.0061404   -62.693  < 2e-16 ***\nDESTIN_SZCLSZ09  0.4201808  0.0067112    62.609  < 2e-16 ***\nDESTIN_SZDTSZ02 -2.6513032  0.0348725   -76.029  < 2e-16 ***\nDESTIN_SZDTSZ03 -1.5192228  0.0144477  -105.153  < 2e-16 ***\nDESTIN_SZDTSZ13 -2.2041951  0.0161726  -136.292  < 2e-16 ***\nDESTIN_SZGLSZ01 -0.0139744  0.0052464    -2.664  0.00773 ** \nDESTIN_SZGLSZ02 -0.2850816  0.0047467   -60.059  < 2e-16 ***\nDESTIN_SZGLSZ03  0.3511872  0.0039473    88.969  < 2e-16 ***\nDESTIN_SZGLSZ04  0.2909117  0.0039436    73.769  < 2e-16 ***\nDESTIN_SZGLSZ05  0.1845361  0.0040011    46.121  < 2e-16 ***\nDESTIN_SZHGSZ01  0.1418382  0.0039875    35.571  < 2e-16 ***\nDESTIN_SZHGSZ02 -0.7233151  0.0052374  -138.105  < 2e-16 ***\nDESTIN_SZHGSZ03 -1.1918463  0.0062129  -191.834  < 2e-16 ***\nDESTIN_SZHGSZ04 -0.4380360  0.0044839   -97.691  < 2e-16 ***\nDESTIN_SZHGSZ05 -0.5671024  0.0046427  -122.149  < 2e-16 ***\nDESTIN_SZHGSZ06 -0.8271411  0.0054935  -150.566  < 2e-16 ***\nDESTIN_SZHGSZ07  0.0721800  0.0041589    17.356  < 2e-16 ***\nDESTIN_SZHGSZ08 -0.4297429  0.0050021   -85.913  < 2e-16 ***\nDESTIN_SZHGSZ09 -0.2085461  0.0052544   -39.690  < 2e-16 ***\nDESTIN_SZHGSZ10 -2.9169699  0.0262698  -111.039  < 2e-16 ***\nDESTIN_SZJESZ01 -0.2822473  0.0051166   -55.163  < 2e-16 ***\nDESTIN_SZJESZ02 -0.6761389  0.0053635  -126.063  < 2e-16 ***\nDESTIN_SZJESZ03 -0.7371756  0.0058983  -124.980  < 2e-16 ***\nDESTIN_SZJESZ04 -0.4593491  0.0067970   -67.581  < 2e-16 ***\nDESTIN_SZJESZ05 -1.1418012  0.0099049  -115.277  < 2e-16 ***\nDESTIN_SZJESZ06  0.1759680  0.0042791    41.123  < 2e-16 ***\nDESTIN_SZJESZ07 -1.2260587  0.0082714  -148.229  < 2e-16 ***\nDESTIN_SZJESZ08 -0.8547001  0.0080417  -106.283  < 2e-16 ***\nDESTIN_SZJESZ09 -0.4306353  0.0057006   -75.542  < 2e-16 ***\nDESTIN_SZJESZ10  0.6584971  0.0073664    89.392  < 2e-16 ***\nDESTIN_SZJESZ11  0.9661208  0.0070491   137.056  < 2e-16 ***\nDESTIN_SZJWSZ01 -0.9128436  0.0069529  -131.290  < 2e-16 ***\nDESTIN_SZJWSZ02 -0.7285851  0.0054839  -132.859  < 2e-16 ***\nDESTIN_SZJWSZ03  0.2601455  0.0043215    60.198  < 2e-16 ***\nDESTIN_SZJWSZ04  0.6860274  0.0041135   166.775  < 2e-16 ***\nDESTIN_SZJWSZ05 -0.4684576  0.0062875   -74.506  < 2e-16 ***\nDESTIN_SZJWSZ06 -0.2459774  0.0057575   -42.723  < 2e-16 ***\nDESTIN_SZJWSZ07 -1.8854234  0.0287721   -65.529  < 2e-16 ***\nDESTIN_SZJWSZ08 -0.5523308  0.0051054  -108.186  < 2e-16 ***\nDESTIN_SZJWSZ09  0.8818747  0.0037800   233.301  < 2e-16 ***\nDESTIN_SZKLSZ01 -0.5814386  0.0052711  -110.308  < 2e-16 ***\nDESTIN_SZKLSZ02 -0.7090577  0.0058161  -121.914  < 2e-16 ***\nDESTIN_SZKLSZ03 -1.2191910  0.0065984  -184.772  < 2e-16 ***\nDESTIN_SZKLSZ04 -1.6961428  0.0087866  -193.038  < 2e-16 ***\nDESTIN_SZKLSZ05 -0.6927144  0.0073574   -94.153  < 2e-16 ***\nDESTIN_SZKLSZ06 -2.2967464  0.0362605   -63.340  < 2e-16 ***\nDESTIN_SZKLSZ07 -0.9536980  0.0066777  -142.819  < 2e-16 ***\nDESTIN_SZKLSZ08 -0.4565596  0.0051736   -88.249  < 2e-16 ***\nDESTIN_SZLKSZ01 -1.7277135  0.0207336   -83.329  < 2e-16 ***\nDESTIN_SZMDSZ01 -1.7155417  0.0210080   -81.661  < 2e-16 ***\nDESTIN_SZMDSZ02 -1.3694928  0.0114174  -119.948  < 2e-16 ***\nDESTIN_SZMDSZ03 -2.7183729  0.0252678  -107.582  < 2e-16 ***\nDESTIN_SZMPSZ01 -0.8051991  0.0078564  -102.490  < 2e-16 ***\nDESTIN_SZMPSZ02 -0.7627000  0.0061386  -124.246  < 2e-16 ***\nDESTIN_SZMPSZ03 -0.0649484  0.0047787   -13.591  < 2e-16 ***\nDESTIN_SZMUSZ02 -1.9549128  0.0200160   -97.667  < 2e-16 ***\nDESTIN_SZNTSZ01 -3.3048398  0.0448053   -73.760  < 2e-16 ***\nDESTIN_SZNTSZ02 -1.6454847  0.0109337  -150.497  < 2e-16 ***\nDESTIN_SZNTSZ03 -1.1389723  0.0077396  -147.161  < 2e-16 ***\nDESTIN_SZNTSZ05 -2.0264109  0.0250226   -80.983  < 2e-16 ***\nDESTIN_SZNTSZ06 -3.3496282  0.0428989   -78.082  < 2e-16 ***\nDESTIN_SZNVSZ01 -0.3407614  0.0045493   -74.905  < 2e-16 ***\nDESTIN_SZNVSZ02 -0.4987695  0.0053942   -92.465  < 2e-16 ***\nDESTIN_SZNVSZ03 -0.4936107  0.0055158   -89.491  < 2e-16 ***\nDESTIN_SZNVSZ04 -1.9141281  0.0107557  -177.964  < 2e-16 ***\nDESTIN_SZNVSZ05 -1.5378263  0.0089577  -171.677  < 2e-16 ***\nDESTIN_SZPGSZ01 -1.7744485  0.0194346   -91.304  < 2e-16 ***\nDESTIN_SZPGSZ02 -0.9282918  0.0069006  -134.523  < 2e-16 ***\nDESTIN_SZPGSZ03  0.0885025  0.0042145    21.000  < 2e-16 ***\nDESTIN_SZPGSZ04 -0.3879375  0.0046862   -82.784  < 2e-16 ***\nDESTIN_SZPGSZ05 -0.9649873  0.0074625  -129.311  < 2e-16 ***\nDESTIN_SZPLSZ01 -0.6159175  0.0070845   -86.939  < 2e-16 ***\nDESTIN_SZPLSZ02 -1.7551386  0.0133081  -131.885  < 2e-16 ***\nDESTIN_SZPLSZ03 -0.1378379  0.0098704   -13.965  < 2e-16 ***\nDESTIN_SZPLSZ04 -0.1411200  0.0096446   -14.632  < 2e-16 ***\nDESTIN_SZPLSZ05 -0.8483196  0.0119048   -71.259  < 2e-16 ***\nDESTIN_SZPNSZ01 -0.1579087  0.0057330   -27.544  < 2e-16 ***\nDESTIN_SZPNSZ02  1.0243480  0.0076680   133.587  < 2e-16 ***\nDESTIN_SZPNSZ03  0.0451598  0.0081444     5.545 2.94e-08 ***\nDESTIN_SZPNSZ04  1.8941928  0.0087479   216.530  < 2e-16 ***\nDESTIN_SZPNSZ05  1.0341581  0.0130830    79.046  < 2e-16 ***\nDESTIN_SZPRSZ01 -1.4038513  0.0086911  -161.527  < 2e-16 ***\nDESTIN_SZPRSZ02 -0.4942539  0.0052403   -94.319  < 2e-16 ***\nDESTIN_SZPRSZ03  0.4219510  0.0040281   104.751  < 2e-16 ***\nDESTIN_SZPRSZ04 -0.4841099  0.0083498   -57.979  < 2e-16 ***\nDESTIN_SZPRSZ05 -0.2988481  0.0047512   -62.899  < 2e-16 ***\nDESTIN_SZPRSZ06  0.0012333  0.0054530     0.226  0.82108    \nDESTIN_SZPRSZ07 -1.1417482  0.0118845   -96.070  < 2e-16 ***\nDESTIN_SZPRSZ08 -0.8259249  0.0066757  -123.720  < 2e-16 ***\nDESTIN_SZQTSZ01 -1.2134330  0.0089222  -136.002  < 2e-16 ***\nDESTIN_SZQTSZ02 -1.2397956  0.0074512  -166.388  < 2e-16 ***\nDESTIN_SZQTSZ03 -0.7448659  0.0066511  -111.992  < 2e-16 ***\nDESTIN_SZQTSZ04 -0.6243112  0.0066812   -93.443  < 2e-16 ***\nDESTIN_SZQTSZ05 -0.6102589  0.0060458  -100.940  < 2e-16 ***\nDESTIN_SZQTSZ06 -0.9164592  0.0065095  -140.788  < 2e-16 ***\nDESTIN_SZQTSZ07 -1.4600643  0.0109976  -132.762  < 2e-16 ***\nDESTIN_SZQTSZ08  0.0004582  0.0050178     0.091  0.92724    \nDESTIN_SZQTSZ09 -0.5226213  0.0058901   -88.728  < 2e-16 ***\nDESTIN_SZQTSZ10 -0.3867082  0.0055876   -69.208  < 2e-16 ***\nDESTIN_SZQTSZ11  0.0260589  0.0055065     4.732 2.22e-06 ***\nDESTIN_SZQTSZ12 -0.3387634  0.0072779   -46.547  < 2e-16 ***\nDESTIN_SZQTSZ13 -0.0512118  0.0053664    -9.543  < 2e-16 ***\nDESTIN_SZQTSZ14 -0.2555346  0.0063792   -40.057  < 2e-16 ***\nDESTIN_SZQTSZ15 -0.1820651  0.0077537   -23.481  < 2e-16 ***\nDESTIN_SZRCSZ01 -0.4641196  0.0072515   -64.003  < 2e-16 ***\nDESTIN_SZRCSZ06 -2.0929548  0.0189106  -110.676  < 2e-16 ***\nDESTIN_SZRVSZ01 -1.7885682  0.0163492  -109.398  < 2e-16 ***\nDESTIN_SZRVSZ02 -3.1669721  0.0326320   -97.051  < 2e-16 ***\nDESTIN_SZRVSZ03 -2.0306835  0.0135749  -149.591  < 2e-16 ***\nDESTIN_SZRVSZ04 -1.5113470  0.0155637   -97.107  < 2e-16 ***\nDESTIN_SZRVSZ05 -2.3683855  0.0259334   -91.326  < 2e-16 ***\nDESTIN_SZSBSZ01 -0.5841063  0.0068588   -85.162  < 2e-16 ***\nDESTIN_SZSBSZ02 -1.0777704  0.0078288  -137.667  < 2e-16 ***\nDESTIN_SZSBSZ03  0.4734371  0.0045880   103.190  < 2e-16 ***\nDESTIN_SZSBSZ04  0.0546094  0.0057517     9.494  < 2e-16 ***\nDESTIN_SZSBSZ05 -0.9588198  0.0075242  -127.431  < 2e-16 ***\nDESTIN_SZSBSZ06 -1.8528944  0.0234040   -79.170  < 2e-16 ***\nDESTIN_SZSBSZ07 -1.8403768  0.0195878   -93.955  < 2e-16 ***\nDESTIN_SZSBSZ08  0.9205969  0.0055698   165.285  < 2e-16 ***\nDESTIN_SZSBSZ09  0.5166486  0.0051939    99.472  < 2e-16 ***\nDESTIN_SZSESZ02 -0.5728211  0.0048270  -118.669  < 2e-16 ***\nDESTIN_SZSESZ03  0.2554787  0.0038335    66.645  < 2e-16 ***\nDESTIN_SZSESZ04 -0.8982794  0.0056698  -158.432  < 2e-16 ***\nDESTIN_SZSESZ05 -0.4661655  0.0048578   -95.962  < 2e-16 ***\nDESTIN_SZSESZ06 -0.8392849  0.0059198  -141.777  < 2e-16 ***\nDESTIN_SZSESZ07 -3.2182325  0.0227089  -141.717  < 2e-16 ***\nDESTIN_SZSGSZ01 -0.2751206  0.0059581   -46.176  < 2e-16 ***\nDESTIN_SZSGSZ02 -0.2951806  0.0052515   -56.209  < 2e-16 ***\nDESTIN_SZSGSZ03 -0.4469508  0.0048181   -92.766  < 2e-16 ***\nDESTIN_SZSGSZ04 -0.2842809  0.0047961   -59.274  < 2e-16 ***\nDESTIN_SZSGSZ05 -2.0643753  0.0098252  -210.109  < 2e-16 ***\nDESTIN_SZSGSZ06  0.2501247  0.0038873    64.343  < 2e-16 ***\nDESTIN_SZSGSZ07 -0.5743750  0.0052184  -110.067  < 2e-16 ***\nDESTIN_SZSISZ01 -1.1030669  0.0259113   -42.571  < 2e-16 ***\nDESTIN_SZSKSZ01 -0.5462538  0.0071443   -76.460  < 2e-16 ***\nDESTIN_SZSKSZ02  0.2965180  0.0056707    52.290  < 2e-16 ***\nDESTIN_SZSKSZ03 -0.4521490  0.0062177   -72.719  < 2e-16 ***\nDESTIN_SZSKSZ04 -0.6665145  0.0148252   -44.958  < 2e-16 ***\nDESTIN_SZSKSZ05 -0.1474142  0.0121958   -12.087  < 2e-16 ***\nDESTIN_SZSLSZ01 -0.8855715  0.0084587  -104.693  < 2e-16 ***\nDESTIN_SZSLSZ04 -1.1787840  0.0071355  -165.200  < 2e-16 ***\nDESTIN_SZSRSZ01 -1.6435064  0.0128822  -127.580  < 2e-16 ***\nDESTIN_SZTHSZ01 -3.4388625  0.0367651   -93.536  < 2e-16 ***\nDESTIN_SZTHSZ03 -2.5809435  0.0256853  -100.483  < 2e-16 ***\nDESTIN_SZTHSZ04 -2.4887189  0.0214441  -116.056  < 2e-16 ***\nDESTIN_SZTHSZ06 -1.7965101  0.0152160  -118.067  < 2e-16 ***\nDESTIN_SZTMSZ01 -0.3251891  0.0058067   -56.002  < 2e-16 ***\nDESTIN_SZTMSZ02  1.1558743  0.0034703   333.080  < 2e-16 ***\nDESTIN_SZTMSZ03  0.4525619  0.0039244   115.319  < 2e-16 ***\nDESTIN_SZTMSZ04  0.8223271  0.0040060   205.274  < 2e-16 ***\nDESTIN_SZTMSZ05  0.3880619  0.0054308    71.456  < 2e-16 ***\nDESTIN_SZTNSZ01 -0.9533112  0.0067853  -140.496  < 2e-16 ***\nDESTIN_SZTNSZ02 -1.5909451  0.0097396  -163.348  < 2e-16 ***\nDESTIN_SZTNSZ03 -1.6470771  0.0116598  -141.261  < 2e-16 ***\nDESTIN_SZTNSZ04 -1.0686173  0.0069848  -152.993  < 2e-16 ***\nDESTIN_SZTPSZ01 -0.5180183  0.0056886   -91.063  < 2e-16 ***\nDESTIN_SZTPSZ02  0.2160781  0.0038283    56.443  < 2e-16 ***\nDESTIN_SZTPSZ03 -0.2479956  0.0056651   -43.776  < 2e-16 ***\nDESTIN_SZTPSZ04 -1.5015463  0.0072444  -207.271  < 2e-16 ***\nDESTIN_SZTPSZ05 -0.9551144  0.0057981  -164.729  < 2e-16 ***\nDESTIN_SZTPSZ06 -0.4846634  0.0074621   -64.950  < 2e-16 ***\nDESTIN_SZTPSZ07 -1.9753440  0.0118295  -166.984  < 2e-16 ***\nDESTIN_SZTPSZ08 -1.3455063  0.0086909  -154.817  < 2e-16 ***\nDESTIN_SZTPSZ09 -0.3556620  0.0061296   -58.024  < 2e-16 ***\nDESTIN_SZTPSZ10 -1.3213501  0.0085951  -153.733  < 2e-16 ***\nDESTIN_SZTPSZ11 -0.3877006  0.0052409   -73.977  < 2e-16 ***\nDESTIN_SZTPSZ12 -0.7064020  0.0062472  -113.075  < 2e-16 ***\nDESTIN_SZTSSZ01 -0.8827157  0.0218327   -40.431  < 2e-16 ***\nDESTIN_SZTSSZ02 -0.6067055  0.0115514   -52.522  < 2e-16 ***\nDESTIN_SZTSSZ03  0.4380259  0.0086774    50.479  < 2e-16 ***\nDESTIN_SZTSSZ04  0.4902124  0.0089922    54.515  < 2e-16 ***\nDESTIN_SZTSSZ05  1.4336278  0.0093410   153.477  < 2e-16 ***\nDESTIN_SZTSSZ06  0.9223573  0.0209024    44.127  < 2e-16 ***\nDESTIN_SZWCSZ01  1.1559309  0.0051787   223.208  < 2e-16 ***\nDESTIN_SZWCSZ02 -1.2664455  0.0126131  -100.407  < 2e-16 ***\nDESTIN_SZWCSZ03 -2.7360882  0.0325753   -83.993  < 2e-16 ***\nDESTIN_SZWDSZ01  0.8193492  0.0037301   219.657  < 2e-16 ***\nDESTIN_SZWDSZ02 -0.7852474  0.0058655  -133.875  < 2e-16 ***\nDESTIN_SZWDSZ03  0.5742422  0.0041884   137.104  < 2e-16 ***\nDESTIN_SZWDSZ04 -0.8391525  0.0065075  -128.951  < 2e-16 ***\nDESTIN_SZWDSZ05 -0.3510692  0.0057253   -61.319  < 2e-16 ***\nDESTIN_SZWDSZ06  0.1358804  0.0043968    30.905  < 2e-16 ***\nDESTIN_SZWDSZ07 -0.2207379  0.0066369   -33.259  < 2e-16 ***\nDESTIN_SZWDSZ08 -0.0264655  0.0065065    -4.068 4.75e-05 ***\nDESTIN_SZWDSZ09 -0.2065828  0.0050524   -40.888  < 2e-16 ***\nDESTIN_SZYSSZ01  0.7467996  0.0040979   182.238  < 2e-16 ***\nDESTIN_SZYSSZ02 -0.3002718  0.0053434   -56.195  < 2e-16 ***\nDESTIN_SZYSSZ03 -1.1087686  0.0057219  -193.778  < 2e-16 ***\nDESTIN_SZYSSZ04 -0.3748076  0.0051481   -72.805  < 2e-16 ***\nDESTIN_SZYSSZ05 -1.7909654  0.0102064  -175.475  < 2e-16 ***\nDESTIN_SZYSSZ06 -1.8519179  0.0099601  -185.933  < 2e-16 ***\nDESTIN_SZYSSZ07 -0.9246626  0.0118101   -78.294  < 2e-16 ***\nDESTIN_SZYSSZ08  0.4403129  0.0041268   106.697  < 2e-16 ***\nDESTIN_SZYSSZ09  0.0267012  0.0041393     6.451 1.11e-10 ***\nlog(dist)       -0.6721961  0.0001353 -4969.566  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 60796037  on 14733  degrees of freedom\nResidual deviance: 20988409  on 14175  degrees of freedom\nAIC: 21081154\n\nNumber of Fisher Scoring iterations: 7\n```\n:::\n:::\n\nThe R-squared value of the doubly-constrained SIM is 0.574.\n\n::: {.cell}\n\n```{.r .cell-code}\nCalcRSquared(dbcSIM$data$TRIPS, dbcSIM$fitted.values)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.5739638\n```\n:::\n:::\n\n\n## 3.8 Model comparison\nWe could compare the model performance using the root mean squared error (RMSE). We first create a list of the four models.\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_list <- list(unconstrained=uncSIM,\n                   originConstrained=orcSIM,\n                   destinationConstrained=decSIM,\n                   doublyConstrained=dbcSIM)\n```\n:::\n\n\nWe then compute the RMSE of all the models using the `compare_performance()` function from the `performance` package. The results show that doubly constrained SIM is the best model with the smallest RMSE value of 3252.\n\n::: {.cell}\n\n```{.r .cell-code}\ncompare_performance(model_list,\n                    metrics = \"RMSE\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Comparison of Model Performance Indices\n\nName                   | Model |     RMSE\n-----------------------------------------\nunconstrained          |   glm | 4177.524\noriginConstrained      |   glm | 3643.596\ndestinationConstrained |   glm | 3347.482\ndoublyConstrained      |   glm | 3252.297\n```\n:::\n:::\n\n\n## 3.9 Visualising fitted values\nIn this section, we will visualise the observed values against the fitted values.\n\n::: panel-tabset\n### Extract models' fitted values\nThe code below extracts the fitted values from each model and appends them to the `SIM_data` dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Unconstrained SIM\ndf <- as.data.frame(uncSIM$fitted.values) %>%\n  round(digits = 0)\n\nSIM_data <- SIM_data %>%\n  cbind(df) %>%\n  rename(uncTRIPS = \"uncSIM$fitted.values\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Origin-constrained SIM\ndf <- as.data.frame(orcSIM$fitted.values) %>%\n  round(digits = 0)\n\nSIM_data <- SIM_data %>%\n  cbind(df) %>%\n  rename(orcTRIPS = \"orcSIM$fitted.values\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Destination-constrained SIM\ndf <- as.data.frame(decSIM$fitted.values) %>%\n  round(digits = 0)\n\nSIM_data <- SIM_data %>%\n  cbind(df) %>%\n  rename(decTRIPS = \"decSIM$fitted.values\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Doubly-constrained SIM\ndf <- as.data.frame(dbcSIM$fitted.values) %>%\n  round(digits = 0)\n\nSIM_data <- SIM_data %>%\n  cbind(df) %>%\n  rename(dbcTRIPS = \"dbcSIM$fitted.values\")\n```\n:::\n\n\n### Visualisation\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nunc_p <- ggplot(data = SIM_data,\n                aes(x = uncTRIPS,\n                    y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\norc_p <- ggplot(data = SIM_data,\n                aes(x = orcTRIPS,\n                    y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\ndec_p <- ggplot(data = SIM_data,\n                aes(x = decTRIPS,\n                    y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\ndbc_p <- ggplot(data = SIM_data,\n                aes(x = dbcTRIPS,\n                    y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\nggarrange(unc_p, orc_p, dec_p, dbc_p,\n          ncol = 2,\n          nrow = 2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Hands-on_Ex09B_files/figure-html/unnamed-chunk-44-1.png){width=672}\n:::\n:::\n\n\n:::\n",
    "supporting": [
      "Hands-on_Ex09B_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}